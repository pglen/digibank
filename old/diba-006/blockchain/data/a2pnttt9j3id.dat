DQoNCg0KLyogPT09PT1bIGdzZXhwLmMgXT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQogICBEZXNjcmlw
dGlvbjogICAgIFNleHAgcm91dGluZXMuDQoNCiAgIFJldmlzaW9uczoNCg0KICAg
ICAgUkVWICAgREFURSAgICAgICAgICAgIEJZICAgICAgICAgICAgICBERVNDUklQ
VElPTg0KICAgICAgLS0tLSAgLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0gICAg
ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgIDAuMDAgIGF1
Zy4wMy4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgSW5pdGlhbCB2ZXJzaW9uLg0K
ICAgICAgMC4wMCAgb2N0LjIwLjIwMTcgICAgIFBldGVyIEdsZW4gICAgICBXb3Jr
IA0KDQogICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQojaW5jbHVkZSA8
c3RkaW8uaD4NCg0KI2luY2x1ZGUgImdjcnlwdC5oIg0KI2luY2x1ZGUgImdjcnku
aCINCiNpbmNsdWRlICJnc2V4cC5oIg0KI2luY2x1ZGUgInptYWxsb2MuaCINCiNp
bmNsdWRlICJtaXNjLmgiDQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQov
LyBQcmludCBzZXhwIHRvIG1lbW9yeQ0KLy8gRnJlZSB0aGUgcmVzdWx0aW5nIHBv
aW50ZXIgd2l0aCB6ZnJlZQ0KDQpjaGFyICpzZXhwX3NwcmludChnY3J5X3NleHBf
dCBzZXhwLCBpbnQgKmxlbiwgaW50IGZvcm1hdCkNCg0Kew0KICAgIGludCBzbGVu
ID0gZ2NyeV9zZXhwX3NwcmludChzZXhwLCBmb3JtYXQsIE5VTEwsIDApOw0KICAg
ICpsZW4gPSAwOw0KICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0KICAg
IGNoYXIgKnBwcCA9IChjaGFyKil6YWxsb2Moc2xlbisxKTsNCiAgICBpZihwcHAg
PT0gTlVMTCkNCiAgICAgICAgcmV0dXJuIE5VTEw7DQoNCiAgICBnY3J5X3NleHBf
c3ByaW50KHNleHAsIGZvcm1hdCwgcHBwLCBzbGVuKTsNCiAgICAqbGVuID0gc2xl
bjsNCiAgICAvLyBaZXJvIHRlcm1pbmF0ZQ0KICAgIHBwcFtzbGVuLTFdID0gJ1ww
JzsNCiAgICByZXR1cm4ocHBwKTsNCn0NCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8NCi8vIFByaW50IHNleHAgdG8gc3Rkb3V0DQoNCnZvaWQgICAgc2V4cF9w
cmludChnY3J5X3NleHBfdCByc2Ffa2V5cGFpcikNCg0Kew0KICAgIGludCBsZW47
DQogICAgY2hhciAqcHBwID0gc2V4cF9zcHJpbnQocnNhX2tleXBhaXIsICZsZW4s
IEdDUllTRVhQX0ZNVF9BRFZBTkNFRCk7DQogICAgaWYocHBwID09IE5VTEwpDQog
ICAgICAgIHJldHVybjsNCiAgICBwcmludGYoIiVzXG4iLCBwcHApOw0KICAgIHpm
cmVlKHBwcCk7DQp9DQoNCmNoYXIgICAgKnN0YWNrWzEyXTsNCmludCAgICAgZGVw
dGggPSAwOw0KDQpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4
cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikNCg0Kew0K
ICAgIGNoYXIgKnJldCA9IE5VTEw7DQogICAgaW50ICBvbmVsZW4gPSBnY3J5X3Nl
eHBfbGVuZ3RoKGxpc3QpOw0KDQogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBv
bmVsZW4pOw0KICAgIHNleHBfcHJpbnQobGlzdCk7DQogICAgDQogICAgZm9yKGlu
dCBsb29wID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQ0KICAgICAgICB7DQog
ICAgICAgIGludCBsZW47DQogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5
X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCwgJmxlbik7DQogICAgICAgIGlmKGRh
dGEgPT0gTlVMTCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIGdjcnlfc2V4
cF90IGVsZW1lbnQgPSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOw0KICAgICAg
ICAgICAgaWYoZWxlbWVudCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAg
ICAgICAgaW50IGxlbjM7DQogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0
YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOw0KICAg
ICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydcbiIsIGxlbjMs
IGRhdGEzKTsNCiAgICAgICAgICAgICAgICBjaGFyICptZW14ID0gemFsbG9jKGxl
bjMgKyAxKTsNCiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxl
bjMpOw0KICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyANCiAgICAg
ICAgICAgICAgICBzdGFja1tkZXB0aF0gPSBtZW14OyAgDQogICAgICAgICAgICAg
ICAgLy8gV2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heA0KICAgICAg
ICAgICAgICAgIGlmKGRlcHRoIDwgMTIpDQogICAgICAgICAgICAgICAgICAgIGRl
cHRoKys7DQogICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVs
ZW1lbnQsIHBsZW4sIGZpbmRzdHIpOw0KICAgICAgICAgICAgICAgIGlmKHJldCkN
CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0K
ICAgICAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAg
ICAgICAgICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4s
IGRhdGEpOw0KDQogICAgICAgICAgICBpbnQgbGVuMjsNCiAgICAgICAgICAgIGlm
KHN0cm5jbXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0g
PT0gJ1wwJyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNv
bnN0IGNoYXIgKmRhdGEyID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3Ag
KyAxLCAmbGVuMik7DQogICAgICAgICAgICAgICAgaWYoZGF0YTIpDQogICAgICAg
ICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy9wcmludGYoIicv
Iik7DQogICAgICAgICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29w
MyA8IGRlcHRoOyBsb29wMysrKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJp
bnRmKCIvJXMiLCBzdGFja1tsb29wM10pOw0KICAgICAgICAgICAgICAgICAgICBw
cmludGYoIiciKTsNCiAgICANCiAgICAgICAgICAgICAgICAgICAgaWYoaXNfYmlu
KGRhdGEyLCBsZW4yKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAg
ICAgICAgICAgICAgICAgICAgIGludCBvbGVuOw0KICAgICAgICAgICAgICAgICAg
ICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAgICAgICAg
ICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgoZGF0YTIsIGxlbjIsICZvbGVu
KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICMlcyNcbiIsIG1l
bTIpOyANCiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOw0KICAg
ICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNl
DQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAg
ICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsNCiAgICAgICAg
ICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9f
TElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAgICAgICAgICAgICAgIHJldCA9ICB6
YWxsb2MobGVuMiArIDEpOw0KICAgICAgICAgICAgICAgICAgICBtZW1jcHkocmV0
LCBkYXRhMiwgbGVuMik7DQogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9
ICdcMCc7IA0KICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7IA0KICAg
ICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0K
ICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSANCiAg
ICBpZihkZXB0aCkNCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0pOyANCiAg
ICBkZXB0aC0tOw0KICAgIHJldHVybiByZXQ7DQp9DQoNCg0KY2hhciAgICAqc3Rh
Y2tbMTJdOw0KaW50ICAgICBkZXB0aCA9IDA7DQoNCnN0YXRpYyBjaGFyICpzZXhw
X2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVuLCBjb25zdCBj
aGFyICpmaW5kc3RyKQ0KDQp7DQogICAgY2hhciAqcmV0ID0gTlVMTDsNCiAgICBp
bnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7DQoNCiAgICAvL3By
aW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7DQogICAgc2V4cF9wcmludChsaXN0
KTsNCiAgICANCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVuOyBs
b29wKyspDQogICAgICAgIHsNCiAgICAgICAgaW50IGxlbjsNCiAgICAgICAgY29u
c3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAm
bGVuKTsNCiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQ0KICAgICAgICAgICAgew0K
ICAgICAgICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgo
bGlzdCwgbG9vcCk7DQogICAgICAgICAgICBpZihlbGVtZW50KQ0KICAgICAgICAg
ICAgICAgIHsNCiAgICAgICAgICAgICAgICBpbnQgbGVuMzsNCiAgICAgICAgICAg
ICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhfZGF0YShlbGVt
ZW50LCAwLCAmbGVuMyk7DQogICAgICAgICAgICAgICAgLy9wcmludGYoImVsZW1l
bnQ6ICclLipzJ1xuIiwgbGVuMywgZGF0YTMpOw0KICAgICAgICAgICAgICAgIGNo
YXIgKm1lbXggPSB6YWxsb2MobGVuMyArIDEpOw0KICAgICAgICAgICAgICAgIG1l
bWNweShtZW14LCBkYXRhMywgbGVuMyk7DQogICAgICAgICAgICAgICAgbWVteFts
ZW4zXSA9ICdcMCc7IA0KICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1l
bXg7ICANCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdvaW5nIHRv
IGJlIDMgYXQgbWF4DQogICAgICAgICAgICAgICAgaWYoZGVwdGggPCAxMikNCiAg
ICAgICAgICAgICAgICAgICAgZGVwdGgrKzsNCiAgICAgICAgICAgICAgICByZXQg
PSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7DQogICAg
ICAgICAgICAgICAgaWYocmV0KQ0KICAgICAgICAgICAgICAgICAgICBicmVhazsN
CiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIGVsc2UN
CiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIC8vcHJpbnRmKCJkYXRhOiAlZCAn
JS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7DQoNCiAgICAgICAgICAgIGludCBs
ZW4yOw0KICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBkYXRhLCBsZW4p
ID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkNCiAgICAgICAgICAgICAgICB7
DQogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBf
bnRoX2RhdGEobGlzdCwgbG9vcCArIDEsICZsZW4yKTsNCiAgICAgICAgICAgICAg
ICBpZihkYXRhMikNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAg
ICAgICAgICAvL3ByaW50ZigiJy8iKTsNCiAgICAgICAgICAgICAgICAgICAgZm9y
KGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspDQogICAgICAg
ICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNrW2xvb3AzXSk7DQog
ICAgICAgICAgICAgICAgICAgIHByaW50ZigiJyIpOw0KICAgIA0KICAgICAgICAg
ICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQ0KICAgICAgICAgICAg
ICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47
DQogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklM
RV9fKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm1lbTIgPSBkb2hl
eChkYXRhMiwgbGVuMiwgJm9sZW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAg
cHJpbnRmKCIgIyVzI1xuIiwgbWVtMik7IA0KICAgICAgICAgICAgICAgICAgICAg
ICAgemZyZWUobWVtMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAg
ICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsN
CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICclLipzJ1xuIiwgbGVu
MiwgZGF0YTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAg
ICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAgICAgICAg
ICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsgMSk7DQogICAgICAgICAg
ICAgICAgICAgIG1lbWNweShyZXQsIGRhdGEyLCBsZW4yKTsNCiAgICAgICAgICAg
ICAgICAgICAgcmV0W2xlbjJdID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgICAg
ICpwbGVuID0gbGVuMjsgDQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAg
ICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAg
ICAgfQ0KICAgICAgICB9IA0KICAgIGlmKGRlcHRoKQ0KICAgICAgICB6ZnJlZShz
dGFja1tkZXB0aC0xXSk7IA0KICAgIGRlcHRoLS07DQogICAgcmV0dXJuIHJldDsN
Cn0NCg0KDQoNCg0KDQovKiA9PT09PVsgZ3NleHAuYyBdPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCiAg
IERlc2NyaXB0aW9uOiAgICAgU2V4cCByb3V0aW5lcy4NCg0KICAgUmV2aXNpb25z
Og0KDQogICAgICBSRVYgICBEQVRFICAgICAgICAgICAgQlkgICAgICAgICAgICAg
IERFU0NSSVBUSU9ODQogICAgICAtLS0tICAtLS0tLS0tLS0tLSAgICAgLS0tLS0t
LS0tLSAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAg
MC4wMCAgYXVnLjAzLjIwMTcgICAgIFBldGVyIEdsZW4gICAgICBJbml0aWFsIHZl
cnNpb24uDQogICAgICAwLjAwICBvY3QuMjAuMjAxNyAgICAgUGV0ZXIgR2xlbiAg
ICAgIFdvcmsgDQoNCiAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCiNp
bmNsdWRlIDxzdGRpby5oPg0KDQojaW5jbHVkZSAiZ2NyeXB0LmgiDQojaW5jbHVk
ZSAiZ2NyeS5oIg0KI2luY2x1ZGUgImdzZXhwLmgiDQojaW5jbHVkZSAiem1hbGxv
Yy5oIg0KI2luY2x1ZGUgIm1pc2MuaCINCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8NCi8vIFByaW50IHNleHAgdG8gbWVtb3J5DQovLyBGcmVlIHRoZSByZXN1
bHRpbmcgcG9pbnRlciB3aXRoIHpmcmVlDQoNCmNoYXIgKnNleHBfc3ByaW50KGdj
cnlfc2V4cF90IHNleHAsIGludCAqbGVuLCBpbnQgZm9ybWF0KQ0KDQp7DQogICAg
aW50IHNsZW4gPSBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgTlVMTCwg
MCk7DQogICAgKmxlbiA9IDA7DQogICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVf
Xyk7DQogICAgY2hhciAqcHBwID0gKGNoYXIqKXphbGxvYyhzbGVuKzEpOw0KICAg
IGlmKHBwcCA9PSBOVUxMKQ0KICAgICAgICByZXR1cm4gTlVMTDsNCg0KICAgIGdj
cnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBwcHAsIHNsZW4pOw0KICAgICps
ZW4gPSBzbGVuOw0KICAgIC8vIFplcm8gdGVybWluYXRlDQogICAgcHBwW3NsZW4t
MV0gPSAnXDAnOw0KICAgIHJldHVybihwcHApOw0KfQ0KDQovLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLw0KLy8gUHJpbnQgc2V4cCB0byBzdGRvdXQNCg0Kdm9pZCAg
ICBzZXhwX3ByaW50KGdjcnlfc2V4cF90IHJzYV9rZXlwYWlyKQ0KDQp7DQogICAg
aW50IGxlbjsNCiAgICBjaGFyICpwcHAgPSBzZXhwX3NwcmludChyc2Ffa2V5cGFp
ciwgJmxlbiwgR0NSWVNFWFBfRk1UX0FEVkFOQ0VEKTsNCiAgICBpZihwcHAgPT0g
TlVMTCkNCiAgICAgICAgcmV0dXJuOw0KICAgIHByaW50ZigiJXNcbiIsIHBwcCk7
DQogICAgemZyZWUocHBwKTsNCn0NCg0KY2hhciAgICAqc3RhY2tbMTJdOw0KaW50
ICAgICBkZXB0aCA9IDA7DQoNCnN0YXRpYyBjaGFyICpzZXhwX2RlY29kZV9vbmUo
Z2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVuLCBjb25zdCBjaGFyICpmaW5kc3Ry
KQ0KDQp7DQogICAgY2hhciAqcmV0ID0gTlVMTDsNCiAgICBpbnQgIG9uZWxlbiA9
IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7DQoNCiAgICAvL3ByaW50ZiggIm9uZTog
JWRcbiIsIG9uZWxlbik7DQogICAgc2V4cF9wcmludChsaXN0KTsNCiAgICANCiAg
ICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVuOyBsb29wKyspDQogICAg
ICAgIHsNCiAgICAgICAgaW50IGxlbjsNCiAgICAgICAgY29uc3QgY2hhciAqZGF0
YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAmbGVuKTsNCiAgICAg
ICAgaWYoZGF0YSA9PSBOVUxMKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAg
Z2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlzdCwgbG9vcCk7
DQogICAgICAgICAgICBpZihlbGVtZW50KQ0KICAgICAgICAgICAgICAgIHsNCiAg
ICAgICAgICAgICAgICBpbnQgbGVuMzsNCiAgICAgICAgICAgICAgICBjb25zdCBj
aGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhfZGF0YShlbGVtZW50LCAwLCAmbGVu
Myk7DQogICAgICAgICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xu
IiwgbGVuMywgZGF0YTMpOw0KICAgICAgICAgICAgICAgIGNoYXIgKm1lbXggPSB6
YWxsb2MobGVuMyArIDEpOw0KICAgICAgICAgICAgICAgIG1lbWNweShtZW14LCBk
YXRhMywgbGVuMyk7DQogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdcMCc7
IA0KICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICANCiAgICAg
ICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdvaW5nIHRvIGJlIDMgYXQgbWF4
DQogICAgICAgICAgICAgICAgaWYoZGVwdGggPCAxMikNCiAgICAgICAgICAgICAg
ICAgICAgZGVwdGgrKzsNCiAgICAgICAgICAgICAgICByZXQgPSBzZXhwX2RlY29k
ZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7DQogICAgICAgICAgICAgICAg
aWYocmV0KQ0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAg
ICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgICAg
IHsNCiAgICAgICAgICAgIC8vcHJpbnRmKCJkYXRhOiAlZCAnJS4qcydcbiIsIGxv
b3AsIGxlbiwgZGF0YSk7DQoNCiAgICAgICAgICAgIGludCBsZW4yOw0KICAgICAg
ICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBkYXRhLCBsZW4pID09IDAgfHwgZmlu
ZHN0clswXSA9PSAnXDAnICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAg
ICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlz
dCwgbG9vcCArIDEsICZsZW4yKTsNCiAgICAgICAgICAgICAgICBpZihkYXRhMikN
CiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvL3By
aW50ZigiJy8iKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBsb29wMyA9
IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspDQogICAgICAgICAgICAgICAgICAg
ICAgICBwcmludGYoIi8lcyIsIHN0YWNrW2xvb3AzXSk7DQogICAgICAgICAgICAg
ICAgICAgIHByaW50ZigiJyIpOw0KICAgIA0KICAgICAgICAgICAgICAgICAgICBp
Zihpc19iaW4oZGF0YTIsIGxlbjIpKQ0KICAgICAgICAgICAgICAgICAgICAgICAg
ew0KICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47DQogICAgICAgICAg
ICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAgICAg
ICAgICAgICAgICAgICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwgbGVu
MiwgJm9sZW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgIyVz
I1xuIiwgbWVtMik7IA0KICAgICAgICAgICAgICAgICAgICAgICAgemZyZWUobWVt
Mik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAg
ICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAg
ICAgICAgICAgICAgIHByaW50ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0YTIpOw0K
ICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB6
bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAgICAgICAgICAgICAgICAgICAg
cmV0ID0gIHphbGxvYyhsZW4yICsgMSk7DQogICAgICAgICAgICAgICAgICAgIG1l
bWNweShyZXQsIGRhdGEyLCBsZW4yKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0
W2xlbjJdID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgICAgICpwbGVuID0gbGVu
MjsgDQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAg
ICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAg
ICB9IA0KICAgIGlmKGRlcHRoKQ0KICAgICAgICB6ZnJlZShzdGFja1tkZXB0aC0x
XSk7IA0KICAgIGRlcHRoLS07DQogICAgcmV0dXJuIHJldDsNCn0NCg0KDQpjaGFy
ICAgICpzdGFja1sxMl07DQppbnQgICAgIGRlcHRoID0gMDsNCg0Kc3RhdGljIGNo
YXIgKnNleHBfZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4s
IGNvbnN0IGNoYXIgKmZpbmRzdHIpDQoNCnsNCiAgICBjaGFyICpyZXQgPSBOVUxM
Ow0KICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsNCg0K
ICAgIC8vcHJpbnRmKCAib25lOiAlZFxuIiwgb25lbGVuKTsNCiAgICBzZXhwX3By
aW50KGxpc3QpOw0KICAgIA0KICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBv
bmVsZW47IGxvb3ArKykNCiAgICAgICAgew0KICAgICAgICBpbnQgbGVuOw0KICAg
ICAgICBjb25zdCBjaGFyICpkYXRhID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3Qs
IGxvb3AsICZsZW4pOw0KICAgICAgICBpZihkYXRhID09IE5VTEwpDQogICAgICAg
ICAgICB7DQogICAgICAgICAgICBnY3J5X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9z
ZXhwX250aChsaXN0LCBsb29wKTsNCiAgICAgICAgICAgIGlmKGVsZW1lbnQpDQog
ICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGludCBsZW4zOw0KICAg
ICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9k
YXRhKGVsZW1lbnQsIDAsICZsZW4zKTsNCiAgICAgICAgICAgICAgICAvL3ByaW50
ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7DQogICAgICAgICAg
ICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhsZW4zICsgMSk7DQogICAgICAgICAg
ICAgICAgbWVtY3B5KG1lbXgsIGRhdGEzLCBsZW4zKTsNCiAgICAgICAgICAgICAg
ICBtZW14W2xlbjNdID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgc3RhY2tbZGVw
dGhdID0gbWVteDsgIA0KICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgaXQgaXMg
Z29pbmcgdG8gYmUgMyBhdCBtYXgNCiAgICAgICAgICAgICAgICBpZihkZXB0aCA8
IDEyKQ0KICAgICAgICAgICAgICAgICAgICBkZXB0aCsrOw0KICAgICAgICAgICAg
ICAgIHJldCA9IHNleHBfZGVjb2RlX29uZShlbGVtZW50LCBwbGVuLCBmaW5kc3Ry
KTsNCiAgICAgICAgICAgICAgICBpZihyZXQpDQogICAgICAgICAgICAgICAgICAg
IGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAg
ICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgLy9wcmludGYoImRh
dGE6ICVkICclLipzJ1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsNCg0KICAgICAgICAg
ICAgaW50IGxlbjI7DQogICAgICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRh
dGEsIGxlbikgPT0gMCB8fCBmaW5kc3RyWzBdID09ICdcMCcgKQ0KICAgICAgICAg
ICAgICAgIHsNCiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMiA9IGdj
cnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIpOw0KICAgICAg
ICAgICAgICAgIGlmKGRhdGEyKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAg
ICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIpOw0KICAgICAgICAgICAgICAg
ICAgICBmb3IoaW50IGxvb3AzID0gMDsgbG9vcDMgPCBkZXB0aDsgbG9vcDMrKykN
CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9v
cDNdKTsNCiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7DQogICAgDQog
ICAgICAgICAgICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpDQogICAg
ICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBp
bnQgb2xlbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVf
XywgX19GSUxFX18pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVt
MiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7DQogICAgICAgICAgICAgICAg
ICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0yKTsgDQogICAgICAgICAgICAg
ICAgICAgICAgICB6ZnJlZShtZW0yKTsNCiAgICAgICAgICAgICAgICAgICAgICAg
IH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAg
ICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMn
XG4iLCBsZW4yLCBkYXRhMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQog
ICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0K
ICAgICAgICAgICAgICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsNCiAg
ICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIpOw0KICAg
ICAgICAgICAgICAgICAgICByZXRbbGVuMl0gPSAnXDAnOyANCiAgICAgICAgICAg
ICAgICAgICAgKnBsZW4gPSBsZW4yOyANCiAgICAgICAgICAgICAgICAgICAgYnJl
YWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQog
ICAgICAgICAgICB9DQogICAgICAgIH0gDQogICAgaWYoZGVwdGgpDQogICAgICAg
IHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsgDQogICAgZGVwdGgtLTsNCiAgICByZXR1
cm4gcmV0Ow0KfQ0KDQoNCg0KDQoNCi8qID09PT09WyBnc2V4cC5jIF09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0NCg0KICAgRGVzY3JpcHRpb246ICAgICBTZXhwIHJvdXRpbmVzLg0KDQogICBS
ZXZpc2lvbnM6DQoNCiAgICAgIFJFViAgIERBVEUgICAgICAgICAgICBCWSAgICAg
ICAgICAgICAgREVTQ1JJUFRJT04NCiAgICAgIC0tLS0gIC0tLS0tLS0tLS0tICAg
ICAtLS0tLS0tLS0tICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
DQogICAgICAwLjAwICBhdWcuMDMuMjAxNyAgICAgUGV0ZXIgR2xlbiAgICAgIElu
aXRpYWwgdmVyc2lvbi4NCiAgICAgIDAuMDAgIG9jdC4yMC4yMDE3ICAgICBQZXRl
ciBHbGVuICAgICAgV29yayANCg0KICAgPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g
Ki8NCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQoNCiNpbmNsdWRlICJnY3J5cHQuaCIN
CiNpbmNsdWRlICJnY3J5LmgiDQojaW5jbHVkZSAiZ3NleHAuaCINCiNpbmNsdWRl
ICJ6bWFsbG9jLmgiDQojaW5jbHVkZSAibWlzYy5oIg0KDQovLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLw0KLy8gUHJpbnQgc2V4cCB0byBtZW1vcnkNCi8vIEZyZWUg
dGhlIHJlc3VsdGluZyBwb2ludGVyIHdpdGggemZyZWUNCg0KY2hhciAqc2V4cF9z
cHJpbnQoZ2NyeV9zZXhwX3Qgc2V4cCwgaW50ICpsZW4sIGludCBmb3JtYXQpDQoN
CnsNCiAgICBpbnQgc2xlbiA9IGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0
LCBOVUxMLCAwKTsNCiAgICAqbGVuID0gMDsNCiAgICB6bGluZTIoX19MSU5FX18s
IF9fRklMRV9fKTsNCiAgICBjaGFyICpwcHAgPSAoY2hhciopemFsbG9jKHNsZW4r
MSk7DQogICAgaWYocHBwID09IE5VTEwpDQogICAgICAgIHJldHVybiBOVUxMOw0K
DQogICAgZ2NyeV9zZXhwX3NwcmludChzZXhwLCBmb3JtYXQsIHBwcCwgc2xlbik7
DQogICAgKmxlbiA9IHNsZW47DQogICAgLy8gWmVybyB0ZXJtaW5hdGUNCiAgICBw
cHBbc2xlbi0xXSA9ICdcMCc7DQogICAgcmV0dXJuKHBwcCk7DQp9DQoNCi8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBQcmludCBzZXhwIHRvIHN0ZG91dA0K
DQp2b2lkICAgIHNleHBfcHJpbnQoZ2NyeV9zZXhwX3QgcnNhX2tleXBhaXIpDQoN
CnsNCiAgICBpbnQgbGVuOw0KICAgIGNoYXIgKnBwcCA9IHNleHBfc3ByaW50KHJz
YV9rZXlwYWlyLCAmbGVuLCBHQ1JZU0VYUF9GTVRfQURWQU5DRUQpOw0KICAgIGlm
KHBwcCA9PSBOVUxMKQ0KICAgICAgICByZXR1cm47DQogICAgcHJpbnRmKCIlc1xu
IiwgcHBwKTsNCiAgICB6ZnJlZShwcHApOw0KfQ0KDQpjaGFyICAgICpzdGFja1sx
Ml07DQppbnQgICAgIGRlcHRoID0gMDsNCg0Kc3RhdGljIGNoYXIgKnNleHBfZGVj
b2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0IGNoYXIg
KmZpbmRzdHIpDQoNCnsNCiAgICBjaGFyICpyZXQgPSBOVUxMOw0KICAgIGludCAg
b25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsNCg0KICAgIC8vcHJpbnRm
KCAib25lOiAlZFxuIiwgb25lbGVuKTsNCiAgICBzZXhwX3ByaW50KGxpc3QpOw0K
ICAgIA0KICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3Ar
KykNCiAgICAgICAgew0KICAgICAgICBpbnQgbGVuOw0KICAgICAgICBjb25zdCBj
aGFyICpkYXRhID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4p
Ow0KICAgICAgICBpZihkYXRhID09IE5VTEwpDQogICAgICAgICAgICB7DQogICAg
ICAgICAgICBnY3J5X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0
LCBsb29wKTsNCiAgICAgICAgICAgIGlmKGVsZW1lbnQpDQogICAgICAgICAgICAg
ICAgew0KICAgICAgICAgICAgICAgIGludCBsZW4zOw0KICAgICAgICAgICAgICAg
IGNvbnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQs
IDAsICZsZW4zKTsNCiAgICAgICAgICAgICAgICAvL3ByaW50ZigiZWxlbWVudDog
JyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7DQogICAgICAgICAgICAgICAgY2hhciAq
bWVteCA9IHphbGxvYyhsZW4zICsgMSk7DQogICAgICAgICAgICAgICAgbWVtY3B5
KG1lbXgsIGRhdGEzLCBsZW4zKTsNCiAgICAgICAgICAgICAgICBtZW14W2xlbjNd
ID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsg
IA0KICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUg
MyBhdCBtYXgNCiAgICAgICAgICAgICAgICBpZihkZXB0aCA8IDEyKQ0KICAgICAg
ICAgICAgICAgICAgICBkZXB0aCsrOw0KICAgICAgICAgICAgICAgIHJldCA9IHNl
eHBfZGVjb2RlX29uZShlbGVtZW50LCBwbGVuLCBmaW5kc3RyKTsNCiAgICAgICAg
ICAgICAgICBpZihyZXQpDQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAg
ICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAg
ICAgICAgICAgew0KICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipz
J1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsNCg0KICAgICAgICAgICAgaW50IGxlbjI7
DQogICAgICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0g
MCB8fCBmaW5kc3RyWzBdID09ICdcMCcgKQ0KICAgICAgICAgICAgICAgIHsNCiAg
ICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMiA9IGdjcnlfc2V4cF9udGhf
ZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIpOw0KICAgICAgICAgICAgICAgIGlm
KGRhdGEyKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAg
ICAgIC8vcHJpbnRmKCInLyIpOw0KICAgICAgICAgICAgICAgICAgICBmb3IoaW50
IGxvb3AzID0gMDsgbG9vcDMgPCBkZXB0aDsgbG9vcDMrKykNCiAgICAgICAgICAg
ICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsNCiAgICAg
ICAgICAgICAgICAgICAgcHJpbnRmKCInIik7DQogICAgDQogICAgICAgICAgICAg
ICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpDQogICAgICAgICAgICAgICAg
ICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnQgb2xlbjsNCiAg
ICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18p
Ow0KICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVtMiA9IGRvaGV4KGRh
dGEyLCBsZW4yLCAmb2xlbik7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmlu
dGYoIiAjJXMjXG4iLCBtZW0yKTsgDQogICAgICAgICAgICAgICAgICAgICAgICB6
ZnJlZShtZW0yKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAg
ICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAg
ICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBsZW4yLCBk
YXRhMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAg
ICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0KICAgICAgICAgICAg
ICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsNCiAgICAgICAgICAgICAg
ICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIpOw0KICAgICAgICAgICAgICAg
ICAgICByZXRbbGVuMl0gPSAnXDAnOyANCiAgICAgICAgICAgICAgICAgICAgKnBs
ZW4gPSBsZW4yOyANCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAg
ICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9
DQogICAgICAgIH0gDQogICAgaWYoZGVwdGgpDQogICAgICAgIHpmcmVlKHN0YWNr
W2RlcHRoLTFdKTsgDQogICAgZGVwdGgtLTsNCiAgICByZXR1cm4gcmV0Ow0KfQ0K
DQoNCmNoYXIgICAgKnN0YWNrWzEyXTsNCmludCAgICAgZGVwdGggPSAwOw0KDQpz
dGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4cF90IGxpc3QsIGlu
dCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikNCg0Kew0KICAgIGNoYXIgKnJl
dCA9IE5VTEw7DQogICAgaW50ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxp
c3QpOw0KDQogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVsZW4pOw0KICAg
IHNleHBfcHJpbnQobGlzdCk7DQogICAgDQogICAgZm9yKGludCBsb29wID0gMDsg
bG9vcCA8IG9uZWxlbjsgbG9vcCsrKQ0KICAgICAgICB7DQogICAgICAgIGludCBs
ZW47DQogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRoX2Rh
dGEobGlzdCwgbG9vcCwgJmxlbik7DQogICAgICAgIGlmKGRhdGEgPT0gTlVMTCkN
CiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQg
PSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOw0KICAgICAgICAgICAgaWYoZWxl
bWVudCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaW50IGxl
bjM7DQogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTMgPSBnY3J5X3Nl
eHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOw0KICAgICAgICAgICAgICAg
IC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydcbiIsIGxlbjMsIGRhdGEzKTsNCiAg
ICAgICAgICAgICAgICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsNCiAg
ICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxlbjMpOw0KICAgICAg
ICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyANCiAgICAgICAgICAgICAgICBz
dGFja1tkZXB0aF0gPSBtZW14OyAgDQogICAgICAgICAgICAgICAgLy8gV2Uga25v
dyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heA0KICAgICAgICAgICAgICAgIGlm
KGRlcHRoIDwgMTIpDQogICAgICAgICAgICAgICAgICAgIGRlcHRoKys7DQogICAg
ICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQsIHBsZW4s
IGZpbmRzdHIpOw0KICAgICAgICAgICAgICAgIGlmKHJldCkNCiAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAg
fQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAvL3By
aW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRhdGEpOw0KDQog
ICAgICAgICAgICBpbnQgbGVuMjsNCiAgICAgICAgICAgIGlmKHN0cm5jbXAoZmlu
ZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1wwJyApDQog
ICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRh
dGEyID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7
DQogICAgICAgICAgICAgICAgaWYoZGF0YTIpDQogICAgICAgICAgICAgICAgICAg
IHsNCiAgICAgICAgICAgICAgICAgICAgLy9wcmludGYoIicvIik7DQogICAgICAg
ICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBs
b29wMysrKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIvJXMiLCBz
dGFja1tsb29wM10pOw0KICAgICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsN
CiAgICANCiAgICAgICAgICAgICAgICAgICAgaWYoaXNfYmluKGRhdGEyLCBsZW4y
KSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBvbGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgemxpbmUy
KF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAgICAgICAgICAgICAgICAgICBj
aGFyICptZW0yID0gZG9oZXgoZGF0YTIsIGxlbjIsICZvbGVuKTsNCiAgICAgICAg
ICAgICAgICAgICAgICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyANCiAgICAg
ICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOw0KICAgICAgICAgICAgICAg
ICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAg
ICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYo
IiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsNCiAgICAgICAgICAgICAgICAgICAg
ICAgIH0NCiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJ
TEVfXyk7DQogICAgICAgICAgICAgICAgICAgIHJldCA9ICB6YWxsb2MobGVuMiAr
IDEpOw0KICAgICAgICAgICAgICAgICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVu
Mik7DQogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IA0KICAg
ICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7IA0KICAgICAgICAgICAgICAg
ICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAg
ICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSANCiAgICBpZihkZXB0aCkN
CiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0pOyANCiAgICBkZXB0aC0tOw0K
ICAgIHJldHVybiByZXQ7DQp9DQoNCg0KDQoNCg0KLyogPT09PT1bIGdzZXhwLmMg
XT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQ0KDQogICBEZXNjcmlwdGlvbjogICAgIFNleHAgcm91dGluZXMu
DQoNCiAgIFJldmlzaW9uczoNCg0KICAgICAgUkVWICAgREFURSAgICAgICAgICAg
IEJZICAgICAgICAgICAgICBERVNDUklQVElPTg0KICAgICAgLS0tLSAgLS0tLS0t
LS0tLS0gICAgIC0tLS0tLS0tLS0gICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0NCiAgICAgIDAuMDAgIGF1Zy4wMy4yMDE3ICAgICBQZXRlciBHbGVu
ICAgICAgSW5pdGlhbCB2ZXJzaW9uLg0KICAgICAgMC4wMCAgb2N0LjIwLjIwMTcg
ICAgIFBldGVyIEdsZW4gICAgICBXb3JrIA0KDQogICA9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PSAqLw0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCg0KI2luY2x1ZGUgImdj
cnlwdC5oIg0KI2luY2x1ZGUgImdjcnkuaCINCiNpbmNsdWRlICJnc2V4cC5oIg0K
I2luY2x1ZGUgInptYWxsb2MuaCINCiNpbmNsdWRlICJtaXNjLmgiDQoNCi8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBQcmludCBzZXhwIHRvIG1lbW9yeQ0K
Ly8gRnJlZSB0aGUgcmVzdWx0aW5nIHBvaW50ZXIgd2l0aCB6ZnJlZQ0KDQpjaGFy
ICpzZXhwX3NwcmludChnY3J5X3NleHBfdCBzZXhwLCBpbnQgKmxlbiwgaW50IGZv
cm1hdCkNCg0Kew0KICAgIGludCBzbGVuID0gZ2NyeV9zZXhwX3NwcmludChzZXhw
LCBmb3JtYXQsIE5VTEwsIDApOw0KICAgICpsZW4gPSAwOw0KICAgIHpsaW5lMihf
X0xJTkVfXywgX19GSUxFX18pOw0KICAgIGNoYXIgKnBwcCA9IChjaGFyKil6YWxs
b2Moc2xlbisxKTsNCiAgICBpZihwcHAgPT0gTlVMTCkNCiAgICAgICAgcmV0dXJu
IE5VTEw7DQoNCiAgICBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgcHBw
LCBzbGVuKTsNCiAgICAqbGVuID0gc2xlbjsNCiAgICAvLyBaZXJvIHRlcm1pbmF0
ZQ0KICAgIHBwcFtzbGVuLTFdID0gJ1wwJzsNCiAgICByZXR1cm4ocHBwKTsNCn0N
Cg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vIFByaW50IHNleHAgdG8g
c3Rkb3V0DQoNCnZvaWQgICAgc2V4cF9wcmludChnY3J5X3NleHBfdCByc2Ffa2V5
cGFpcikNCg0Kew0KICAgIGludCBsZW47DQogICAgY2hhciAqcHBwID0gc2V4cF9z
cHJpbnQocnNhX2tleXBhaXIsICZsZW4sIEdDUllTRVhQX0ZNVF9BRFZBTkNFRCk7
DQogICAgaWYocHBwID09IE5VTEwpDQogICAgICAgIHJldHVybjsNCiAgICBwcmlu
dGYoIiVzXG4iLCBwcHApOw0KICAgIHpmcmVlKHBwcCk7DQp9DQoNCmNoYXIgICAg
KnN0YWNrWzEyXTsNCmludCAgICAgZGVwdGggPSAwOw0KDQpzdGF0aWMgY2hhciAq
c2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4cF90IGxpc3QsIGludCAqcGxlbiwgY29u
c3QgY2hhciAqZmluZHN0cikNCg0Kew0KICAgIGNoYXIgKnJldCA9IE5VTEw7DQog
ICAgaW50ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOw0KDQogICAg
Ly9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVsZW4pOw0KICAgIHNleHBfcHJpbnQo
bGlzdCk7DQogICAgDQogICAgZm9yKGludCBsb29wID0gMDsgbG9vcCA8IG9uZWxl
bjsgbG9vcCsrKQ0KICAgICAgICB7DQogICAgICAgIGludCBsZW47DQogICAgICAg
IGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9v
cCwgJmxlbik7DQogICAgICAgIGlmKGRhdGEgPT0gTlVMTCkNCiAgICAgICAgICAg
IHsNCiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQgPSBnY3J5X3NleHBf
bnRoKGxpc3QsIGxvb3ApOw0KICAgICAgICAgICAgaWYoZWxlbWVudCkNCiAgICAg
ICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaW50IGxlbjM7DQogICAgICAg
ICAgICAgICAgY29uc3QgY2hhciAqZGF0YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEo
ZWxlbWVudCwgMCwgJmxlbjMpOw0KICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJl
bGVtZW50OiAnJS4qcydcbiIsIGxlbjMsIGRhdGEzKTsNCiAgICAgICAgICAgICAg
ICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsNCiAgICAgICAgICAgICAg
ICBtZW1jcHkobWVteCwgZGF0YTMsIGxlbjMpOw0KICAgICAgICAgICAgICAgIG1l
bXhbbGVuM10gPSAnXDAnOyANCiAgICAgICAgICAgICAgICBzdGFja1tkZXB0aF0g
PSBtZW14OyAgDQogICAgICAgICAgICAgICAgLy8gV2Uga25vdyBpdCBpcyBnb2lu
ZyB0byBiZSAzIGF0IG1heA0KICAgICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIp
DQogICAgICAgICAgICAgICAgICAgIGRlcHRoKys7DQogICAgICAgICAgICAgICAg
cmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQsIHBsZW4sIGZpbmRzdHIpOw0K
ICAgICAgICAgICAgICAgIGlmKHJldCkNCiAgICAgICAgICAgICAgICAgICAgYnJl
YWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICBl
bHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAvL3ByaW50ZigiZGF0YTog
JWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRhdGEpOw0KDQogICAgICAgICAgICBp
bnQgbGVuMjsNCiAgICAgICAgICAgIGlmKHN0cm5jbXAoZmluZHN0ciwgZGF0YSwg
bGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1wwJyApDQogICAgICAgICAgICAg
ICAgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEyID0gZ2NyeV9z
ZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7DQogICAgICAgICAg
ICAgICAgaWYoZGF0YTIpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAg
ICAgICAgICAgICAgLy9wcmludGYoIicvIik7DQogICAgICAgICAgICAgICAgICAg
IGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBsb29wMysrKQ0KICAg
ICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10p
Ow0KICAgICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsNCiAgICANCiAgICAg
ICAgICAgICAgICAgICAgaWYoaXNfYmluKGRhdGEyLCBsZW4yKSkNCiAgICAgICAg
ICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGludCBv
bGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBf
X0ZJTEVfXyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0g
ZG9oZXgoZGF0YTIsIGxlbjIsICZvbGVuKTsNCiAgICAgICAgICAgICAgICAgICAg
ICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyANCiAgICAgICAgICAgICAgICAg
ICAgICAgIHpmcmVlKG1lbTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0K
ICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAg
ICB7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIs
IGxlbjIsIGRhdGEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAg
ICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAg
ICAgICAgICAgICAgICAgIHJldCA9ICB6YWxsb2MobGVuMiArIDEpOw0KICAgICAg
ICAgICAgICAgICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7DQogICAgICAg
ICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IA0KICAgICAgICAgICAgICAg
ICAgICAqcGxlbiA9IGxlbjI7IA0KICAgICAgICAgICAgICAgICAgICBicmVhazsN
CiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAg
ICAgICAgIH0NCiAgICAgICAgfSANCiAgICBpZihkZXB0aCkNCiAgICAgICAgemZy
ZWUoc3RhY2tbZGVwdGgtMV0pOyANCiAgICBkZXB0aC0tOw0KICAgIHJldHVybiBy
ZXQ7DQp9DQoNCg0KY2hhciAgICAqc3RhY2tbMTJdOw0KaW50ICAgICBkZXB0aCA9
IDA7DQoNCnN0YXRpYyBjaGFyICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3Qg
bGlzdCwgaW50ICpwbGVuLCBjb25zdCBjaGFyICpmaW5kc3RyKQ0KDQp7DQogICAg
Y2hhciAqcmV0ID0gTlVMTDsNCiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9s
ZW5ndGgobGlzdCk7DQoNCiAgICAvL3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxl
bik7DQogICAgc2V4cF9wcmludChsaXN0KTsNCiAgICANCiAgICBmb3IoaW50IGxv
b3AgPSAwOyBsb29wIDwgb25lbGVuOyBsb29wKyspDQogICAgICAgIHsNCiAgICAg
ICAgaW50IGxlbjsNCiAgICAgICAgY29uc3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4
cF9udGhfZGF0YShsaXN0LCBsb29wLCAmbGVuKTsNCiAgICAgICAgaWYoZGF0YSA9
PSBOVUxMKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgZ2NyeV9zZXhwX3Qg
ZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlzdCwgbG9vcCk7DQogICAgICAgICAg
ICBpZihlbGVtZW50KQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAg
ICBpbnQgbGVuMzsNCiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9
IGdjcnlfc2V4cF9udGhfZGF0YShlbGVtZW50LCAwLCAmbGVuMyk7DQogICAgICAg
ICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVuMywgZGF0
YTMpOw0KICAgICAgICAgICAgICAgIGNoYXIgKm1lbXggPSB6YWxsb2MobGVuMyAr
IDEpOw0KICAgICAgICAgICAgICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7
DQogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IA0KICAgICAgICAg
ICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICANCiAgICAgICAgICAgICAgICAv
LyBXZSBrbm93IGl0IGlzIGdvaW5nIHRvIGJlIDMgYXQgbWF4DQogICAgICAgICAg
ICAgICAgaWYoZGVwdGggPCAxMikNCiAgICAgICAgICAgICAgICAgICAgZGVwdGgr
KzsNCiAgICAgICAgICAgICAgICByZXQgPSBzZXhwX2RlY29kZV9vbmUoZWxlbWVu
dCwgcGxlbiwgZmluZHN0cik7DQogICAgICAgICAgICAgICAgaWYocmV0KQ0KICAg
ICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAg
ICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAg
ICAgIC8vcHJpbnRmKCJkYXRhOiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0
YSk7DQoNCiAgICAgICAgICAgIGludCBsZW4yOw0KICAgICAgICAgICAgaWYoc3Ry
bmNtcChmaW5kc3RyLCBkYXRhLCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAn
XDAnICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCArIDEs
ICZsZW4yKTsNCiAgICAgICAgICAgICAgICBpZihkYXRhMikNCiAgICAgICAgICAg
ICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAvL3ByaW50ZigiJy8iKTsN
CiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwg
ZGVwdGg7IGxvb3AzKyspDQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYo
Ii8lcyIsIHN0YWNrW2xvb3AzXSk7DQogICAgICAgICAgICAgICAgICAgIHByaW50
ZigiJyIpOw0KICAgIA0KICAgICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0
YTIsIGxlbjIpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAg
ICAgICAgICAgICAgICAgaW50IG9sZW47DQogICAgICAgICAgICAgICAgICAgICAg
ICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAgICAgICAgICAgICAgICAg
ICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4pOw0K
ICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgIyVzI1xuIiwgbWVtMik7
IA0KICAgICAgICAgICAgICAgICAgICAgICAgemZyZWUobWVtMik7DQogICAgICAg
ICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAg
ICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAg
IHByaW50ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0YTIpOw0KICAgICAgICAgICAg
ICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5F
X18sIF9fRklMRV9fKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxv
YyhsZW4yICsgMSk7DQogICAgICAgICAgICAgICAgICAgIG1lbWNweShyZXQsIGRh
dGEyLCBsZW4yKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0W2xlbjJdID0gJ1ww
JzsgDQogICAgICAgICAgICAgICAgICAgICpwbGVuID0gbGVuMjsgDQogICAgICAg
ICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAg
ICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IA0KICAgIGlm
KGRlcHRoKQ0KICAgICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IA0KICAgIGRl
cHRoLS07DQogICAgcmV0dXJuIHJldDsNCn0NCg0KDQoNCg0KDQovKiA9PT09PVsg
Z3NleHAuYyBdPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09DQoNCiAgIERlc2NyaXB0aW9uOiAgICAgU2V4cCBy
b3V0aW5lcy4NCg0KICAgUmV2aXNpb25zOg0KDQogICAgICBSRVYgICBEQVRFICAg
ICAgICAgICAgQlkgICAgICAgICAgICAgIERFU0NSSVBUSU9ODQogICAgICAtLS0t
ICAtLS0tLS0tLS0tLSAgICAgLS0tLS0tLS0tLSAgICAgIC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgMC4wMCAgYXVnLjAzLjIwMTcgICAgIFBl
dGVyIEdsZW4gICAgICBJbml0aWFsIHZlcnNpb24uDQogICAgICAwLjAwICBvY3Qu
MjAuMjAxNyAgICAgUGV0ZXIgR2xlbiAgICAgIFdvcmsgDQoNCiAgID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ICovDQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KDQojaW5j
bHVkZSAiZ2NyeXB0LmgiDQojaW5jbHVkZSAiZ2NyeS5oIg0KI2luY2x1ZGUgImdz
ZXhwLmgiDQojaW5jbHVkZSAiem1hbGxvYy5oIg0KI2luY2x1ZGUgIm1pc2MuaCIN
Cg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vIFByaW50IHNleHAgdG8g
bWVtb3J5DQovLyBGcmVlIHRoZSByZXN1bHRpbmcgcG9pbnRlciB3aXRoIHpmcmVl
DQoNCmNoYXIgKnNleHBfc3ByaW50KGdjcnlfc2V4cF90IHNleHAsIGludCAqbGVu
LCBpbnQgZm9ybWF0KQ0KDQp7DQogICAgaW50IHNsZW4gPSBnY3J5X3NleHBfc3By
aW50KHNleHAsIGZvcm1hdCwgTlVMTCwgMCk7DQogICAgKmxlbiA9IDA7DQogICAg
emxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgY2hhciAqcHBwID0gKGNo
YXIqKXphbGxvYyhzbGVuKzEpOw0KICAgIGlmKHBwcCA9PSBOVUxMKQ0KICAgICAg
ICByZXR1cm4gTlVMTDsNCg0KICAgIGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9y
bWF0LCBwcHAsIHNsZW4pOw0KICAgICpsZW4gPSBzbGVuOw0KICAgIC8vIFplcm8g
dGVybWluYXRlDQogICAgcHBwW3NsZW4tMV0gPSAnXDAnOw0KICAgIHJldHVybihw
cHApOw0KfQ0KDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gUHJpbnQg
c2V4cCB0byBzdGRvdXQNCg0Kdm9pZCAgICBzZXhwX3ByaW50KGdjcnlfc2V4cF90
IHJzYV9rZXlwYWlyKQ0KDQp7DQogICAgaW50IGxlbjsNCiAgICBjaGFyICpwcHAg
PSBzZXhwX3NwcmludChyc2Ffa2V5cGFpciwgJmxlbiwgR0NSWVNFWFBfRk1UX0FE
VkFOQ0VEKTsNCiAgICBpZihwcHAgPT0gTlVMTCkNCiAgICAgICAgcmV0dXJuOw0K
ICAgIHByaW50ZigiJXNcbiIsIHBwcCk7DQogICAgemZyZWUocHBwKTsNCn0NCg0K
Y2hhciAgICAqc3RhY2tbMTJdOw0KaW50ICAgICBkZXB0aCA9IDA7DQoNCnN0YXRp
YyBjaGFyICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpw
bGVuLCBjb25zdCBjaGFyICpmaW5kc3RyKQ0KDQp7DQogICAgY2hhciAqcmV0ID0g
TlVMTDsNCiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7
DQoNCiAgICAvL3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7DQogICAgc2V4
cF9wcmludChsaXN0KTsNCiAgICANCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29w
IDwgb25lbGVuOyBsb29wKyspDQogICAgICAgIHsNCiAgICAgICAgaW50IGxlbjsN
CiAgICAgICAgY29uc3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShs
aXN0LCBsb29wLCAmbGVuKTsNCiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQ0KICAg
ICAgICAgICAgew0KICAgICAgICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdj
cnlfc2V4cF9udGgobGlzdCwgbG9vcCk7DQogICAgICAgICAgICBpZihlbGVtZW50
KQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpbnQgbGVuMzsN
CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9u
dGhfZGF0YShlbGVtZW50LCAwLCAmbGVuMyk7DQogICAgICAgICAgICAgICAgLy9w
cmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVuMywgZGF0YTMpOw0KICAgICAg
ICAgICAgICAgIGNoYXIgKm1lbXggPSB6YWxsb2MobGVuMyArIDEpOw0KICAgICAg
ICAgICAgICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7DQogICAgICAgICAg
ICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IA0KICAgICAgICAgICAgICAgIHN0YWNr
W2RlcHRoXSA9IG1lbXg7ICANCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0
IGlzIGdvaW5nIHRvIGJlIDMgYXQgbWF4DQogICAgICAgICAgICAgICAgaWYoZGVw
dGggPCAxMikNCiAgICAgICAgICAgICAgICAgICAgZGVwdGgrKzsNCiAgICAgICAg
ICAgICAgICByZXQgPSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmlu
ZHN0cik7DQogICAgICAgICAgICAgICAgaWYocmV0KQ0KICAgICAgICAgICAgICAg
ICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQog
ICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIC8vcHJpbnRm
KCJkYXRhOiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7DQoNCiAgICAg
ICAgICAgIGludCBsZW4yOw0KICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3Ry
LCBkYXRhLCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkNCiAgICAg
ICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIg
PSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCArIDEsICZsZW4yKTsNCiAg
ICAgICAgICAgICAgICBpZihkYXRhMikNCiAgICAgICAgICAgICAgICAgICAgew0K
ICAgICAgICAgICAgICAgICAgICAvL3ByaW50ZigiJy8iKTsNCiAgICAgICAgICAg
ICAgICAgICAgZm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3Az
KyspDQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNr
W2xvb3AzXSk7DQogICAgICAgICAgICAgICAgICAgIHByaW50ZigiJyIpOw0KICAg
IA0KICAgICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQ0K
ICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAg
ICAgaW50IG9sZW47DQogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19M
SU5FX18sIF9fRklMRV9fKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIg
Km1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4pOw0KICAgICAgICAgICAg
ICAgICAgICAgICAgcHJpbnRmKCIgIyVzI1xuIiwgbWVtMik7IA0KICAgICAgICAg
ICAgICAgICAgICAgICAgemZyZWUobWVtMik7DQogICAgICAgICAgICAgICAgICAg
ICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAg
ICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICcl
LipzJ1xuIiwgbGVuMiwgZGF0YTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAg
fQ0KICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9f
KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsgMSk7
DQogICAgICAgICAgICAgICAgICAgIG1lbWNweShyZXQsIGRhdGEyLCBsZW4yKTsN
CiAgICAgICAgICAgICAgICAgICAgcmV0W2xlbjJdID0gJ1wwJzsgDQogICAgICAg
ICAgICAgICAgICAgICpwbGVuID0gbGVuMjsgDQogICAgICAgICAgICAgICAgICAg
IGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAg
fQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IA0KICAgIGlmKGRlcHRoKQ0KICAg
ICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IA0KICAgIGRlcHRoLS07DQogICAg
cmV0dXJuIHJldDsNCn0NCg0KDQpjaGFyICAgICpzdGFja1sxMl07DQppbnQgICAg
IGRlcHRoID0gMDsNCg0Kc3RhdGljIGNoYXIgKnNleHBfZGVjb2RlX29uZShnY3J5
X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0IGNoYXIgKmZpbmRzdHIpDQoN
CnsNCiAgICBjaGFyICpyZXQgPSBOVUxMOw0KICAgIGludCAgb25lbGVuID0gZ2Ny
eV9zZXhwX2xlbmd0aChsaXN0KTsNCg0KICAgIC8vcHJpbnRmKCAib25lOiAlZFxu
Iiwgb25lbGVuKTsNCiAgICBzZXhwX3ByaW50KGxpc3QpOw0KICAgIA0KICAgIGZv
cihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3ArKykNCiAgICAgICAg
ew0KICAgICAgICBpbnQgbGVuOw0KICAgICAgICBjb25zdCBjaGFyICpkYXRhID0g
Z2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOw0KICAgICAgICBp
ZihkYXRhID09IE5VTEwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICBnY3J5
X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsNCiAg
ICAgICAgICAgIGlmKGVsZW1lbnQpDQogICAgICAgICAgICAgICAgew0KICAgICAg
ICAgICAgICAgIGludCBsZW4zOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIg
KmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQsIDAsICZsZW4zKTsN
CiAgICAgICAgICAgICAgICAvL3ByaW50ZigiZWxlbWVudDogJyUuKnMnXG4iLCBs
ZW4zLCBkYXRhMyk7DQogICAgICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxv
YyhsZW4zICsgMSk7DQogICAgICAgICAgICAgICAgbWVtY3B5KG1lbXgsIGRhdGEz
LCBsZW4zKTsNCiAgICAgICAgICAgICAgICBtZW14W2xlbjNdID0gJ1wwJzsgDQog
ICAgICAgICAgICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsgIA0KICAgICAgICAg
ICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgNCiAg
ICAgICAgICAgICAgICBpZihkZXB0aCA8IDEyKQ0KICAgICAgICAgICAgICAgICAg
ICBkZXB0aCsrOw0KICAgICAgICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29u
ZShlbGVtZW50LCBwbGVuLCBmaW5kc3RyKTsNCiAgICAgICAgICAgICAgICBpZihy
ZXQpDQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAg
IH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0K
ICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipzJ1xuIiwgbG9vcCwg
bGVuLCBkYXRhKTsNCg0KICAgICAgICAgICAgaW50IGxlbjI7DQogICAgICAgICAg
ICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0gMCB8fCBmaW5kc3Ry
WzBdID09ICdcMCcgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpkYXRhMiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBs
b29wICsgMSwgJmxlbjIpOw0KICAgICAgICAgICAgICAgIGlmKGRhdGEyKQ0KICAg
ICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRm
KCInLyIpOw0KICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3AzID0gMDsg
bG9vcDMgPCBkZXB0aDsgbG9vcDMrKykNCiAgICAgICAgICAgICAgICAgICAgICAg
IHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsNCiAgICAgICAgICAgICAgICAg
ICAgcHJpbnRmKCInIik7DQogICAgDQogICAgICAgICAgICAgICAgICAgIGlmKGlz
X2JpbihkYXRhMiwgbGVuMikpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQog
ICAgICAgICAgICAgICAgICAgICAgICBpbnQgb2xlbjsNCiAgICAgICAgICAgICAg
ICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0KICAgICAgICAg
ICAgICAgICAgICAgICAgY2hhciAqbWVtMiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAm
b2xlbik7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4i
LCBtZW0yKTsgDQogICAgICAgICAgICAgICAgICAgICAgICB6ZnJlZShtZW0yKTsN
CiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAg
ZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAg
ICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBsZW4yLCBkYXRhMik7DQogICAg
ICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHpsaW5l
MihfX0xJTkVfXywgX19GSUxFX18pOw0KICAgICAgICAgICAgICAgICAgICByZXQg
PSAgemFsbG9jKGxlbjIgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgbWVtY3B5
KHJldCwgZGF0YTIsIGxlbjIpOw0KICAgICAgICAgICAgICAgICAgICByZXRbbGVu
Ml0gPSAnXDAnOyANCiAgICAgICAgICAgICAgICAgICAgKnBsZW4gPSBsZW4yOyAN
CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAg
IH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0g
DQogICAgaWYoZGVwdGgpDQogICAgICAgIHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsg
DQogICAgZGVwdGgtLTsNCiAgICByZXR1cm4gcmV0Ow0KfQ0KDQoNCg0KDQoNCg0K
DQoNCi8qID09PT09WyBnc2V4cC5jIF09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KICAgRGVzY3JpcHRp
b246ICAgICBTZXhwIHJvdXRpbmVzLg0KDQogICBSZXZpc2lvbnM6DQoNCiAgICAg
IFJFViAgIERBVEUgICAgICAgICAgICBCWSAgICAgICAgICAgICAgREVTQ1JJUFRJ
T04NCiAgICAgIC0tLS0gIC0tLS0tLS0tLS0tICAgICAtLS0tLS0tLS0tICAgICAg
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAwLjAwICBhdWcu
MDMuMjAxNyAgICAgUGV0ZXIgR2xlbiAgICAgIEluaXRpYWwgdmVyc2lvbi4NCiAg
ICAgIDAuMDAgIG9jdC4yMC4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgV29yayAN
Cg0KICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KI2luY2x1ZGUgPHN0
ZGlvLmg+DQoNCiNpbmNsdWRlICJnY3J5cHQuaCINCiNpbmNsdWRlICJnY3J5Lmgi
DQojaW5jbHVkZSAiZ3NleHAuaCINCiNpbmNsdWRlICJ6bWFsbG9jLmgiDQojaW5j
bHVkZSAibWlzYy5oIg0KDQovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KLy8g
UHJpbnQgc2V4cCB0byBtZW1vcnkNCi8vIEZyZWUgdGhlIHJlc3VsdGluZyBwb2lu
dGVyIHdpdGggemZyZWUNCg0KY2hhciAqc2V4cF9zcHJpbnQoZ2NyeV9zZXhwX3Qg
c2V4cCwgaW50ICpsZW4sIGludCBmb3JtYXQpDQoNCnsNCiAgICBpbnQgc2xlbiA9
IGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBOVUxMLCAwKTsNCiAgICAq
bGVuID0gMDsNCiAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAgICBj
aGFyICpwcHAgPSAoY2hhciopemFsbG9jKHNsZW4rMSk7DQogICAgaWYocHBwID09
IE5VTEwpDQogICAgICAgIHJldHVybiBOVUxMOw0KDQogICAgZ2NyeV9zZXhwX3Nw
cmludChzZXhwLCBmb3JtYXQsIHBwcCwgc2xlbik7DQogICAgKmxlbiA9IHNsZW47
DQogICAgLy8gWmVybyB0ZXJtaW5hdGUNCiAgICBwcHBbc2xlbi0xXSA9ICdcMCc7
DQogICAgcmV0dXJuKHBwcCk7DQp9DQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vDQovLyBQcmludCBzZXhwIHRvIHN0ZG91dA0KDQp2b2lkICAgIHNleHBfcHJp
bnQoZ2NyeV9zZXhwX3QgcnNhX2tleXBhaXIpDQoNCnsNCiAgICBpbnQgbGVuOw0K
ICAgIGNoYXIgKnBwcCA9IHNleHBfc3ByaW50KHJzYV9rZXlwYWlyLCAmbGVuLCBH
Q1JZU0VYUF9GTVRfQURWQU5DRUQpOw0KICAgIGlmKHBwcCA9PSBOVUxMKQ0KICAg
ICAgICByZXR1cm47DQogICAgcHJpbnRmKCIlc1xuIiwgcHBwKTsNCiAgICB6ZnJl
ZShwcHApOw0KfQ0KDQpjaGFyICAgICpzdGFja1sxMl07DQppbnQgICAgIGRlcHRo
ID0gMDsNCg0Kc3RhdGljIGNoYXIgKnNleHBfZGVjb2RlX29uZShnY3J5X3NleHBf
dCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0IGNoYXIgKmZpbmRzdHIpDQoNCnsNCiAg
ICBjaGFyICpyZXQgPSBOVUxMOw0KICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhw
X2xlbmd0aChsaXN0KTsNCg0KICAgIC8vcHJpbnRmKCAib25lOiAlZFxuIiwgb25l
bGVuKTsNCiAgICBzZXhwX3ByaW50KGxpc3QpOw0KICAgIA0KICAgIGZvcihpbnQg
bG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3ArKykNCiAgICAgICAgew0KICAg
ICAgICBpbnQgbGVuOw0KICAgICAgICBjb25zdCBjaGFyICpkYXRhID0gZ2NyeV9z
ZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOw0KICAgICAgICBpZihkYXRh
ID09IE5VTEwpDQogICAgICAgICAgICB7DQogICAgICAgICAgICBnY3J5X3NleHBf
dCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsNCiAgICAgICAg
ICAgIGlmKGVsZW1lbnQpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAg
ICAgIGludCBsZW4zOw0KICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEz
ID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQsIDAsICZsZW4zKTsNCiAgICAg
ICAgICAgICAgICAvL3ByaW50ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBk
YXRhMyk7DQogICAgICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhsZW4z
ICsgMSk7DQogICAgICAgICAgICAgICAgbWVtY3B5KG1lbXgsIGRhdGEzLCBsZW4z
KTsNCiAgICAgICAgICAgICAgICBtZW14W2xlbjNdID0gJ1wwJzsgDQogICAgICAg
ICAgICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsgIA0KICAgICAgICAgICAgICAg
IC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgNCiAgICAgICAg
ICAgICAgICBpZihkZXB0aCA8IDEyKQ0KICAgICAgICAgICAgICAgICAgICBkZXB0
aCsrOw0KICAgICAgICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29uZShlbGVt
ZW50LCBwbGVuLCBmaW5kc3RyKTsNCiAgICAgICAgICAgICAgICBpZihyZXQpDQog
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAg
ICAgICAgICAgIH0NCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAg
ICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipzJ1xuIiwgbG9vcCwgbGVuLCBk
YXRhKTsNCg0KICAgICAgICAgICAgaW50IGxlbjI7DQogICAgICAgICAgICBpZihz
dHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0gMCB8fCBmaW5kc3RyWzBdID09
ICdcMCcgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjb25z
dCBjaGFyICpkYXRhMiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsg
MSwgJmxlbjIpOw0KICAgICAgICAgICAgICAgIGlmKGRhdGEyKQ0KICAgICAgICAg
ICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIp
Ow0KICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3AzID0gMDsgbG9vcDMg
PCBkZXB0aDsgbG9vcDMrKykNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50
ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsNCiAgICAgICAgICAgICAgICAgICAgcHJp
bnRmKCInIik7DQogICAgDQogICAgICAgICAgICAgICAgICAgIGlmKGlzX2Jpbihk
YXRhMiwgbGVuMikpDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAg
ICAgICAgICAgICAgICAgICBpbnQgb2xlbjsNCiAgICAgICAgICAgICAgICAgICAg
ICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0KICAgICAgICAgICAgICAg
ICAgICAgICAgY2hhciAqbWVtMiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7
DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0y
KTsgDQogICAgICAgICAgICAgICAgICAgICAgICB6ZnJlZShtZW0yKTsNCiAgICAg
ICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0K
ICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAg
ICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBsZW4yLCBkYXRhMik7DQogICAgICAgICAg
ICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJ
TkVfXywgX19GSUxFX18pOw0KICAgICAgICAgICAgICAgICAgICByZXQgPSAgemFs
bG9jKGxlbjIgKyAxKTsNCiAgICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwg
ZGF0YTIsIGxlbjIpOw0KICAgICAgICAgICAgICAgICAgICByZXRbbGVuMl0gPSAn
XDAnOyANCiAgICAgICAgICAgICAgICAgICAgKnBsZW4gPSBsZW4yOyANCiAgICAg
ICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAg
ICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gDQogICAg
aWYoZGVwdGgpDQogICAgICAgIHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsgDQogICAg
ZGVwdGgtLTsNCiAgICByZXR1cm4gcmV0Ow0KfQ0KDQoNCmNoYXIgICAgKnN0YWNr
WzEyXTsNCmludCAgICAgZGVwdGggPSAwOw0KDQpzdGF0aWMgY2hhciAqc2V4cF9k
ZWNvZGVfb25lKGdjcnlfc2V4cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hh
ciAqZmluZHN0cikNCg0Kew0KICAgIGNoYXIgKnJldCA9IE5VTEw7DQogICAgaW50
ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOw0KDQogICAgLy9wcmlu
dGYoICJvbmU6ICVkXG4iLCBvbmVsZW4pOw0KICAgIHNleHBfcHJpbnQobGlzdCk7
DQogICAgDQogICAgZm9yKGludCBsb29wID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9v
cCsrKQ0KICAgICAgICB7DQogICAgICAgIGludCBsZW47DQogICAgICAgIGNvbnN0
IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCwgJmxl
bik7DQogICAgICAgIGlmKGRhdGEgPT0gTlVMTCkNCiAgICAgICAgICAgIHsNCiAg
ICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQgPSBnY3J5X3NleHBfbnRoKGxp
c3QsIGxvb3ApOw0KICAgICAgICAgICAgaWYoZWxlbWVudCkNCiAgICAgICAgICAg
ICAgICB7DQogICAgICAgICAgICAgICAgaW50IGxlbjM7DQogICAgICAgICAgICAg
ICAgY29uc3QgY2hhciAqZGF0YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVu
dCwgMCwgJmxlbjMpOw0KICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50
OiAnJS4qcydcbiIsIGxlbjMsIGRhdGEzKTsNCiAgICAgICAgICAgICAgICBjaGFy
ICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsNCiAgICAgICAgICAgICAgICBtZW1j
cHkobWVteCwgZGF0YTMsIGxlbjMpOw0KICAgICAgICAgICAgICAgIG1lbXhbbGVu
M10gPSAnXDAnOyANCiAgICAgICAgICAgICAgICBzdGFja1tkZXB0aF0gPSBtZW14
OyAgDQogICAgICAgICAgICAgICAgLy8gV2Uga25vdyBpdCBpcyBnb2luZyB0byBi
ZSAzIGF0IG1heA0KICAgICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIpDQogICAg
ICAgICAgICAgICAgICAgIGRlcHRoKys7DQogICAgICAgICAgICAgICAgcmV0ID0g
c2V4cF9kZWNvZGVfb25lKGVsZW1lbnQsIHBsZW4sIGZpbmRzdHIpOw0KICAgICAg
ICAgICAgICAgIGlmKHJldCkNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQog
ICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICBlbHNlDQog
ICAgICAgICAgICB7DQogICAgICAgICAgICAvL3ByaW50ZigiZGF0YTogJWQgJyUu
KnMnXG4iLCBsb29wLCBsZW4sIGRhdGEpOw0KDQogICAgICAgICAgICBpbnQgbGVu
MjsNCiAgICAgICAgICAgIGlmKHN0cm5jbXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9
PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1wwJyApDQogICAgICAgICAgICAgICAgew0K
ICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEyID0gZ2NyeV9zZXhwX250
aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7DQogICAgICAgICAgICAgICAg
aWYoZGF0YTIpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAg
ICAgICAgLy9wcmludGYoIicvIik7DQogICAgICAgICAgICAgICAgICAgIGZvcihp
bnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBsb29wMysrKQ0KICAgICAgICAg
ICAgICAgICAgICAgICAgcHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10pOw0KICAg
ICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsNCiAgICANCiAgICAgICAgICAg
ICAgICAgICAgaWYoaXNfYmluKGRhdGEyLCBsZW4yKSkNCiAgICAgICAgICAgICAg
ICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGludCBvbGVuOw0K
ICAgICAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVf
Xyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgo
ZGF0YTIsIGxlbjIsICZvbGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBy
aW50ZigiICMlcyNcbiIsIG1lbTIpOyANCiAgICAgICAgICAgICAgICAgICAgICAg
IHpmcmVlKG1lbTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAg
ICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB7DQog
ICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIs
IGRhdGEyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAg
ICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAgICAg
ICAgICAgICAgIHJldCA9ICB6YWxsb2MobGVuMiArIDEpOw0KICAgICAgICAgICAg
ICAgICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7DQogICAgICAgICAgICAg
ICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IA0KICAgICAgICAgICAgICAgICAgICAq
cGxlbiA9IGxlbjI7IA0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAg
ICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAg
IH0NCiAgICAgICAgfSANCiAgICBpZihkZXB0aCkNCiAgICAgICAgemZyZWUoc3Rh
Y2tbZGVwdGgtMV0pOyANCiAgICBkZXB0aC0tOw0KICAgIHJldHVybiByZXQ7DQp9
DQoNCg0KDQoNCg0KLyogPT09PT1bIGdzZXhwLmMgXT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQogICBE
ZXNjcmlwdGlvbjogICAgIFNleHAgcm91dGluZXMuDQoNCiAgIFJldmlzaW9uczoN
Cg0KICAgICAgUkVWICAgREFURSAgICAgICAgICAgIEJZICAgICAgICAgICAgICBE
RVNDUklQVElPTg0KICAgICAgLS0tLSAgLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0t
LS0gICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICAgIDAu
MDAgIGF1Zy4wMy4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgSW5pdGlhbCB2ZXJz
aW9uLg0KICAgICAgMC4wMCAgb2N0LjIwLjIwMTcgICAgIFBldGVyIEdsZW4gICAg
ICBXb3JrIA0KDQogICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQojaW5j
bHVkZSA8c3RkaW8uaD4NCg0KI2luY2x1ZGUgImdjcnlwdC5oIg0KI2luY2x1ZGUg
ImdjcnkuaCINCiNpbmNsdWRlICJnc2V4cC5oIg0KI2luY2x1ZGUgInptYWxsb2Mu
aCINCiNpbmNsdWRlICJtaXNjLmgiDQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vDQovLyBQcmludCBzZXhwIHRvIG1lbW9yeQ0KLy8gRnJlZSB0aGUgcmVzdWx0
aW5nIHBvaW50ZXIgd2l0aCB6ZnJlZQ0KDQpjaGFyICpzZXhwX3NwcmludChnY3J5
X3NleHBfdCBzZXhwLCBpbnQgKmxlbiwgaW50IGZvcm1hdCkNCg0Kew0KICAgIGlu
dCBzbGVuID0gZ2NyeV9zZXhwX3NwcmludChzZXhwLCBmb3JtYXQsIE5VTEwsIDAp
Ow0KICAgICpsZW4gPSAwOw0KICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18p
Ow0KICAgIGNoYXIgKnBwcCA9IChjaGFyKil6YWxsb2Moc2xlbisxKTsNCiAgICBp
ZihwcHAgPT0gTlVMTCkNCiAgICAgICAgcmV0dXJuIE5VTEw7DQoNCiAgICBnY3J5
X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgcHBwLCBzbGVuKTsNCiAgICAqbGVu
ID0gc2xlbjsNCiAgICAvLyBaZXJvIHRlcm1pbmF0ZQ0KICAgIHBwcFtzbGVuLTFd
ID0gJ1wwJzsNCiAgICByZXR1cm4ocHBwKTsNCn0NCg0KLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8NCi8vIFByaW50IHNleHAgdG8gc3Rkb3V0DQoNCnZvaWQgICAg
c2V4cF9wcmludChnY3J5X3NleHBfdCByc2Ffa2V5cGFpcikNCg0Kew0KICAgIGlu
dCBsZW47DQogICAgY2hhciAqcHBwID0gc2V4cF9zcHJpbnQocnNhX2tleXBhaXIs
ICZsZW4sIEdDUllTRVhQX0ZNVF9BRFZBTkNFRCk7DQogICAgaWYocHBwID09IE5V
TEwpDQogICAgICAgIHJldHVybjsNCiAgICBwcmludGYoIiVzXG4iLCBwcHApOw0K
ICAgIHpmcmVlKHBwcCk7DQp9DQoNCmNoYXIgICAgKnN0YWNrWzEyXTsNCmludCAg
ICAgZGVwdGggPSAwOw0KDQpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdj
cnlfc2V4cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikN
Cg0Kew0KICAgIGNoYXIgKnJldCA9IE5VTEw7DQogICAgaW50ICBvbmVsZW4gPSBn
Y3J5X3NleHBfbGVuZ3RoKGxpc3QpOw0KDQogICAgLy9wcmludGYoICJvbmU6ICVk
XG4iLCBvbmVsZW4pOw0KICAgIHNleHBfcHJpbnQobGlzdCk7DQogICAgDQogICAg
Zm9yKGludCBsb29wID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQ0KICAgICAg
ICB7DQogICAgICAgIGludCBsZW47DQogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEg
PSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCwgJmxlbik7DQogICAgICAg
IGlmKGRhdGEgPT0gTlVMTCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIGdj
cnlfc2V4cF90IGVsZW1lbnQgPSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOw0K
ICAgICAgICAgICAgaWYoZWxlbWVudCkNCiAgICAgICAgICAgICAgICB7DQogICAg
ICAgICAgICAgICAgaW50IGxlbjM7DQogICAgICAgICAgICAgICAgY29uc3QgY2hh
ciAqZGF0YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMp
Ow0KICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydcbiIs
IGxlbjMsIGRhdGEzKTsNCiAgICAgICAgICAgICAgICBjaGFyICptZW14ID0gemFs
bG9jKGxlbjMgKyAxKTsNCiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0
YTMsIGxlbjMpOw0KICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyAN
CiAgICAgICAgICAgICAgICBzdGFja1tkZXB0aF0gPSBtZW14OyAgDQogICAgICAg
ICAgICAgICAgLy8gV2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heA0K
ICAgICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIpDQogICAgICAgICAgICAgICAg
ICAgIGRlcHRoKys7DQogICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVf
b25lKGVsZW1lbnQsIHBsZW4sIGZpbmRzdHIpOw0KICAgICAgICAgICAgICAgIGlm
KHJldCkNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAg
ICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICB7
DQogICAgICAgICAgICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29w
LCBsZW4sIGRhdGEpOw0KDQogICAgICAgICAgICBpbnQgbGVuMjsNCiAgICAgICAg
ICAgIGlmKHN0cm5jbXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRz
dHJbMF0gPT0gJ1wwJyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAg
ICAgIGNvbnN0IGNoYXIgKmRhdGEyID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3Qs
IGxvb3AgKyAxLCAmbGVuMik7DQogICAgICAgICAgICAgICAgaWYoZGF0YTIpDQog
ICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy9wcmlu
dGYoIicvIik7DQogICAgICAgICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAw
OyBsb29wMyA8IGRlcHRoOyBsb29wMysrKQ0KICAgICAgICAgICAgICAgICAgICAg
ICAgcHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10pOw0KICAgICAgICAgICAgICAg
ICAgICBwcmludGYoIiciKTsNCiAgICANCiAgICAgICAgICAgICAgICAgICAgaWYo
aXNfYmluKGRhdGEyLCBsZW4yKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsN
CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBvbGVuOw0KICAgICAgICAgICAg
ICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAg
ICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgoZGF0YTIsIGxlbjIs
ICZvbGVuKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICMlcyNc
biIsIG1lbTIpOyANCiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIp
Ow0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAg
ICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAg
ICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsNCiAg
ICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgemxp
bmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAgICAgICAgICAgICAgIHJl
dCA9ICB6YWxsb2MobGVuMiArIDEpOw0KICAgICAgICAgICAgICAgICAgICBtZW1j
cHkocmV0LCBkYXRhMiwgbGVuMik7DQogICAgICAgICAgICAgICAgICAgIHJldFts
ZW4yXSA9ICdcMCc7IA0KICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7
IA0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAg
ICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAg
fSANCiAgICBpZihkZXB0aCkNCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0p
OyANCiAgICBkZXB0aC0tOw0KICAgIHJldHVybiByZXQ7DQp9DQoNCg0KY2hhciAg
ICAqc3RhY2tbMTJdOw0KaW50ICAgICBkZXB0aCA9IDA7DQoNCnN0YXRpYyBjaGFy
ICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVuLCBj
b25zdCBjaGFyICpmaW5kc3RyKQ0KDQp7DQogICAgY2hhciAqcmV0ID0gTlVMTDsN
CiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7DQoNCiAg
ICAvL3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7DQogICAgc2V4cF9wcmlu
dChsaXN0KTsNCiAgICANCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25l
bGVuOyBsb29wKyspDQogICAgICAgIHsNCiAgICAgICAgaW50IGxlbjsNCiAgICAg
ICAgY29uc3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBs
b29wLCAmbGVuKTsNCiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQ0KICAgICAgICAg
ICAgew0KICAgICAgICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4
cF9udGgobGlzdCwgbG9vcCk7DQogICAgICAgICAgICBpZihlbGVtZW50KQ0KICAg
ICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpbnQgbGVuMzsNCiAgICAg
ICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhfZGF0
YShlbGVtZW50LCAwLCAmbGVuMyk7DQogICAgICAgICAgICAgICAgLy9wcmludGYo
ImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVuMywgZGF0YTMpOw0KICAgICAgICAgICAg
ICAgIGNoYXIgKm1lbXggPSB6YWxsb2MobGVuMyArIDEpOw0KICAgICAgICAgICAg
ICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7DQogICAgICAgICAgICAgICAg
bWVteFtsZW4zXSA9ICdcMCc7IA0KICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRo
XSA9IG1lbXg7ICANCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdv
aW5nIHRvIGJlIDMgYXQgbWF4DQogICAgICAgICAgICAgICAgaWYoZGVwdGggPCAx
MikNCiAgICAgICAgICAgICAgICAgICAgZGVwdGgrKzsNCiAgICAgICAgICAgICAg
ICByZXQgPSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7
DQogICAgICAgICAgICAgICAgaWYocmV0KQ0KICAgICAgICAgICAgICAgICAgICBi
cmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAg
IGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIC8vcHJpbnRmKCJkYXRh
OiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7DQoNCiAgICAgICAgICAg
IGludCBsZW4yOw0KICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBkYXRh
LCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkNCiAgICAgICAgICAg
ICAgICB7DQogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5
X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCArIDEsICZsZW4yKTsNCiAgICAgICAg
ICAgICAgICBpZihkYXRhMikNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAg
ICAgICAgICAgICAgICAvL3ByaW50ZigiJy8iKTsNCiAgICAgICAgICAgICAgICAg
ICAgZm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspDQog
ICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNrW2xvb3Az
XSk7DQogICAgICAgICAgICAgICAgICAgIHByaW50ZigiJyIpOw0KICAgIA0KICAg
ICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQ0KICAgICAg
ICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW50
IG9sZW47DQogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18s
IF9fRklMRV9fKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm1lbTIg
PSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4pOw0KICAgICAgICAgICAgICAgICAg
ICAgICAgcHJpbnRmKCIgIyVzI1xuIiwgbWVtMik7IA0KICAgICAgICAgICAgICAg
ICAgICAgICAgemZyZWUobWVtMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9
DQogICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAg
ICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICclLipzJ1xu
IiwgbGVuMiwgZGF0YTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAg
ICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAg
ICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsgMSk7DQogICAg
ICAgICAgICAgICAgICAgIG1lbWNweShyZXQsIGRhdGEyLCBsZW4yKTsNCiAgICAg
ICAgICAgICAgICAgICAgcmV0W2xlbjJdID0gJ1wwJzsgDQogICAgICAgICAgICAg
ICAgICAgICpwbGVuID0gbGVuMjsgDQogICAgICAgICAgICAgICAgICAgIGJyZWFr
Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAg
ICAgICAgICAgfQ0KICAgICAgICB9IA0KICAgIGlmKGRlcHRoKQ0KICAgICAgICB6
ZnJlZShzdGFja1tkZXB0aC0xXSk7IA0KICAgIGRlcHRoLS07DQogICAgcmV0dXJu
IHJldDsNCn0NCg0KDQoNCg0KDQovKiA9PT09PVsgZ3NleHAuYyBdPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
DQoNCiAgIERlc2NyaXB0aW9uOiAgICAgU2V4cCByb3V0aW5lcy4NCg0KICAgUmV2
aXNpb25zOg0KDQogICAgICBSRVYgICBEQVRFICAgICAgICAgICAgQlkgICAgICAg
ICAgICAgIERFU0NSSVBUSU9ODQogICAgICAtLS0tICAtLS0tLS0tLS0tLSAgICAg
LS0tLS0tLS0tLSAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0K
ICAgICAgMC4wMCAgYXVnLjAzLjIwMTcgICAgIFBldGVyIEdsZW4gICAgICBJbml0
aWFsIHZlcnNpb24uDQogICAgICAwLjAwICBvY3QuMjAuMjAxNyAgICAgUGV0ZXIg
R2xlbiAgICAgIFdvcmsgDQoNCiAgID09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICov
DQoNCiNpbmNsdWRlIDxzdGRpby5oPg0KDQojaW5jbHVkZSAiZ2NyeXB0LmgiDQoj
aW5jbHVkZSAiZ2NyeS5oIg0KI2luY2x1ZGUgImdzZXhwLmgiDQojaW5jbHVkZSAi
em1hbGxvYy5oIg0KI2luY2x1ZGUgIm1pc2MuaCINCg0KLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8NCi8vIFByaW50IHNleHAgdG8gbWVtb3J5DQovLyBGcmVlIHRo
ZSByZXN1bHRpbmcgcG9pbnRlciB3aXRoIHpmcmVlDQoNCmNoYXIgKnNleHBfc3By
aW50KGdjcnlfc2V4cF90IHNleHAsIGludCAqbGVuLCBpbnQgZm9ybWF0KQ0KDQp7
DQogICAgaW50IHNsZW4gPSBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwg
TlVMTCwgMCk7DQogICAgKmxlbiA9IDA7DQogICAgemxpbmUyKF9fTElORV9fLCBf
X0ZJTEVfXyk7DQogICAgY2hhciAqcHBwID0gKGNoYXIqKXphbGxvYyhzbGVuKzEp
Ow0KICAgIGlmKHBwcCA9PSBOVUxMKQ0KICAgICAgICByZXR1cm4gTlVMTDsNCg0K
ICAgIGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBwcHAsIHNsZW4pOw0K
ICAgICpsZW4gPSBzbGVuOw0KICAgIC8vIFplcm8gdGVybWluYXRlDQogICAgcHBw
W3NsZW4tMV0gPSAnXDAnOw0KICAgIHJldHVybihwcHApOw0KfQ0KDQovLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gUHJpbnQgc2V4cCB0byBzdGRvdXQNCg0K
dm9pZCAgICBzZXhwX3ByaW50KGdjcnlfc2V4cF90IHJzYV9rZXlwYWlyKQ0KDQp7
DQogICAgaW50IGxlbjsNCiAgICBjaGFyICpwcHAgPSBzZXhwX3NwcmludChyc2Ff
a2V5cGFpciwgJmxlbiwgR0NSWVNFWFBfRk1UX0FEVkFOQ0VEKTsNCiAgICBpZihw
cHAgPT0gTlVMTCkNCiAgICAgICAgcmV0dXJuOw0KICAgIHByaW50ZigiJXNcbiIs
IHBwcCk7DQogICAgemZyZWUocHBwKTsNCn0NCg0KY2hhciAgICAqc3RhY2tbMTJd
Ow0KaW50ICAgICBkZXB0aCA9IDA7DQoNCnN0YXRpYyBjaGFyICpzZXhwX2RlY29k
ZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVuLCBjb25zdCBjaGFyICpm
aW5kc3RyKQ0KDQp7DQogICAgY2hhciAqcmV0ID0gTlVMTDsNCiAgICBpbnQgIG9u
ZWxlbiA9IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7DQoNCiAgICAvL3ByaW50Zigg
Im9uZTogJWRcbiIsIG9uZWxlbik7DQogICAgc2V4cF9wcmludChsaXN0KTsNCiAg
ICANCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVuOyBsb29wKysp
DQogICAgICAgIHsNCiAgICAgICAgaW50IGxlbjsNCiAgICAgICAgY29uc3QgY2hh
ciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAmbGVuKTsN
CiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQ0KICAgICAgICAgICAgew0KICAgICAg
ICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlzdCwg
bG9vcCk7DQogICAgICAgICAgICBpZihlbGVtZW50KQ0KICAgICAgICAgICAgICAg
IHsNCiAgICAgICAgICAgICAgICBpbnQgbGVuMzsNCiAgICAgICAgICAgICAgICBj
b25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhfZGF0YShlbGVtZW50LCAw
LCAmbGVuMyk7DQogICAgICAgICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICcl
LipzJ1xuIiwgbGVuMywgZGF0YTMpOw0KICAgICAgICAgICAgICAgIGNoYXIgKm1l
bXggPSB6YWxsb2MobGVuMyArIDEpOw0KICAgICAgICAgICAgICAgIG1lbWNweSht
ZW14LCBkYXRhMywgbGVuMyk7DQogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9
ICdcMCc7IA0KICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICAN
CiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdvaW5nIHRvIGJlIDMg
YXQgbWF4DQogICAgICAgICAgICAgICAgaWYoZGVwdGggPCAxMikNCiAgICAgICAg
ICAgICAgICAgICAgZGVwdGgrKzsNCiAgICAgICAgICAgICAgICByZXQgPSBzZXhw
X2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7DQogICAgICAgICAg
ICAgICAgaWYocmV0KQ0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAg
ICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAg
ICAgICAgIHsNCiAgICAgICAgICAgIC8vcHJpbnRmKCJkYXRhOiAlZCAnJS4qcydc
biIsIGxvb3AsIGxlbiwgZGF0YSk7DQoNCiAgICAgICAgICAgIGludCBsZW4yOw0K
ICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBkYXRhLCBsZW4pID09IDAg
fHwgZmluZHN0clswXSA9PSAnXDAnICkNCiAgICAgICAgICAgICAgICB7DQogICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2Rh
dGEobGlzdCwgbG9vcCArIDEsICZsZW4yKTsNCiAgICAgICAgICAgICAgICBpZihk
YXRhMikNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAg
ICAvL3ByaW50ZigiJy8iKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBs
b29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspDQogICAgICAgICAgICAg
ICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNrW2xvb3AzXSk7DQogICAgICAg
ICAgICAgICAgICAgIHByaW50ZigiJyIpOw0KICAgIA0KICAgICAgICAgICAgICAg
ICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQ0KICAgICAgICAgICAgICAgICAg
ICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47DQogICAg
ICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsN
CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRh
MiwgbGVuMiwgJm9sZW4pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRm
KCIgIyVzI1xuIiwgbWVtMik7IA0KICAgICAgICAgICAgICAgICAgICAgICAgemZy
ZWUobWVtMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAg
ICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAg
ICAgICAgICAgICAgICAgICAgIHByaW50ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0
YTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAg
ICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsNCiAgICAgICAgICAgICAg
ICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsgMSk7DQogICAgICAgICAgICAgICAg
ICAgIG1lbWNweShyZXQsIGRhdGEyLCBsZW4yKTsNCiAgICAgICAgICAgICAgICAg
ICAgcmV0W2xlbjJdID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgICAgICpwbGVu
ID0gbGVuMjsgDQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAg
ICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0K
ICAgICAgICB9IA0KICAgIGlmKGRlcHRoKQ0KICAgICAgICB6ZnJlZShzdGFja1tk
ZXB0aC0xXSk7IA0KICAgIGRlcHRoLS07DQogICAgcmV0dXJuIHJldDsNCn0NCg0K
DQpjaGFyICAgICpzdGFja1sxMl07DQppbnQgICAgIGRlcHRoID0gMDsNCg0Kc3Rh
dGljIGNoYXIgKnNleHBfZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQg
KnBsZW4sIGNvbnN0IGNoYXIgKmZpbmRzdHIpDQoNCnsNCiAgICBjaGFyICpyZXQg
PSBOVUxMOw0KICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0
KTsNCg0KICAgIC8vcHJpbnRmKCAib25lOiAlZFxuIiwgb25lbGVuKTsNCiAgICBz
ZXhwX3ByaW50KGxpc3QpOw0KICAgIA0KICAgIGZvcihpbnQgbG9vcCA9IDA7IGxv
b3AgPCBvbmVsZW47IGxvb3ArKykNCiAgICAgICAgew0KICAgICAgICBpbnQgbGVu
Ow0KICAgICAgICBjb25zdCBjaGFyICpkYXRhID0gZ2NyeV9zZXhwX250aF9kYXRh
KGxpc3QsIGxvb3AsICZsZW4pOw0KICAgICAgICBpZihkYXRhID09IE5VTEwpDQog
ICAgICAgICAgICB7DQogICAgICAgICAgICBnY3J5X3NleHBfdCBlbGVtZW50ID0g
Z2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsNCiAgICAgICAgICAgIGlmKGVsZW1l
bnQpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGludCBsZW4z
Ow0KICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhw
X250aF9kYXRhKGVsZW1lbnQsIDAsICZsZW4zKTsNCiAgICAgICAgICAgICAgICAv
L3ByaW50ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7DQogICAg
ICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhsZW4zICsgMSk7DQogICAg
ICAgICAgICAgICAgbWVtY3B5KG1lbXgsIGRhdGEzLCBsZW4zKTsNCiAgICAgICAg
ICAgICAgICBtZW14W2xlbjNdID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgc3Rh
Y2tbZGVwdGhdID0gbWVteDsgIA0KICAgICAgICAgICAgICAgIC8vIFdlIGtub3cg
aXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgNCiAgICAgICAgICAgICAgICBpZihk
ZXB0aCA8IDEyKQ0KICAgICAgICAgICAgICAgICAgICBkZXB0aCsrOw0KICAgICAg
ICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29uZShlbGVtZW50LCBwbGVuLCBm
aW5kc3RyKTsNCiAgICAgICAgICAgICAgICBpZihyZXQpDQogICAgICAgICAgICAg
ICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0N
CiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgLy9wcmlu
dGYoImRhdGE6ICVkICclLipzJ1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsNCg0KICAg
ICAgICAgICAgaW50IGxlbjI7DQogICAgICAgICAgICBpZihzdHJuY21wKGZpbmRz
dHIsIGRhdGEsIGxlbikgPT0gMCB8fCBmaW5kc3RyWzBdID09ICdcMCcgKQ0KICAg
ICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRh
MiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIpOw0K
ICAgICAgICAgICAgICAgIGlmKGRhdGEyKQ0KICAgICAgICAgICAgICAgICAgICB7
DQogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIpOw0KICAgICAgICAg
ICAgICAgICAgICBmb3IoaW50IGxvb3AzID0gMDsgbG9vcDMgPCBkZXB0aDsgbG9v
cDMrKykNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3Rh
Y2tbbG9vcDNdKTsNCiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7DQog
ICAgDQogICAgICAgICAgICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikp
DQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAg
ICAgICBpbnQgb2xlbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihf
X0xJTkVfXywgX19GSUxFX18pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2hh
ciAqbWVtMiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7DQogICAgICAgICAg
ICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0yKTsgDQogICAgICAg
ICAgICAgICAgICAgICAgICB6ZnJlZShtZW0yKTsNCiAgICAgICAgICAgICAgICAg
ICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAg
ICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIg
JyUuKnMnXG4iLCBsZW4yLCBkYXRhMik7DQogICAgICAgICAgICAgICAgICAgICAg
ICB9DQogICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxF
X18pOw0KICAgICAgICAgICAgICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAx
KTsNCiAgICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIp
Ow0KICAgICAgICAgICAgICAgICAgICByZXRbbGVuMl0gPSAnXDAnOyANCiAgICAg
ICAgICAgICAgICAgICAgKnBsZW4gPSBsZW4yOyANCiAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAg
ICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0gDQogICAgaWYoZGVwdGgpDQog
ICAgICAgIHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsgDQogICAgZGVwdGgtLTsNCiAg
ICByZXR1cm4gcmV0Ow0KfQ0KDQoNCg0KDQoNCi8qID09PT09WyBnc2V4cC5jIF09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0NCg0KICAgRGVzY3JpcHRpb246ICAgICBTZXhwIHJvdXRpbmVzLg0K
DQogICBSZXZpc2lvbnM6DQoNCiAgICAgIFJFViAgIERBVEUgICAgICAgICAgICBC
WSAgICAgICAgICAgICAgREVTQ1JJUFRJT04NCiAgICAgIC0tLS0gIC0tLS0tLS0t
LS0tICAgICAtLS0tLS0tLS0tICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tDQogICAgICAwLjAwICBhdWcuMDMuMjAxNyAgICAgUGV0ZXIgR2xlbiAg
ICAgIEluaXRpYWwgdmVyc2lvbi4NCiAgICAgIDAuMDAgIG9jdC4yMC4yMDE3ICAg
ICBQZXRlciBHbGVuICAgICAgV29yayANCg0KICAgPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0gKi8NCg0KI2luY2x1ZGUgPHN0ZGlvLmg+DQoNCiNpbmNsdWRlICJnY3J5
cHQuaCINCiNpbmNsdWRlICJnY3J5LmgiDQojaW5jbHVkZSAiZ3NleHAuaCINCiNp
bmNsdWRlICJ6bWFsbG9jLmgiDQojaW5jbHVkZSAibWlzYy5oIg0KDQovLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLw0KLy8gUHJpbnQgc2V4cCB0byBtZW1vcnkNCi8v
IEZyZWUgdGhlIHJlc3VsdGluZyBwb2ludGVyIHdpdGggemZyZWUNCg0KY2hhciAq
c2V4cF9zcHJpbnQoZ2NyeV9zZXhwX3Qgc2V4cCwgaW50ICpsZW4sIGludCBmb3Jt
YXQpDQoNCnsNCiAgICBpbnQgc2xlbiA9IGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwg
Zm9ybWF0LCBOVUxMLCAwKTsNCiAgICAqbGVuID0gMDsNCiAgICB6bGluZTIoX19M
SU5FX18sIF9fRklMRV9fKTsNCiAgICBjaGFyICpwcHAgPSAoY2hhciopemFsbG9j
KHNsZW4rMSk7DQogICAgaWYocHBwID09IE5VTEwpDQogICAgICAgIHJldHVybiBO
VUxMOw0KDQogICAgZ2NyeV9zZXhwX3NwcmludChzZXhwLCBmb3JtYXQsIHBwcCwg
c2xlbik7DQogICAgKmxlbiA9IHNsZW47DQogICAgLy8gWmVybyB0ZXJtaW5hdGUN
CiAgICBwcHBbc2xlbi0xXSA9ICdcMCc7DQogICAgcmV0dXJuKHBwcCk7DQp9DQoN
Ci8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBQcmludCBzZXhwIHRvIHN0
ZG91dA0KDQp2b2lkICAgIHNleHBfcHJpbnQoZ2NyeV9zZXhwX3QgcnNhX2tleXBh
aXIpDQoNCnsNCiAgICBpbnQgbGVuOw0KICAgIGNoYXIgKnBwcCA9IHNleHBfc3By
aW50KHJzYV9rZXlwYWlyLCAmbGVuLCBHQ1JZU0VYUF9GTVRfQURWQU5DRUQpOw0K
ICAgIGlmKHBwcCA9PSBOVUxMKQ0KICAgICAgICByZXR1cm47DQogICAgcHJpbnRm
KCIlc1xuIiwgcHBwKTsNCiAgICB6ZnJlZShwcHApOw0KfQ0KDQpjaGFyICAgICpz
dGFja1sxMl07DQppbnQgICAgIGRlcHRoID0gMDsNCg0Kc3RhdGljIGNoYXIgKnNl
eHBfZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0
IGNoYXIgKmZpbmRzdHIpDQoNCnsNCiAgICBjaGFyICpyZXQgPSBOVUxMOw0KICAg
IGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsNCg0KICAgIC8v
cHJpbnRmKCAib25lOiAlZFxuIiwgb25lbGVuKTsNCiAgICBzZXhwX3ByaW50KGxp
c3QpOw0KICAgIA0KICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47
IGxvb3ArKykNCiAgICAgICAgew0KICAgICAgICBpbnQgbGVuOw0KICAgICAgICBj
b25zdCBjaGFyICpkYXRhID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3As
ICZsZW4pOw0KICAgICAgICBpZihkYXRhID09IE5VTEwpDQogICAgICAgICAgICB7
DQogICAgICAgICAgICBnY3J5X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250
aChsaXN0LCBsb29wKTsNCiAgICAgICAgICAgIGlmKGVsZW1lbnQpDQogICAgICAg
ICAgICAgICAgew0KICAgICAgICAgICAgICAgIGludCBsZW4zOw0KICAgICAgICAg
ICAgICAgIGNvbnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVs
ZW1lbnQsIDAsICZsZW4zKTsNCiAgICAgICAgICAgICAgICAvL3ByaW50ZigiZWxl
bWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7DQogICAgICAgICAgICAgICAg
Y2hhciAqbWVteCA9IHphbGxvYyhsZW4zICsgMSk7DQogICAgICAgICAgICAgICAg
bWVtY3B5KG1lbXgsIGRhdGEzLCBsZW4zKTsNCiAgICAgICAgICAgICAgICBtZW14
W2xlbjNdID0gJ1wwJzsgDQogICAgICAgICAgICAgICAgc3RhY2tbZGVwdGhdID0g
bWVteDsgIA0KICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcg
dG8gYmUgMyBhdCBtYXgNCiAgICAgICAgICAgICAgICBpZihkZXB0aCA8IDEyKQ0K
ICAgICAgICAgICAgICAgICAgICBkZXB0aCsrOw0KICAgICAgICAgICAgICAgIHJl
dCA9IHNleHBfZGVjb2RlX29uZShlbGVtZW50LCBwbGVuLCBmaW5kc3RyKTsNCiAg
ICAgICAgICAgICAgICBpZihyZXQpDQogICAgICAgICAgICAgICAgICAgIGJyZWFr
Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgZWxz
ZQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVk
ICclLipzJ1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsNCg0KICAgICAgICAgICAgaW50
IGxlbjI7DQogICAgICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxl
bikgPT0gMCB8fCBmaW5kc3RyWzBdID09ICdcMCcgKQ0KICAgICAgICAgICAgICAg
IHsNCiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMiA9IGdjcnlfc2V4
cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIpOw0KICAgICAgICAgICAg
ICAgIGlmKGRhdGEyKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAg
ICAgICAgICAgIC8vcHJpbnRmKCInLyIpOw0KICAgICAgICAgICAgICAgICAgICBm
b3IoaW50IGxvb3AzID0gMDsgbG9vcDMgPCBkZXB0aDsgbG9vcDMrKykNCiAgICAg
ICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsN
CiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7DQogICAgDQogICAgICAg
ICAgICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpDQogICAgICAgICAg
ICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpbnQgb2xl
bjsNCiAgICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19G
SUxFX18pOw0KICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVtMiA9IGRv
aGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7DQogICAgICAgICAgICAgICAgICAgICAg
ICBwcmludGYoIiAjJXMjXG4iLCBtZW0yKTsgDQogICAgICAgICAgICAgICAgICAg
ICAgICB6ZnJlZShtZW0yKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAg
ICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICAgICAg
ew0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBs
ZW4yLCBkYXRhMik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAg
ICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0KICAgICAg
ICAgICAgICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsNCiAgICAgICAg
ICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIpOw0KICAgICAgICAg
ICAgICAgICAgICByZXRbbGVuMl0gPSAnXDAnOyANCiAgICAgICAgICAgICAgICAg
ICAgKnBsZW4gPSBsZW4yOyANCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQog
ICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAg
ICAgICB9DQogICAgICAgIH0gDQogICAgaWYoZGVwdGgpDQogICAgICAgIHpmcmVl
KHN0YWNrW2RlcHRoLTFdKTsgDQogICAgZGVwdGgtLTsNCiAgICByZXR1cm4gcmV0
Ow0KfQ0KDQoNCmNoYXIgICAgKnN0YWNrWzEyXTsNCmludCAgICAgZGVwdGggPSAw
Ow0KDQpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4cF90IGxp
c3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikNCg0Kew0KICAgIGNo
YXIgKnJldCA9IE5VTEw7DQogICAgaW50ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVu
Z3RoKGxpc3QpOw0KDQogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVsZW4p
Ow0KICAgIHNleHBfcHJpbnQobGlzdCk7DQogICAgDQogICAgZm9yKGludCBsb29w
ID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQ0KICAgICAgICB7DQogICAgICAg
IGludCBsZW47DQogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBf
bnRoX2RhdGEobGlzdCwgbG9vcCwgJmxlbik7DQogICAgICAgIGlmKGRhdGEgPT0g
TlVMTCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVs
ZW1lbnQgPSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOw0KICAgICAgICAgICAg
aWYoZWxlbWVudCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAg
aW50IGxlbjM7DQogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTMgPSBn
Y3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOw0KICAgICAgICAg
ICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydcbiIsIGxlbjMsIGRhdGEz
KTsNCiAgICAgICAgICAgICAgICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAx
KTsNCiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxlbjMpOw0K
ICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyANCiAgICAgICAgICAg
ICAgICBzdGFja1tkZXB0aF0gPSBtZW14OyAgDQogICAgICAgICAgICAgICAgLy8g
V2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heA0KICAgICAgICAgICAg
ICAgIGlmKGRlcHRoIDwgMTIpDQogICAgICAgICAgICAgICAgICAgIGRlcHRoKys7
DQogICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQs
IHBsZW4sIGZpbmRzdHIpOw0KICAgICAgICAgICAgICAgIGlmKHJldCkNCiAgICAg
ICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAg
ICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAg
ICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRhdGEp
Ow0KDQogICAgICAgICAgICBpbnQgbGVuMjsNCiAgICAgICAgICAgIGlmKHN0cm5j
bXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1ww
JyApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGNvbnN0IGNo
YXIgKmRhdGEyID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAm
bGVuMik7DQogICAgICAgICAgICAgICAgaWYoZGF0YTIpDQogICAgICAgICAgICAg
ICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy9wcmludGYoIicvIik7DQog
ICAgICAgICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRl
cHRoOyBsb29wMysrKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIv
JXMiLCBzdGFja1tsb29wM10pOw0KICAgICAgICAgICAgICAgICAgICBwcmludGYo
IiciKTsNCiAgICANCiAgICAgICAgICAgICAgICAgICAgaWYoaXNfYmluKGRhdGEy
LCBsZW4yKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBvbGVuOw0KICAgICAgICAgICAgICAgICAgICAgICAg
emxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7DQogICAgICAgICAgICAgICAgICAg
ICAgICBjaGFyICptZW0yID0gZG9oZXgoZGF0YTIsIGxlbjIsICZvbGVuKTsNCiAg
ICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyAN
CiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOw0KICAgICAgICAg
ICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAg
ICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBw
cmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsNCiAgICAgICAgICAgICAg
ICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9f
LCBfX0ZJTEVfXyk7DQogICAgICAgICAgICAgICAgICAgIHJldCA9ICB6YWxsb2Mo
bGVuMiArIDEpOw0KICAgICAgICAgICAgICAgICAgICBtZW1jcHkocmV0LCBkYXRh
MiwgbGVuMik7DQogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7
IA0KICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7IA0KICAgICAgICAg
ICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAg
ICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSANCiAgICBpZihk
ZXB0aCkNCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0pOyANCiAgICBkZXB0
aC0tOw0KICAgIHJldHVybiByZXQ7DQp9DQoNCg0KDQoNCg0KLyogPT09PT1bIGdz
ZXhwLmMgXT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQ0KDQogICBEZXNjcmlwdGlvbjogICAgIFNleHAgcm91
dGluZXMuDQoNCiAgIFJldmlzaW9uczoNCg0KICAgICAgUkVWICAgREFURSAgICAg
ICAgICAgIEJZICAgICAgICAgICAgICBERVNDUklQVElPTg0KICAgICAgLS0tLSAg
LS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0gICAgICAtLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0NCiAgICAgIDAuMDAgIGF1Zy4wMy4yMDE3ICAgICBQZXRl
ciBHbGVuICAgICAgSW5pdGlhbCB2ZXJzaW9uLg0KICAgICAgMC4wMCAgb2N0LjIw
LjIwMTcgICAgIFBldGVyIEdsZW4gICAgICBXb3JrIA0KDQogICA9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PSAqLw0KDQojaW5jbHVkZSA8c3RkaW8uaD4NCg0KI2luY2x1
ZGUgImdjcnlwdC5oIg0KI2luY2x1ZGUgImdjcnkuaCINCiNpbmNsdWRlICJnc2V4
cC5oIg0KI2luY2x1ZGUgInptYWxsb2MuaCINCiNpbmNsdWRlICJtaXNjLmgiDQoN
Ci8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQovLyBQcmludCBzZXhwIHRvIG1l
bW9yeQ0KLy8gRnJlZSB0aGUgcmVzdWx0aW5nIHBvaW50ZXIgd2l0aCB6ZnJlZQ0K
DQpjaGFyICpzZXhwX3NwcmludChnY3J5X3NleHBfdCBzZXhwLCBpbnQgKmxlbiwg
aW50IGZvcm1hdCkNCg0Kew0KICAgIGludCBzbGVuID0gZ2NyeV9zZXhwX3Nwcmlu
dChzZXhwLCBmb3JtYXQsIE5VTEwsIDApOw0KICAgICpsZW4gPSAwOw0KICAgIHps
aW5lMihfX0xJTkVfXywgX19GSUxFX18pOw0KICAgIGNoYXIgKnBwcCA9IChjaGFy
Kil6YWxsb2Moc2xlbisxKTsNCiAgICBpZihwcHAgPT0gTlVMTCkNCiAgICAgICAg
cmV0dXJuIE5VTEw7DQoNCiAgICBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1h
dCwgcHBwLCBzbGVuKTsNCiAgICAqbGVuID0gc2xlbjsNCiAgICAvLyBaZXJvIHRl
cm1pbmF0ZQ0KICAgIHBwcFtzbGVuLTFdID0gJ1wwJzsNCiAgICByZXR1cm4ocHBw
KTsNCn0NCg0KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCi8vIFByaW50IHNl
eHAgdG8gc3Rkb3V0DQoNCnZvaWQgICAgc2V4cF9wcmludChnY3J5X3NleHBfdCBy
c2Ffa2V5cGFpcikNCg0Kew0KICAgIGludCBsZW47DQogICAgY2hhciAqcHBwID0g
c2V4cF9zcHJpbnQocnNhX2tleXBhaXIsICZsZW4sIEdDUllTRVhQX0ZNVF9BRFZB
TkNFRCk7DQogICAgaWYocHBwID09IE5VTEwpDQogICAgICAgIHJldHVybjsNCiAg
ICBwcmludGYoIiVzXG4iLCBwcHApOw0KICAgIHpmcmVlKHBwcCk7DQp9DQoNCmNo
YXIgICAgKnN0YWNrWzEyXTsNCmludCAgICAgZGVwdGggPSAwOw0KDQoNCg==