CgoKLyogPT09PT1bIGdzZXhwLmMgXT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgRGVzY3JpcHRpb246
ICAgICBTZXhwIHJvdXRpbmVzLgoKICAgUmV2aXNpb25zOgoKICAgICAgUkVWICAg
REFURSAgICAgICAgICAgIEJZICAgICAgICAgICAgICBERVNDUklQVElPTgogICAg
ICAtLS0tICAtLS0tLS0tLS0tLSAgICAgLS0tLS0tLS0tLSAgICAgIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAwLjAwICBhdWcuMDMuMjAxNyAg
ICAgUGV0ZXIgR2xlbiAgICAgIEluaXRpYWwgdmVyc2lvbi4KICAgICAgMC4wMCAg
b2N0LjIwLjIwMTcgICAgIFBldGVyIEdsZW4gICAgICBXb3JrIAoKICAgPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0gKi8KCiNpbmNsdWRlIDxzdGRpby5oPgoKI2luY2x1
ZGUgImdjcnlwdC5oIgojaW5jbHVkZSAiZ2NyeS5oIgojaW5jbHVkZSAiZ3NleHAu
aCIKI2luY2x1ZGUgInptYWxsb2MuaCIKI2luY2x1ZGUgIm1pc2MuaCIKCi8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vIFByaW50IHNleHAgdG8gbWVtb3J5Ci8v
IEZyZWUgdGhlIHJlc3VsdGluZyBwb2ludGVyIHdpdGggemZyZWUKCmNoYXIgKnNl
eHBfc3ByaW50KGdjcnlfc2V4cF90IHNleHAsIGludCAqbGVuLCBpbnQgZm9ybWF0
KQoKewogICAgaW50IHNsZW4gPSBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1h
dCwgTlVMTCwgMCk7CiAgICAqbGVuID0gMDsKICAgIHpsaW5lMihfX0xJTkVfXywg
X19GSUxFX18pOwogICAgY2hhciAqcHBwID0gKGNoYXIqKXphbGxvYyhzbGVuKzEp
OwogICAgaWYocHBwID09IE5VTEwpCiAgICAgICAgcmV0dXJuIE5VTEw7CgogICAg
Z2NyeV9zZXhwX3NwcmludChzZXhwLCBmb3JtYXQsIHBwcCwgc2xlbik7CiAgICAq
bGVuID0gc2xlbjsKICAgIC8vIFplcm8gdGVybWluYXRlCiAgICBwcHBbc2xlbi0x
XSA9ICdcMCc7CiAgICByZXR1cm4ocHBwKTsKfQoKLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8KLy8gUHJpbnQgc2V4cCB0byBzdGRvdXQKCnZvaWQgICAgc2V4cF9w
cmludChnY3J5X3NleHBfdCByc2Ffa2V5cGFpcikKCnsKICAgIGludCBsZW47CiAg
ICBjaGFyICpwcHAgPSBzZXhwX3NwcmludChyc2Ffa2V5cGFpciwgJmxlbiwgR0NS
WVNFWFBfRk1UX0FEVkFOQ0VEKTsKICAgIGlmKHBwcCA9PSBOVUxMKQogICAgICAg
IHJldHVybjsKICAgIHByaW50ZigiJXNcbiIsIHBwcCk7CiAgICB6ZnJlZShwcHAp
Owp9CgpjaGFyICAgICpzdGFja1sxMl07CmludCAgICAgZGVwdGggPSAwOwoKc3Rh
dGljIGNoYXIgKnNleHBfZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQg
KnBsZW4sIGNvbnN0IGNoYXIgKmZpbmRzdHIpCgp7CiAgICBjaGFyICpyZXQgPSBO
VUxMOwogICAgaW50ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOwoK
ICAgIC8vcHJpbnRmKCAib25lOiAlZFxuIiwgb25lbGVuKTsKICAgIHNleHBfcHJp
bnQobGlzdCk7CiAgICAKICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVs
ZW47IGxvb3ArKykKICAgICAgICB7CiAgICAgICAgaW50IGxlbjsKICAgICAgICBj
b25zdCBjaGFyICpkYXRhID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3As
ICZsZW4pOwogICAgICAgIGlmKGRhdGEgPT0gTlVMTCkKICAgICAgICAgICAgewog
ICAgICAgICAgICBnY3J5X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChs
aXN0LCBsb29wKTsKICAgICAgICAgICAgaWYoZWxlbWVudCkKICAgICAgICAgICAg
ICAgIHsKICAgICAgICAgICAgICAgIGludCBsZW4zOwogICAgICAgICAgICAgICAg
Y29uc3QgY2hhciAqZGF0YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwg
MCwgJmxlbjMpOwogICAgICAgICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICcl
LipzJ1xuIiwgbGVuMywgZGF0YTMpOwogICAgICAgICAgICAgICAgY2hhciAqbWVt
eCA9IHphbGxvYyhsZW4zICsgMSk7CiAgICAgICAgICAgICAgICBtZW1jcHkobWVt
eCwgZGF0YTMsIGxlbjMpOwogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdc
MCc7IAogICAgICAgICAgICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsgIAogICAg
ICAgICAgICAgICAgLy8gV2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1h
eAogICAgICAgICAgICAgICAgaWYoZGVwdGggPCAxMikKICAgICAgICAgICAgICAg
ICAgICBkZXB0aCsrOwogICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVf
b25lKGVsZW1lbnQsIHBsZW4sIGZpbmRzdHIpOwogICAgICAgICAgICAgICAgaWYo
cmV0KQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg
fQogICAgICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAg
ICAgICAgIC8vcHJpbnRmKCJkYXRhOiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwg
ZGF0YSk7CgogICAgICAgICAgICBpbnQgbGVuMjsKICAgICAgICAgICAgaWYoc3Ry
bmNtcChmaW5kc3RyLCBkYXRhLCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAn
XDAnICkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnN0IGNo
YXIgKmRhdGEyID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAm
bGVuMik7CiAgICAgICAgICAgICAgICBpZihkYXRhMikKICAgICAgICAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy9wcmludGYoIicvIik7CiAgICAg
ICAgICAgICAgICAgICAgZm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7
IGxvb3AzKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwg
c3RhY2tbbG9vcDNdKTsKICAgICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsK
ICAgIAogICAgICAgICAgICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikp
CiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAg
ICAgaW50IG9sZW47CiAgICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJ
TkVfXywgX19GSUxFX18pOwogICAgICAgICAgICAgICAgICAgICAgICBjaGFyICpt
ZW0yID0gZG9oZXgoZGF0YTIsIGxlbjIsICZvbGVuKTsKICAgICAgICAgICAgICAg
ICAgICAgICAgcHJpbnRmKCIgIyVzI1xuIiwgbWVtMik7IAogICAgICAgICAgICAg
ICAgICAgICAgICB6ZnJlZShtZW0yKTsKICAgICAgICAgICAgICAgICAgICAgICAg
fQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIs
IGxlbjIsIGRhdGEyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAgICAg
ICAgICAgICAgICAgIHJldCA9ICB6YWxsb2MobGVuMiArIDEpOwogICAgICAgICAg
ICAgICAgICAgIG1lbWNweShyZXQsIGRhdGEyLCBsZW4yKTsKICAgICAgICAgICAg
ICAgICAgICByZXRbbGVuMl0gPSAnXDAnOyAKICAgICAgICAgICAgICAgICAgICAq
cGxlbiA9IGxlbjI7IAogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog
ICAgICAgIH0gCiAgICBpZihkZXB0aCkKICAgICAgICB6ZnJlZShzdGFja1tkZXB0
aC0xXSk7IAogICAgZGVwdGgtLTsKICAgIHJldHVybiByZXQ7Cn0KCgpjaGFyICAg
ICpzdGFja1sxMl07CmludCAgICAgZGVwdGggPSAwOwoKc3RhdGljIGNoYXIgKnNl
eHBfZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0
IGNoYXIgKmZpbmRzdHIpCgp7CiAgICBjaGFyICpyZXQgPSBOVUxMOwogICAgaW50
ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOwoKICAgIC8vcHJpbnRm
KCAib25lOiAlZFxuIiwgb25lbGVuKTsKICAgIHNleHBfcHJpbnQobGlzdCk7CiAg
ICAKICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3ArKykK
ICAgICAgICB7CiAgICAgICAgaW50IGxlbjsKICAgICAgICBjb25zdCBjaGFyICpk
YXRhID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOwogICAg
ICAgIGlmKGRhdGEgPT0gTlVMTCkKICAgICAgICAgICAgewogICAgICAgICAgICBn
Y3J5X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsK
ICAgICAgICAgICAgaWYoZWxlbWVudCkKICAgICAgICAgICAgICAgIHsKICAgICAg
ICAgICAgICAgIGludCBsZW4zOwogICAgICAgICAgICAgICAgY29uc3QgY2hhciAq
ZGF0YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOwog
ICAgICAgICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVu
MywgZGF0YTMpOwogICAgICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhs
ZW4zICsgMSk7CiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxl
bjMpOwogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IAogICAgICAg
ICAgICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsgIAogICAgICAgICAgICAgICAg
Ly8gV2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heAogICAgICAgICAg
ICAgICAgaWYoZGVwdGggPCAxMikKICAgICAgICAgICAgICAgICAgICBkZXB0aCsr
OwogICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQs
IHBsZW4sIGZpbmRzdHIpOwogICAgICAgICAgICAgICAgaWYocmV0KQogICAgICAg
ICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9CiAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgIC8vcHJp
bnRmKCJkYXRhOiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7CgogICAg
ICAgICAgICBpbnQgbGVuMjsKICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3Ry
LCBkYXRhLCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkKICAgICAg
ICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEyID0g
Z2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7CiAgICAg
ICAgICAgICAgICBpZihkYXRhMikKICAgICAgICAgICAgICAgICAgICB7CiAgICAg
ICAgICAgICAgICAgICAgLy9wcmludGYoIicvIik7CiAgICAgICAgICAgICAgICAg
ICAgZm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspCiAg
ICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNd
KTsKICAgICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsKICAgIAogICAgICAg
ICAgICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpCiAgICAgICAgICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47
CiAgICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxF
X18pOwogICAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgo
ZGF0YTIsIGxlbjIsICZvbGVuKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJp
bnRmKCIgIyVzI1xuIiwgbWVtMik7IAogICAgICAgICAgICAgICAgICAgICAgICB6
ZnJlZShtZW0yKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAg
ICAgICAgICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEy
KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg
IHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAgICAgICAgICAgICAgICAg
IHJldCA9ICB6YWxsb2MobGVuMiArIDEpOwogICAgICAgICAgICAgICAgICAgIG1l
bWNweShyZXQsIGRhdGEyLCBsZW4yKTsKICAgICAgICAgICAgICAgICAgICByZXRb
bGVuMl0gPSAnXDAnOyAKICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7
IAogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gCiAg
ICBpZihkZXB0aCkKICAgICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IAogICAg
ZGVwdGgtLTsKICAgIHJldHVybiByZXQ7Cn0KCgoKCgovKiA9PT09PVsgZ3NleHAu
YyBdPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09CgogICBEZXNjcmlwdGlvbjogICAgIFNleHAgcm91dGluZXMu
CgogICBSZXZpc2lvbnM6CgogICAgICBSRVYgICBEQVRFICAgICAgICAgICAgQlkg
ICAgICAgICAgICAgIERFU0NSSVBUSU9OCiAgICAgIC0tLS0gIC0tLS0tLS0tLS0t
ICAgICAtLS0tLS0tLS0tICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCiAgICAgIDAuMDAgIGF1Zy4wMy4yMDE3ICAgICBQZXRlciBHbGVuICAgICAg
SW5pdGlhbCB2ZXJzaW9uLgogICAgICAwLjAwICBvY3QuMjAuMjAxNyAgICAgUGV0
ZXIgR2xlbiAgICAgIFdvcmsgCgogICA9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAq
LwoKI2luY2x1ZGUgPHN0ZGlvLmg+CgojaW5jbHVkZSAiZ2NyeXB0LmgiCiNpbmNs
dWRlICJnY3J5LmgiCiNpbmNsdWRlICJnc2V4cC5oIgojaW5jbHVkZSAiem1hbGxv
Yy5oIgojaW5jbHVkZSAibWlzYy5oIgoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8KLy8gUHJpbnQgc2V4cCB0byBtZW1vcnkKLy8gRnJlZSB0aGUgcmVzdWx0aW5n
IHBvaW50ZXIgd2l0aCB6ZnJlZQoKY2hhciAqc2V4cF9zcHJpbnQoZ2NyeV9zZXhw
X3Qgc2V4cCwgaW50ICpsZW4sIGludCBmb3JtYXQpCgp7CiAgICBpbnQgc2xlbiA9
IGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBOVUxMLCAwKTsKICAgICps
ZW4gPSAwOwogICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICBjaGFy
ICpwcHAgPSAoY2hhciopemFsbG9jKHNsZW4rMSk7CiAgICBpZihwcHAgPT0gTlVM
TCkKICAgICAgICByZXR1cm4gTlVMTDsKCiAgICBnY3J5X3NleHBfc3ByaW50KHNl
eHAsIGZvcm1hdCwgcHBwLCBzbGVuKTsKICAgICpsZW4gPSBzbGVuOwogICAgLy8g
WmVybyB0ZXJtaW5hdGUKICAgIHBwcFtzbGVuLTFdID0gJ1wwJzsKICAgIHJldHVy
bihwcHApOwp9CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBQcmludCBz
ZXhwIHRvIHN0ZG91dAoKdm9pZCAgICBzZXhwX3ByaW50KGdjcnlfc2V4cF90IHJz
YV9rZXlwYWlyKQoKewogICAgaW50IGxlbjsKICAgIGNoYXIgKnBwcCA9IHNleHBf
c3ByaW50KHJzYV9rZXlwYWlyLCAmbGVuLCBHQ1JZU0VYUF9GTVRfQURWQU5DRUQp
OwogICAgaWYocHBwID09IE5VTEwpCiAgICAgICAgcmV0dXJuOwogICAgcHJpbnRm
KCIlc1xuIiwgcHBwKTsKICAgIHpmcmVlKHBwcCk7Cn0KCmNoYXIgICAgKnN0YWNr
WzEyXTsKaW50ICAgICBkZXB0aCA9IDA7CgpzdGF0aWMgY2hhciAqc2V4cF9kZWNv
ZGVfb25lKGdjcnlfc2V4cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAq
ZmluZHN0cikKCnsKICAgIGNoYXIgKnJldCA9IE5VTEw7CiAgICBpbnQgIG9uZWxl
biA9IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7CgogICAgLy9wcmludGYoICJvbmU6
ICVkXG4iLCBvbmVsZW4pOwogICAgc2V4cF9wcmludChsaXN0KTsKICAgIAogICAg
Zm9yKGludCBsb29wID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQogICAgICAg
IHsKICAgICAgICBpbnQgbGVuOwogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBn
Y3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCwgJmxlbik7CiAgICAgICAgaWYo
ZGF0YSA9PSBOVUxMKQogICAgICAgICAgICB7CiAgICAgICAgICAgIGdjcnlfc2V4
cF90IGVsZW1lbnQgPSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOwogICAgICAg
ICAgICBpZihlbGVtZW50KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAg
ICAgaW50IGxlbjM7CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9
IGdjcnlfc2V4cF9udGhfZGF0YShlbGVtZW50LCAwLCAmbGVuMyk7CiAgICAgICAg
ICAgICAgICAvL3ByaW50ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRh
Myk7CiAgICAgICAgICAgICAgICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAx
KTsKICAgICAgICAgICAgICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7CiAg
ICAgICAgICAgICAgICBtZW14W2xlbjNdID0gJ1wwJzsgCiAgICAgICAgICAgICAg
ICBzdGFja1tkZXB0aF0gPSBtZW14OyAgCiAgICAgICAgICAgICAgICAvLyBXZSBr
bm93IGl0IGlzIGdvaW5nIHRvIGJlIDMgYXQgbWF4CiAgICAgICAgICAgICAgICBp
ZihkZXB0aCA8IDEyKQogICAgICAgICAgICAgICAgICAgIGRlcHRoKys7CiAgICAg
ICAgICAgICAgICByZXQgPSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwg
ZmluZHN0cik7CiAgICAgICAgICAgICAgICBpZihyZXQpCiAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg
ICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgLy9wcmludGYoImRh
dGE6ICVkICclLipzJ1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsKCiAgICAgICAgICAg
IGludCBsZW4yOwogICAgICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEs
IGxlbikgPT0gMCB8fCBmaW5kc3RyWzBdID09ICdcMCcgKQogICAgICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3Nl
eHBfbnRoX2RhdGEobGlzdCwgbG9vcCArIDEsICZsZW4yKTsKICAgICAgICAgICAg
ICAgIGlmKGRhdGEyKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICAgICAvL3ByaW50ZigiJy8iKTsKICAgICAgICAgICAgICAgICAgICBmb3Io
aW50IGxvb3AzID0gMDsgbG9vcDMgPCBkZXB0aDsgbG9vcDMrKykKICAgICAgICAg
ICAgICAgICAgICAgICAgcHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10pOwogICAg
ICAgICAgICAgICAgICAgIHByaW50ZigiJyIpOwogICAgCiAgICAgICAgICAgICAg
ICAgICAgaWYoaXNfYmluKGRhdGEyLCBsZW4yKSkKICAgICAgICAgICAgICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgb2xlbjsKICAgICAg
ICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAg
ICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwg
bGVuMiwgJm9sZW4pOwogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAj
JXMjXG4iLCBtZW0yKTsgCiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1l
bTIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg
ICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAg
ICAgICAgICAgIHByaW50ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0YTIpOwogICAg
ICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgemxpbmUy
KF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICAgICAgICAgICAgICAgICAgcmV0ID0g
IHphbGxvYyhsZW4yICsgMSk7CiAgICAgICAgICAgICAgICAgICAgbWVtY3B5KHJl
dCwgZGF0YTIsIGxlbjIpOwogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9
ICdcMCc7IAogICAgICAgICAgICAgICAgICAgICpwbGVuID0gbGVuMjsgCiAgICAg
ICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSAKICAgIGlmKGRl
cHRoKQogICAgICAgIHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsgCiAgICBkZXB0aC0t
OwogICAgcmV0dXJuIHJldDsKfQoKCmNoYXIgICAgKnN0YWNrWzEyXTsKaW50ICAg
ICBkZXB0aCA9IDA7CgpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlf
c2V4cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikKCnsK
ICAgIGNoYXIgKnJldCA9IE5VTEw7CiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4
cF9sZW5ndGgobGlzdCk7CgogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVs
ZW4pOwogICAgc2V4cF9wcmludChsaXN0KTsKICAgIAogICAgZm9yKGludCBsb29w
ID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQogICAgICAgIHsKICAgICAgICBp
bnQgbGVuOwogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRo
X2RhdGEobGlzdCwgbG9vcCwgJmxlbik7CiAgICAgICAgaWYoZGF0YSA9PSBOVUxM
KQogICAgICAgICAgICB7CiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQg
PSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOwogICAgICAgICAgICBpZihlbGVt
ZW50KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaW50IGxlbjM7
CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9u
dGhfZGF0YShlbGVtZW50LCAwLCAmbGVuMyk7CiAgICAgICAgICAgICAgICAvL3By
aW50ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7CiAgICAgICAg
ICAgICAgICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsKICAgICAgICAg
ICAgICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7CiAgICAgICAgICAgICAg
ICBtZW14W2xlbjNdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICBzdGFja1tkZXB0
aF0gPSBtZW14OyAgCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdv
aW5nIHRvIGJlIDMgYXQgbWF4CiAgICAgICAgICAgICAgICBpZihkZXB0aCA8IDEy
KQogICAgICAgICAgICAgICAgICAgIGRlcHRoKys7CiAgICAgICAgICAgICAgICBy
ZXQgPSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7CiAg
ICAgICAgICAgICAgICBpZihyZXQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7
CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBlbHNlCiAg
ICAgICAgICAgIHsKICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipz
J1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsKCiAgICAgICAgICAgIGludCBsZW4yOwog
ICAgICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0gMCB8
fCBmaW5kc3RyWzBdID09ICdcMCcgKQogICAgICAgICAgICAgICAgewogICAgICAg
ICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2RhdGEo
bGlzdCwgbG9vcCArIDEsICZsZW4yKTsKICAgICAgICAgICAgICAgIGlmKGRhdGEy
KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL3By
aW50ZigiJy8iKTsKICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3AzID0g
MDsgbG9vcDMgPCBkZXB0aDsgbG9vcDMrKykKICAgICAgICAgICAgICAgICAgICAg
ICAgcHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10pOwogICAgICAgICAgICAgICAg
ICAgIHByaW50ZigiJyIpOwogICAgCiAgICAgICAgICAgICAgICAgICAgaWYoaXNf
YmluKGRhdGEyLCBsZW4yKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgICAgICAgICBpbnQgb2xlbjsKICAgICAgICAgICAgICAgICAg
ICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICAgICAgICAgICAg
ICAgICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4p
OwogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0y
KTsgCiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOwogICAgICAg
ICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAg
ICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBy
aW50ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0YTIpOwogICAgICAgICAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBf
X0ZJTEVfXyk7CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4y
ICsgMSk7CiAgICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxl
bjIpOwogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IAogICAg
ICAgICAgICAgICAgICAgICpwbGVuID0gbGVuMjsgCiAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
fQogICAgICAgICAgICB9CiAgICAgICAgfSAKICAgIGlmKGRlcHRoKQogICAgICAg
IHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsgCiAgICBkZXB0aC0tOwogICAgcmV0dXJu
IHJldDsKfQoKCgoKCi8qID09PT09WyBnc2V4cC5jIF09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgIERl
c2NyaXB0aW9uOiAgICAgU2V4cCByb3V0aW5lcy4KCiAgIFJldmlzaW9uczoKCiAg
ICAgIFJFViAgIERBVEUgICAgICAgICAgICBCWSAgICAgICAgICAgICAgREVTQ1JJ
UFRJT04KICAgICAgLS0tLSAgLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0gICAg
ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgMC4wMCAgYXVn
LjAzLjIwMTcgICAgIFBldGVyIEdsZW4gICAgICBJbml0aWFsIHZlcnNpb24uCiAg
ICAgIDAuMDAgIG9jdC4yMC4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgV29yayAK
CiAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCgojaW5jbHVkZSA8c3RkaW8u
aD4KCiNpbmNsdWRlICJnY3J5cHQuaCIKI2luY2x1ZGUgImdjcnkuaCIKI2luY2x1
ZGUgImdzZXhwLmgiCiNpbmNsdWRlICJ6bWFsbG9jLmgiCiNpbmNsdWRlICJtaXNj
LmgiCgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBQcmludCBzZXhwIHRv
IG1lbW9yeQovLyBGcmVlIHRoZSByZXN1bHRpbmcgcG9pbnRlciB3aXRoIHpmcmVl
CgpjaGFyICpzZXhwX3NwcmludChnY3J5X3NleHBfdCBzZXhwLCBpbnQgKmxlbiwg
aW50IGZvcm1hdCkKCnsKICAgIGludCBzbGVuID0gZ2NyeV9zZXhwX3NwcmludChz
ZXhwLCBmb3JtYXQsIE5VTEwsIDApOwogICAgKmxlbiA9IDA7CiAgICB6bGluZTIo
X19MSU5FX18sIF9fRklMRV9fKTsKICAgIGNoYXIgKnBwcCA9IChjaGFyKil6YWxs
b2Moc2xlbisxKTsKICAgIGlmKHBwcCA9PSBOVUxMKQogICAgICAgIHJldHVybiBO
VUxMOwoKICAgIGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBwcHAsIHNs
ZW4pOwogICAgKmxlbiA9IHNsZW47CiAgICAvLyBaZXJvIHRlcm1pbmF0ZQogICAg
cHBwW3NsZW4tMV0gPSAnXDAnOwogICAgcmV0dXJuKHBwcCk7Cn0KCi8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vCi8vIFByaW50IHNleHAgdG8gc3Rkb3V0Cgp2b2lk
ICAgIHNleHBfcHJpbnQoZ2NyeV9zZXhwX3QgcnNhX2tleXBhaXIpCgp7CiAgICBp
bnQgbGVuOwogICAgY2hhciAqcHBwID0gc2V4cF9zcHJpbnQocnNhX2tleXBhaXIs
ICZsZW4sIEdDUllTRVhQX0ZNVF9BRFZBTkNFRCk7CiAgICBpZihwcHAgPT0gTlVM
TCkKICAgICAgICByZXR1cm47CiAgICBwcmludGYoIiVzXG4iLCBwcHApOwogICAg
emZyZWUocHBwKTsKfQoKY2hhciAgICAqc3RhY2tbMTJdOwppbnQgICAgIGRlcHRo
ID0gMDsKCnN0YXRpYyBjaGFyICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3Qg
bGlzdCwgaW50ICpwbGVuLCBjb25zdCBjaGFyICpmaW5kc3RyKQoKewogICAgY2hh
ciAqcmV0ID0gTlVMTDsKICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0
aChsaXN0KTsKCiAgICAvL3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7CiAg
ICBzZXhwX3ByaW50KGxpc3QpOwogICAgCiAgICBmb3IoaW50IGxvb3AgPSAwOyBs
b29wIDwgb25lbGVuOyBsb29wKyspCiAgICAgICAgewogICAgICAgIGludCBsZW47
CiAgICAgICAgY29uc3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShs
aXN0LCBsb29wLCAmbGVuKTsKICAgICAgICBpZihkYXRhID09IE5VTEwpCiAgICAg
ICAgICAgIHsKICAgICAgICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlf
c2V4cF9udGgobGlzdCwgbG9vcCk7CiAgICAgICAgICAgIGlmKGVsZW1lbnQpCiAg
ICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpbnQgbGVuMzsKICAgICAg
ICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRh
KGVsZW1lbnQsIDAsICZsZW4zKTsKICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJl
bGVtZW50OiAnJS4qcydcbiIsIGxlbjMsIGRhdGEzKTsKICAgICAgICAgICAgICAg
IGNoYXIgKm1lbXggPSB6YWxsb2MobGVuMyArIDEpOwogICAgICAgICAgICAgICAg
bWVtY3B5KG1lbXgsIGRhdGEzLCBsZW4zKTsKICAgICAgICAgICAgICAgIG1lbXhb
bGVuM10gPSAnXDAnOyAKICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1l
bXg7ICAKICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8g
YmUgMyBhdCBtYXgKICAgICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIpCiAgICAg
ICAgICAgICAgICAgICAgZGVwdGgrKzsKICAgICAgICAgICAgICAgIHJldCA9IHNl
eHBfZGVjb2RlX29uZShlbGVtZW50LCBwbGVuLCBmaW5kc3RyKTsKICAgICAgICAg
ICAgICAgIGlmKHJldCkKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICAg
ICAgewogICAgICAgICAgICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBs
b29wLCBsZW4sIGRhdGEpOwoKICAgICAgICAgICAgaW50IGxlbjI7CiAgICAgICAg
ICAgIGlmKHN0cm5jbXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRz
dHJbMF0gPT0gJ1wwJyApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpkYXRhMiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBs
b29wICsgMSwgJmxlbjIpOwogICAgICAgICAgICAgICAgaWYoZGF0YTIpCiAgICAg
ICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCIn
LyIpOwogICAgICAgICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29w
MyA8IGRlcHRoOyBsb29wMysrKQogICAgICAgICAgICAgICAgICAgICAgICBwcmlu
dGYoIi8lcyIsIHN0YWNrW2xvb3AzXSk7CiAgICAgICAgICAgICAgICAgICAgcHJp
bnRmKCInIik7CiAgICAKICAgICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0
YTIsIGxlbjIpKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBvbGVuOwogICAgICAgICAgICAgICAgICAgICAgICB6
bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsKICAgICAgICAgICAgICAgICAgICAg
ICAgY2hhciAqbWVtMiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7CiAgICAg
ICAgICAgICAgICAgICAgICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyAKICAg
ICAgICAgICAgICAgICAgICAgICAgemZyZWUobWVtMik7CiAgICAgICAgICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIg
JyUuKnMnXG4iLCBsZW4yLCBkYXRhMik7CiAgICAgICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9f
KTsKICAgICAgICAgICAgICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsK
ICAgICAgICAgICAgICAgICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7CiAg
ICAgICAgICAgICAgICAgICAgcmV0W2xlbjJdID0gJ1wwJzsgCiAgICAgICAgICAg
ICAgICAgICAgKnBsZW4gPSBsZW4yOyAKICAgICAgICAgICAgICAgICAgICBicmVh
azsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgIH0KICAgICAgICB9IAogICAgaWYoZGVwdGgpCiAgICAgICAgemZyZWUo
c3RhY2tbZGVwdGgtMV0pOyAKICAgIGRlcHRoLS07CiAgICByZXR1cm4gcmV0Owp9
CgoKY2hhciAgICAqc3RhY2tbMTJdOwppbnQgICAgIGRlcHRoID0gMDsKCnN0YXRp
YyBjaGFyICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpw
bGVuLCBjb25zdCBjaGFyICpmaW5kc3RyKQoKewogICAgY2hhciAqcmV0ID0gTlVM
TDsKICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsKCiAg
ICAvL3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7CiAgICBzZXhwX3ByaW50
KGxpc3QpOwogICAgCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVu
OyBsb29wKyspCiAgICAgICAgewogICAgICAgIGludCBsZW47CiAgICAgICAgY29u
c3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAm
bGVuKTsKICAgICAgICBpZihkYXRhID09IE5VTEwpCiAgICAgICAgICAgIHsKICAg
ICAgICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlz
dCwgbG9vcCk7CiAgICAgICAgICAgIGlmKGVsZW1lbnQpCiAgICAgICAgICAgICAg
ICB7CiAgICAgICAgICAgICAgICBpbnQgbGVuMzsKICAgICAgICAgICAgICAgIGNv
bnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQsIDAs
ICZsZW4zKTsKICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4q
cydcbiIsIGxlbjMsIGRhdGEzKTsKICAgICAgICAgICAgICAgIGNoYXIgKm1lbXgg
PSB6YWxsb2MobGVuMyArIDEpOwogICAgICAgICAgICAgICAgbWVtY3B5KG1lbXgs
IGRhdGEzLCBsZW4zKTsKICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAn
OyAKICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICAKICAgICAg
ICAgICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgK
ICAgICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIpCiAgICAgICAgICAgICAgICAg
ICAgZGVwdGgrKzsKICAgICAgICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29u
ZShlbGVtZW50LCBwbGVuLCBmaW5kc3RyKTsKICAgICAgICAgICAgICAgIGlmKHJl
dCkKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAg
ICAgICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRh
dGEpOwoKICAgICAgICAgICAgaW50IGxlbjI7CiAgICAgICAgICAgIGlmKHN0cm5j
bXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1ww
JyApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb25zdCBjaGFy
ICpkYXRhMiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxl
bjIpOwogICAgICAgICAgICAgICAgaWYoZGF0YTIpCiAgICAgICAgICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIpOwogICAgICAg
ICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBs
b29wMysrKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0
YWNrW2xvb3AzXSk7CiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7CiAg
ICAKICAgICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQog
ICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAg
IGludCBvbGVuOwogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5F
X18sIF9fRklMRV9fKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVt
MiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7CiAgICAgICAgICAgICAgICAg
ICAgICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyAKICAgICAgICAgICAgICAg
ICAgICAgICAgemZyZWUobWVtMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBs
ZW4yLCBkYXRhMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsKICAgICAgICAg
ICAgICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsKICAgICAgICAgICAg
ICAgICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7CiAgICAgICAgICAgICAg
ICAgICAgcmV0W2xlbjJdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICAgICAgKnBs
ZW4gPSBsZW4yOyAKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg
ICAgICB9IAogICAgaWYoZGVwdGgpCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgt
MV0pOyAKICAgIGRlcHRoLS07CiAgICByZXR1cm4gcmV0Owp9CgoKCgoKLyogPT09
PT1bIGdzZXhwLmMgXT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQoKICAgRGVzY3JpcHRpb246ICAgICBTZXhw
IHJvdXRpbmVzLgoKICAgUmV2aXNpb25zOgoKICAgICAgUkVWICAgREFURSAgICAg
ICAgICAgIEJZICAgICAgICAgICAgICBERVNDUklQVElPTgogICAgICAtLS0tICAt
LS0tLS0tLS0tLSAgICAgLS0tLS0tLS0tLSAgICAgIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQogICAgICAwLjAwICBhdWcuMDMuMjAxNyAgICAgUGV0ZXIg
R2xlbiAgICAgIEluaXRpYWwgdmVyc2lvbi4KICAgICAgMC4wMCAgb2N0LjIwLjIw
MTcgICAgIFBldGVyIEdsZW4gICAgICBXb3JrIAoKICAgPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0gKi8KCiNpbmNsdWRlIDxzdGRpby5oPgoKI2luY2x1ZGUgImdjcnlw
dC5oIgojaW5jbHVkZSAiZ2NyeS5oIgojaW5jbHVkZSAiZ3NleHAuaCIKI2luY2x1
ZGUgInptYWxsb2MuaCIKI2luY2x1ZGUgIm1pc2MuaCIKCi8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vCi8vIFByaW50IHNleHAgdG8gbWVtb3J5Ci8vIEZyZWUgdGhl
IHJlc3VsdGluZyBwb2ludGVyIHdpdGggemZyZWUKCmNoYXIgKnNleHBfc3ByaW50
KGdjcnlfc2V4cF90IHNleHAsIGludCAqbGVuLCBpbnQgZm9ybWF0KQoKewogICAg
aW50IHNsZW4gPSBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgTlVMTCwg
MCk7CiAgICAqbGVuID0gMDsKICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18p
OwogICAgY2hhciAqcHBwID0gKGNoYXIqKXphbGxvYyhzbGVuKzEpOwogICAgaWYo
cHBwID09IE5VTEwpCiAgICAgICAgcmV0dXJuIE5VTEw7CgogICAgZ2NyeV9zZXhw
X3NwcmludChzZXhwLCBmb3JtYXQsIHBwcCwgc2xlbik7CiAgICAqbGVuID0gc2xl
bjsKICAgIC8vIFplcm8gdGVybWluYXRlCiAgICBwcHBbc2xlbi0xXSA9ICdcMCc7
CiAgICByZXR1cm4ocHBwKTsKfQoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8K
Ly8gUHJpbnQgc2V4cCB0byBzdGRvdXQKCnZvaWQgICAgc2V4cF9wcmludChnY3J5
X3NleHBfdCByc2Ffa2V5cGFpcikKCnsKICAgIGludCBsZW47CiAgICBjaGFyICpw
cHAgPSBzZXhwX3NwcmludChyc2Ffa2V5cGFpciwgJmxlbiwgR0NSWVNFWFBfRk1U
X0FEVkFOQ0VEKTsKICAgIGlmKHBwcCA9PSBOVUxMKQogICAgICAgIHJldHVybjsK
ICAgIHByaW50ZigiJXNcbiIsIHBwcCk7CiAgICB6ZnJlZShwcHApOwp9CgpjaGFy
ICAgICpzdGFja1sxMl07CmludCAgICAgZGVwdGggPSAwOwoKc3RhdGljIGNoYXIg
KnNleHBfZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNv
bnN0IGNoYXIgKmZpbmRzdHIpCgp7CiAgICBjaGFyICpyZXQgPSBOVUxMOwogICAg
aW50ICBvbmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOwoKICAgIC8vcHJp
bnRmKCAib25lOiAlZFxuIiwgb25lbGVuKTsKICAgIHNleHBfcHJpbnQobGlzdCk7
CiAgICAKICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3Ar
KykKICAgICAgICB7CiAgICAgICAgaW50IGxlbjsKICAgICAgICBjb25zdCBjaGFy
ICpkYXRhID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOwog
ICAgICAgIGlmKGRhdGEgPT0gTlVMTCkKICAgICAgICAgICAgewogICAgICAgICAg
ICBnY3J5X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29w
KTsKICAgICAgICAgICAgaWYoZWxlbWVudCkKICAgICAgICAgICAgICAgIHsKICAg
ICAgICAgICAgICAgIGludCBsZW4zOwogICAgICAgICAgICAgICAgY29uc3QgY2hh
ciAqZGF0YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMp
OwogICAgICAgICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwg
bGVuMywgZGF0YTMpOwogICAgICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxv
YyhsZW4zICsgMSk7CiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMs
IGxlbjMpOwogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IAogICAg
ICAgICAgICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsgIAogICAgICAgICAgICAg
ICAgLy8gV2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heAogICAgICAg
ICAgICAgICAgaWYoZGVwdGggPCAxMikKICAgICAgICAgICAgICAgICAgICBkZXB0
aCsrOwogICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1l
bnQsIHBsZW4sIGZpbmRzdHIpOwogICAgICAgICAgICAgICAgaWYocmV0KQogICAg
ICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICB9CiAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgIC8v
cHJpbnRmKCJkYXRhOiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7Cgog
ICAgICAgICAgICBpbnQgbGVuMjsKICAgICAgICAgICAgaWYoc3RybmNtcChmaW5k
c3RyLCBkYXRhLCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkKICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEy
ID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7CiAg
ICAgICAgICAgICAgICBpZihkYXRhMikKICAgICAgICAgICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgICAgICAgLy9wcmludGYoIicvIik7CiAgICAgICAgICAgICAg
ICAgICAgZm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKysp
CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9v
cDNdKTsKICAgICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsKICAgIAogICAg
ICAgICAgICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpCiAgICAgICAg
ICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9s
ZW47CiAgICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19G
SUxFX18pOwogICAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9o
ZXgoZGF0YTIsIGxlbjIsICZvbGVuKTsKICAgICAgICAgICAgICAgICAgICAgICAg
cHJpbnRmKCIgIyVzI1xuIiwgbWVtMik7IAogICAgICAgICAgICAgICAgICAgICAg
ICB6ZnJlZShtZW0yKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRh
dGEyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
ICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAgICAgICAgICAgICAg
ICAgIHJldCA9ICB6YWxsb2MobGVuMiArIDEpOwogICAgICAgICAgICAgICAgICAg
IG1lbWNweShyZXQsIGRhdGEyLCBsZW4yKTsKICAgICAgICAgICAgICAgICAgICBy
ZXRbbGVuMl0gPSAnXDAnOyAKICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxl
bjI7IAogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0g
CiAgICBpZihkZXB0aCkKICAgICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IAog
ICAgZGVwdGgtLTsKICAgIHJldHVybiByZXQ7Cn0KCgpjaGFyICAgICpzdGFja1sx
Ml07CmludCAgICAgZGVwdGggPSAwOwoKc3RhdGljIGNoYXIgKnNleHBfZGVjb2Rl
X29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0IGNoYXIgKmZp
bmRzdHIpCgp7CiAgICBjaGFyICpyZXQgPSBOVUxMOwogICAgaW50ICBvbmVsZW4g
PSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOwoKICAgIC8vcHJpbnRmKCAib25lOiAl
ZFxuIiwgb25lbGVuKTsKICAgIHNleHBfcHJpbnQobGlzdCk7CiAgICAKICAgIGZv
cihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3ArKykKICAgICAgICB7
CiAgICAgICAgaW50IGxlbjsKICAgICAgICBjb25zdCBjaGFyICpkYXRhID0gZ2Ny
eV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOwogICAgICAgIGlmKGRh
dGEgPT0gTlVMTCkKICAgICAgICAgICAgewogICAgICAgICAgICBnY3J5X3NleHBf
dCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsKICAgICAgICAg
ICAgaWYoZWxlbWVudCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAg
IGludCBsZW4zOwogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTMgPSBn
Y3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOwogICAgICAgICAg
ICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVuMywgZGF0YTMp
OwogICAgICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhsZW4zICsgMSk7
CiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxlbjMpOwogICAg
ICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IAogICAgICAgICAgICAgICAg
c3RhY2tbZGVwdGhdID0gbWVteDsgIAogICAgICAgICAgICAgICAgLy8gV2Uga25v
dyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heAogICAgICAgICAgICAgICAgaWYo
ZGVwdGggPCAxMikKICAgICAgICAgICAgICAgICAgICBkZXB0aCsrOwogICAgICAg
ICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQsIHBsZW4sIGZp
bmRzdHIpOwogICAgICAgICAgICAgICAgaWYocmV0KQogICAgICAgICAgICAgICAg
ICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg
ICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgIC8vcHJpbnRmKCJkYXRh
OiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7CgogICAgICAgICAgICBp
bnQgbGVuMjsKICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBkYXRhLCBs
ZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkKICAgICAgICAgICAgICAg
IHsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEyID0gZ2NyeV9zZXhw
X250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7CiAgICAgICAgICAgICAg
ICBpZihkYXRhMikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAg
ICAgICAgLy9wcmludGYoIicvIik7CiAgICAgICAgICAgICAgICAgICAgZm9yKGlu
dCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspCiAgICAgICAgICAg
ICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsKICAgICAg
ICAgICAgICAgICAgICBwcmludGYoIiciKTsKICAgIAogICAgICAgICAgICAgICAg
ICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpCiAgICAgICAgICAgICAgICAgICAg
ICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47CiAgICAgICAg
ICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAg
ICAgICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgoZGF0YTIsIGxl
bjIsICZvbGVuKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgIyVz
I1xuIiwgbWVtMik7IAogICAgICAgICAgICAgICAgICAgICAgICB6ZnJlZShtZW0y
KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg
IGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAg
ICAgICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsKICAgICAg
ICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHpsaW5lMihf
X0xJTkVfXywgX19GSUxFX18pOwogICAgICAgICAgICAgICAgICAgIHJldCA9ICB6
YWxsb2MobGVuMiArIDEpOwogICAgICAgICAgICAgICAgICAgIG1lbWNweShyZXQs
IGRhdGEyLCBsZW4yKTsKICAgICAgICAgICAgICAgICAgICByZXRbbGVuMl0gPSAn
XDAnOyAKICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7IAogICAgICAg
ICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gCiAgICBpZihkZXB0
aCkKICAgICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IAogICAgZGVwdGgtLTsK
ICAgIHJldHVybiByZXQ7Cn0KCgoKCgovKiA9PT09PVsgZ3NleHAuYyBdPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CgogICBEZXNjcmlwdGlvbjogICAgIFNleHAgcm91dGluZXMuCgogICBSZXZp
c2lvbnM6CgogICAgICBSRVYgICBEQVRFICAgICAgICAgICAgQlkgICAgICAgICAg
ICAgIERFU0NSSVBUSU9OCiAgICAgIC0tLS0gIC0tLS0tLS0tLS0tICAgICAtLS0t
LS0tLS0tICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAg
IDAuMDAgIGF1Zy4wMy4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgSW5pdGlhbCB2
ZXJzaW9uLgogICAgICAwLjAwICBvY3QuMjAuMjAxNyAgICAgUGV0ZXIgR2xlbiAg
ICAgIFdvcmsgCgogICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwoKI2luY2x1
ZGUgPHN0ZGlvLmg+CgojaW5jbHVkZSAiZ2NyeXB0LmgiCiNpbmNsdWRlICJnY3J5
LmgiCiNpbmNsdWRlICJnc2V4cC5oIgojaW5jbHVkZSAiem1hbGxvYy5oIgojaW5j
bHVkZSAibWlzYy5oIgoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gUHJp
bnQgc2V4cCB0byBtZW1vcnkKLy8gRnJlZSB0aGUgcmVzdWx0aW5nIHBvaW50ZXIg
d2l0aCB6ZnJlZQoKY2hhciAqc2V4cF9zcHJpbnQoZ2NyeV9zZXhwX3Qgc2V4cCwg
aW50ICpsZW4sIGludCBmb3JtYXQpCgp7CiAgICBpbnQgc2xlbiA9IGdjcnlfc2V4
cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBOVUxMLCAwKTsKICAgICpsZW4gPSAwOwog
ICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICBjaGFyICpwcHAgPSAo
Y2hhciopemFsbG9jKHNsZW4rMSk7CiAgICBpZihwcHAgPT0gTlVMTCkKICAgICAg
ICByZXR1cm4gTlVMTDsKCiAgICBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1h
dCwgcHBwLCBzbGVuKTsKICAgICpsZW4gPSBzbGVuOwogICAgLy8gWmVybyB0ZXJt
aW5hdGUKICAgIHBwcFtzbGVuLTFdID0gJ1wwJzsKICAgIHJldHVybihwcHApOwp9
CgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBQcmludCBzZXhwIHRvIHN0
ZG91dAoKdm9pZCAgICBzZXhwX3ByaW50KGdjcnlfc2V4cF90IHJzYV9rZXlwYWly
KQoKewogICAgaW50IGxlbjsKICAgIGNoYXIgKnBwcCA9IHNleHBfc3ByaW50KHJz
YV9rZXlwYWlyLCAmbGVuLCBHQ1JZU0VYUF9GTVRfQURWQU5DRUQpOwogICAgaWYo
cHBwID09IE5VTEwpCiAgICAgICAgcmV0dXJuOwogICAgcHJpbnRmKCIlc1xuIiwg
cHBwKTsKICAgIHpmcmVlKHBwcCk7Cn0KCmNoYXIgICAgKnN0YWNrWzEyXTsKaW50
ICAgICBkZXB0aCA9IDA7CgpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdj
cnlfc2V4cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikK
CnsKICAgIGNoYXIgKnJldCA9IE5VTEw7CiAgICBpbnQgIG9uZWxlbiA9IGdjcnlf
c2V4cF9sZW5ndGgobGlzdCk7CgogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBv
bmVsZW4pOwogICAgc2V4cF9wcmludChsaXN0KTsKICAgIAogICAgZm9yKGludCBs
b29wID0gMDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQogICAgICAgIHsKICAgICAg
ICBpbnQgbGVuOwogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBf
bnRoX2RhdGEobGlzdCwgbG9vcCwgJmxlbik7CiAgICAgICAgaWYoZGF0YSA9PSBO
VUxMKQogICAgICAgICAgICB7CiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1l
bnQgPSBnY3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOwogICAgICAgICAgICBpZihl
bGVtZW50KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaW50IGxl
bjM7CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4
cF9udGhfZGF0YShlbGVtZW50LCAwLCAmbGVuMyk7CiAgICAgICAgICAgICAgICAv
L3ByaW50ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7CiAgICAg
ICAgICAgICAgICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsKICAgICAg
ICAgICAgICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7CiAgICAgICAgICAg
ICAgICBtZW14W2xlbjNdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICBzdGFja1tk
ZXB0aF0gPSBtZW14OyAgCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlz
IGdvaW5nIHRvIGJlIDMgYXQgbWF4CiAgICAgICAgICAgICAgICBpZihkZXB0aCA8
IDEyKQogICAgICAgICAgICAgICAgICAgIGRlcHRoKys7CiAgICAgICAgICAgICAg
ICByZXQgPSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7
CiAgICAgICAgICAgICAgICBpZihyZXQpCiAgICAgICAgICAgICAgICAgICAgYnJl
YWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBlbHNl
CiAgICAgICAgICAgIHsKICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICcl
LipzJ1xuIiwgbG9vcCwgbGVuLCBkYXRhKTsKCiAgICAgICAgICAgIGludCBsZW4y
OwogICAgICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0g
MCB8fCBmaW5kc3RyWzBdID09ICdcMCcgKQogICAgICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2Rh
dGEobGlzdCwgbG9vcCArIDEsICZsZW4yKTsKICAgICAgICAgICAgICAgIGlmKGRh
dGEyKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAv
L3ByaW50ZigiJy8iKTsKICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3Az
ID0gMDsgbG9vcDMgPCBkZXB0aDsgbG9vcDMrKykKICAgICAgICAgICAgICAgICAg
ICAgICAgcHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10pOwogICAgICAgICAgICAg
ICAgICAgIHByaW50ZigiJyIpOwogICAgCiAgICAgICAgICAgICAgICAgICAgaWYo
aXNfYmluKGRhdGEyLCBsZW4yKSkKICAgICAgICAgICAgICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgICAgICAgICBpbnQgb2xlbjsKICAgICAgICAgICAgICAg
ICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9s
ZW4pOwogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBt
ZW0yKTsgCiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOwogICAg
ICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQog
ICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAg
IHByaW50ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0YTIpOwogICAgICAgICAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9f
LCBfX0ZJTEVfXyk7CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhs
ZW4yICsgMSk7CiAgICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIs
IGxlbjIpOwogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IAog
ICAgICAgICAgICAgICAgICAgICpwbGVuID0gbGVuMjsgCiAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSAKICAgIGlmKGRlcHRoKQogICAg
ICAgIHpmcmVlKHN0YWNrW2RlcHRoLTFdKTsgCiAgICBkZXB0aC0tOwogICAgcmV0
dXJuIHJldDsKfQoKCmNoYXIgICAgKnN0YWNrWzEyXTsKaW50ICAgICBkZXB0aCA9
IDA7CgpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4cF90IGxp
c3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikKCnsKICAgIGNoYXIg
KnJldCA9IE5VTEw7CiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9sZW5ndGgo
bGlzdCk7CgogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVsZW4pOwogICAg
c2V4cF9wcmludChsaXN0KTsKICAgIAogICAgZm9yKGludCBsb29wID0gMDsgbG9v
cCA8IG9uZWxlbjsgbG9vcCsrKQogICAgICAgIHsKICAgICAgICBpbnQgbGVuOwog
ICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlz
dCwgbG9vcCwgJmxlbik7CiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQogICAgICAg
ICAgICB7CiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQgPSBnY3J5X3Nl
eHBfbnRoKGxpc3QsIGxvb3ApOwogICAgICAgICAgICBpZihlbGVtZW50KQogICAg
ICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaW50IGxlbjM7CiAgICAgICAg
ICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhfZGF0YShl
bGVtZW50LCAwLCAmbGVuMyk7CiAgICAgICAgICAgICAgICAvL3ByaW50ZigiZWxl
bWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7CiAgICAgICAgICAgICAgICBj
aGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsKICAgICAgICAgICAgICAgIG1l
bWNweShtZW14LCBkYXRhMywgbGVuMyk7CiAgICAgICAgICAgICAgICBtZW14W2xl
bjNdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICBzdGFja1tkZXB0aF0gPSBtZW14
OyAgCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdvaW5nIHRvIGJl
IDMgYXQgbWF4CiAgICAgICAgICAgICAgICBpZihkZXB0aCA8IDEyKQogICAgICAg
ICAgICAgICAgICAgIGRlcHRoKys7CiAgICAgICAgICAgICAgICByZXQgPSBzZXhw
X2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7CiAgICAgICAgICAg
ICAgICBpZihyZXQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgICAg
IHsKICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipzJ1xuIiwgbG9v
cCwgbGVuLCBkYXRhKTsKCiAgICAgICAgICAgIGludCBsZW4yOwogICAgICAgICAg
ICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0gMCB8fCBmaW5kc3Ry
WzBdID09ICdcMCcgKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAg
Y29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9v
cCArIDEsICZsZW4yKTsKICAgICAgICAgICAgICAgIGlmKGRhdGEyKQogICAgICAg
ICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL3ByaW50ZigiJy8i
KTsKICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3AzID0gMDsgbG9vcDMg
PCBkZXB0aDsgbG9vcDMrKykKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRm
KCIvJXMiLCBzdGFja1tsb29wM10pOwogICAgICAgICAgICAgICAgICAgIHByaW50
ZigiJyIpOwogICAgCiAgICAgICAgICAgICAgICAgICAgaWYoaXNfYmluKGRhdGEy
LCBsZW4yKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAg
ICAgICAgICAgICBpbnQgb2xlbjsKICAgICAgICAgICAgICAgICAgICAgICAgemxp
bmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICAgICAgICAgICAgICAgICAgICAg
IGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4pOwogICAgICAg
ICAgICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0yKTsgCiAgICAg
ICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOwogICAgICAgICAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg
ICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICcl
LipzJ1xuIiwgbGVuMiwgZGF0YTIpOwogICAgICAgICAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7
CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsgMSk7CiAg
ICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIpOwogICAg
ICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IAogICAgICAgICAgICAg
ICAgICAgICpwbGVuID0gbGVuMjsgCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7
CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICB9CiAgICAgICAgfSAKICAgIGlmKGRlcHRoKQogICAgICAgIHpmcmVlKHN0
YWNrW2RlcHRoLTFdKTsgCiAgICBkZXB0aC0tOwogICAgcmV0dXJuIHJldDsKfQoK
CgoKCgoKCi8qID09PT09WyBnc2V4cC5jIF09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgIERlc2NyaXB0
aW9uOiAgICAgU2V4cCByb3V0aW5lcy4KCiAgIFJldmlzaW9uczoKCiAgICAgIFJF
ViAgIERBVEUgICAgICAgICAgICBCWSAgICAgICAgICAgICAgREVTQ1JJUFRJT04K
ICAgICAgLS0tLSAgLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0gICAgICAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgMC4wMCAgYXVnLjAzLjIw
MTcgICAgIFBldGVyIEdsZW4gICAgICBJbml0aWFsIHZlcnNpb24uCiAgICAgIDAu
MDAgIG9jdC4yMC4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgV29yayAKCiAgID09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ICovCgojaW5jbHVkZSA8c3RkaW8uaD4KCiNp
bmNsdWRlICJnY3J5cHQuaCIKI2luY2x1ZGUgImdjcnkuaCIKI2luY2x1ZGUgImdz
ZXhwLmgiCiNpbmNsdWRlICJ6bWFsbG9jLmgiCiNpbmNsdWRlICJtaXNjLmgiCgov
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBQcmludCBzZXhwIHRvIG1lbW9y
eQovLyBGcmVlIHRoZSByZXN1bHRpbmcgcG9pbnRlciB3aXRoIHpmcmVlCgpjaGFy
ICpzZXhwX3NwcmludChnY3J5X3NleHBfdCBzZXhwLCBpbnQgKmxlbiwgaW50IGZv
cm1hdCkKCnsKICAgIGludCBzbGVuID0gZ2NyeV9zZXhwX3NwcmludChzZXhwLCBm
b3JtYXQsIE5VTEwsIDApOwogICAgKmxlbiA9IDA7CiAgICB6bGluZTIoX19MSU5F
X18sIF9fRklMRV9fKTsKICAgIGNoYXIgKnBwcCA9IChjaGFyKil6YWxsb2Moc2xl
bisxKTsKICAgIGlmKHBwcCA9PSBOVUxMKQogICAgICAgIHJldHVybiBOVUxMOwoK
ICAgIGdjcnlfc2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBwcHAsIHNsZW4pOwog
ICAgKmxlbiA9IHNsZW47CiAgICAvLyBaZXJvIHRlcm1pbmF0ZQogICAgcHBwW3Ns
ZW4tMV0gPSAnXDAnOwogICAgcmV0dXJuKHBwcCk7Cn0KCi8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vCi8vIFByaW50IHNleHAgdG8gc3Rkb3V0Cgp2b2lkICAgIHNl
eHBfcHJpbnQoZ2NyeV9zZXhwX3QgcnNhX2tleXBhaXIpCgp7CiAgICBpbnQgbGVu
OwogICAgY2hhciAqcHBwID0gc2V4cF9zcHJpbnQocnNhX2tleXBhaXIsICZsZW4s
IEdDUllTRVhQX0ZNVF9BRFZBTkNFRCk7CiAgICBpZihwcHAgPT0gTlVMTCkKICAg
ICAgICByZXR1cm47CiAgICBwcmludGYoIiVzXG4iLCBwcHApOwogICAgemZyZWUo
cHBwKTsKfQoKY2hhciAgICAqc3RhY2tbMTJdOwppbnQgICAgIGRlcHRoID0gMDsK
CnN0YXRpYyBjaGFyICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwg
aW50ICpwbGVuLCBjb25zdCBjaGFyICpmaW5kc3RyKQoKewogICAgY2hhciAqcmV0
ID0gTlVMTDsKICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0
KTsKCiAgICAvL3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7CiAgICBzZXhw
X3ByaW50KGxpc3QpOwogICAgCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwg
b25lbGVuOyBsb29wKyspCiAgICAgICAgewogICAgICAgIGludCBsZW47CiAgICAg
ICAgY29uc3QgY2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBs
b29wLCAmbGVuKTsKICAgICAgICBpZihkYXRhID09IE5VTEwpCiAgICAgICAgICAg
IHsKICAgICAgICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9u
dGgobGlzdCwgbG9vcCk7CiAgICAgICAgICAgIGlmKGVsZW1lbnQpCiAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICBpbnQgbGVuMzsKICAgICAgICAgICAg
ICAgIGNvbnN0IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1l
bnQsIDAsICZsZW4zKTsKICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50
OiAnJS4qcydcbiIsIGxlbjMsIGRhdGEzKTsKICAgICAgICAgICAgICAgIGNoYXIg
Km1lbXggPSB6YWxsb2MobGVuMyArIDEpOwogICAgICAgICAgICAgICAgbWVtY3B5
KG1lbXgsIGRhdGEzLCBsZW4zKTsKICAgICAgICAgICAgICAgIG1lbXhbbGVuM10g
PSAnXDAnOyAKICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICAK
ICAgICAgICAgICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBh
dCBtYXgKICAgICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIpCiAgICAgICAgICAg
ICAgICAgICAgZGVwdGgrKzsKICAgICAgICAgICAgICAgIHJldCA9IHNleHBfZGVj
b2RlX29uZShlbGVtZW50LCBwbGVuLCBmaW5kc3RyKTsKICAgICAgICAgICAgICAg
IGlmKHJldCkKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICAgICAgewog
ICAgICAgICAgICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBs
ZW4sIGRhdGEpOwoKICAgICAgICAgICAgaW50IGxlbjI7CiAgICAgICAgICAgIGlm
KHN0cm5jbXAoZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0g
PT0gJ1wwJyApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb25z
dCBjaGFyICpkYXRhMiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsg
MSwgJmxlbjIpOwogICAgICAgICAgICAgICAgaWYoZGF0YTIpCiAgICAgICAgICAg
ICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIpOwog
ICAgICAgICAgICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRl
cHRoOyBsb29wMysrKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIi8l
cyIsIHN0YWNrW2xvb3AzXSk7CiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIn
Iik7CiAgICAKICAgICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxl
bjIpKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBvbGVuOwogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIo
X19MSU5FX18sIF9fRklMRV9fKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2hh
ciAqbWVtMiA9IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7CiAgICAgICAgICAg
ICAgICAgICAgICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyAKICAgICAgICAg
ICAgICAgICAgICAgICAgemZyZWUobWVtMik7CiAgICAgICAgICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMn
XG4iLCBsZW4yLCBkYXRhMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsKICAg
ICAgICAgICAgICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsKICAgICAg
ICAgICAgICAgICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7CiAgICAgICAg
ICAgICAgICAgICAgcmV0W2xlbjJdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICAg
ICAgKnBsZW4gPSBsZW4yOyAKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg
ICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
IH0KICAgICAgICB9IAogICAgaWYoZGVwdGgpCiAgICAgICAgemZyZWUoc3RhY2tb
ZGVwdGgtMV0pOyAKICAgIGRlcHRoLS07CiAgICByZXR1cm4gcmV0Owp9CgoKY2hh
ciAgICAqc3RhY2tbMTJdOwppbnQgICAgIGRlcHRoID0gMDsKCnN0YXRpYyBjaGFy
ICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVuLCBj
b25zdCBjaGFyICpmaW5kc3RyKQoKewogICAgY2hhciAqcmV0ID0gTlVMTDsKICAg
IGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsKCiAgICAvL3By
aW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7CiAgICBzZXhwX3ByaW50KGxpc3Qp
OwogICAgCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVuOyBsb29w
KyspCiAgICAgICAgewogICAgICAgIGludCBsZW47CiAgICAgICAgY29uc3QgY2hh
ciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAmbGVuKTsK
ICAgICAgICBpZihkYXRhID09IE5VTEwpCiAgICAgICAgICAgIHsKICAgICAgICAg
ICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlzdCwgbG9v
cCk7CiAgICAgICAgICAgIGlmKGVsZW1lbnQpCiAgICAgICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgICBpbnQgbGVuMzsKICAgICAgICAgICAgICAgIGNvbnN0IGNo
YXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQsIDAsICZsZW4z
KTsKICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydcbiIs
IGxlbjMsIGRhdGEzKTsKICAgICAgICAgICAgICAgIGNoYXIgKm1lbXggPSB6YWxs
b2MobGVuMyArIDEpOwogICAgICAgICAgICAgICAgbWVtY3B5KG1lbXgsIGRhdGEz
LCBsZW4zKTsKICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyAKICAg
ICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICAKICAgICAgICAgICAg
ICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgKICAgICAg
ICAgICAgICAgIGlmKGRlcHRoIDwgMTIpCiAgICAgICAgICAgICAgICAgICAgZGVw
dGgrKzsKICAgICAgICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29uZShlbGVt
ZW50LCBwbGVuLCBmaW5kc3RyKTsKICAgICAgICAgICAgICAgIGlmKHJldCkKICAg
ICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAv
L3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRhdGEpOwoK
ICAgICAgICAgICAgaW50IGxlbjI7CiAgICAgICAgICAgIGlmKHN0cm5jbXAoZmlu
ZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1wwJyApCiAg
ICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRh
MiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIpOwog
ICAgICAgICAgICAgICAgaWYoZGF0YTIpCiAgICAgICAgICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIpOwogICAgICAgICAgICAg
ICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBsb29wMysr
KQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNrW2xv
b3AzXSk7CiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7CiAgICAKICAg
ICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQogICAgICAg
ICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBv
bGVuOwogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9f
RklMRV9fKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVtMiA9IGRv
aGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7CiAgICAgICAgICAgICAgICAgICAgICAg
IHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyAKICAgICAgICAgICAgICAgICAgICAg
ICAgemZyZWUobWVtMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBsZW4yLCBk
YXRhMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
ICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsKICAgICAgICAgICAgICAg
ICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsKICAgICAgICAgICAgICAgICAg
ICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7CiAgICAgICAgICAgICAgICAgICAg
cmV0W2xlbjJdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICAgICAgKnBsZW4gPSBs
ZW4yOyAKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9
IAogICAgaWYoZGVwdGgpCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0pOyAK
ICAgIGRlcHRoLS07CiAgICByZXR1cm4gcmV0Owp9CgoKCgoKLyogPT09PT1bIGdz
ZXhwLmMgXT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQoKICAgRGVzY3JpcHRpb246ICAgICBTZXhwIHJvdXRp
bmVzLgoKICAgUmV2aXNpb25zOgoKICAgICAgUkVWICAgREFURSAgICAgICAgICAg
IEJZICAgICAgICAgICAgICBERVNDUklQVElPTgogICAgICAtLS0tICAtLS0tLS0t
LS0tLSAgICAgLS0tLS0tLS0tLSAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQogICAgICAwLjAwICBhdWcuMDMuMjAxNyAgICAgUGV0ZXIgR2xlbiAg
ICAgIEluaXRpYWwgdmVyc2lvbi4KICAgICAgMC4wMCAgb2N0LjIwLjIwMTcgICAg
IFBldGVyIEdsZW4gICAgICBXb3JrIAoKICAgPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0gKi8KCiNpbmNsdWRlIDxzdGRpby5oPgoKI2luY2x1ZGUgImdjcnlwdC5oIgoj
aW5jbHVkZSAiZ2NyeS5oIgojaW5jbHVkZSAiZ3NleHAuaCIKI2luY2x1ZGUgInpt
YWxsb2MuaCIKI2luY2x1ZGUgIm1pc2MuaCIKCi8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vCi8vIFByaW50IHNleHAgdG8gbWVtb3J5Ci8vIEZyZWUgdGhlIHJlc3Vs
dGluZyBwb2ludGVyIHdpdGggemZyZWUKCmNoYXIgKnNleHBfc3ByaW50KGdjcnlf
c2V4cF90IHNleHAsIGludCAqbGVuLCBpbnQgZm9ybWF0KQoKewogICAgaW50IHNs
ZW4gPSBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgTlVMTCwgMCk7CiAg
ICAqbGVuID0gMDsKICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAg
Y2hhciAqcHBwID0gKGNoYXIqKXphbGxvYyhzbGVuKzEpOwogICAgaWYocHBwID09
IE5VTEwpCiAgICAgICAgcmV0dXJuIE5VTEw7CgogICAgZ2NyeV9zZXhwX3Nwcmlu
dChzZXhwLCBmb3JtYXQsIHBwcCwgc2xlbik7CiAgICAqbGVuID0gc2xlbjsKICAg
IC8vIFplcm8gdGVybWluYXRlCiAgICBwcHBbc2xlbi0xXSA9ICdcMCc7CiAgICBy
ZXR1cm4ocHBwKTsKfQoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gUHJp
bnQgc2V4cCB0byBzdGRvdXQKCnZvaWQgICAgc2V4cF9wcmludChnY3J5X3NleHBf
dCByc2Ffa2V5cGFpcikKCnsKICAgIGludCBsZW47CiAgICBjaGFyICpwcHAgPSBz
ZXhwX3NwcmludChyc2Ffa2V5cGFpciwgJmxlbiwgR0NSWVNFWFBfRk1UX0FEVkFO
Q0VEKTsKICAgIGlmKHBwcCA9PSBOVUxMKQogICAgICAgIHJldHVybjsKICAgIHBy
aW50ZigiJXNcbiIsIHBwcCk7CiAgICB6ZnJlZShwcHApOwp9CgpjaGFyICAgICpz
dGFja1sxMl07CmludCAgICAgZGVwdGggPSAwOwoKc3RhdGljIGNoYXIgKnNleHBf
ZGVjb2RlX29uZShnY3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0IGNo
YXIgKmZpbmRzdHIpCgp7CiAgICBjaGFyICpyZXQgPSBOVUxMOwogICAgaW50ICBv
bmVsZW4gPSBnY3J5X3NleHBfbGVuZ3RoKGxpc3QpOwoKICAgIC8vcHJpbnRmKCAi
b25lOiAlZFxuIiwgb25lbGVuKTsKICAgIHNleHBfcHJpbnQobGlzdCk7CiAgICAK
ICAgIGZvcihpbnQgbG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3ArKykKICAg
ICAgICB7CiAgICAgICAgaW50IGxlbjsKICAgICAgICBjb25zdCBjaGFyICpkYXRh
ID0gZ2NyeV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOwogICAgICAg
IGlmKGRhdGEgPT0gTlVMTCkKICAgICAgICAgICAgewogICAgICAgICAgICBnY3J5
X3NleHBfdCBlbGVtZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsKICAg
ICAgICAgICAgaWYoZWxlbWVudCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAg
ICAgICAgIGludCBsZW4zOwogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0
YTMgPSBnY3J5X3NleHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOwogICAg
ICAgICAgICAgICAgLy9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVuMywg
ZGF0YTMpOwogICAgICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhsZW4z
ICsgMSk7CiAgICAgICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxlbjMp
OwogICAgICAgICAgICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IAogICAgICAgICAg
ICAgICAgc3RhY2tbZGVwdGhdID0gbWVteDsgIAogICAgICAgICAgICAgICAgLy8g
V2Uga25vdyBpdCBpcyBnb2luZyB0byBiZSAzIGF0IG1heAogICAgICAgICAgICAg
ICAgaWYoZGVwdGggPCAxMikKICAgICAgICAgICAgICAgICAgICBkZXB0aCsrOwog
ICAgICAgICAgICAgICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQsIHBs
ZW4sIGZpbmRzdHIpOwogICAgICAgICAgICAgICAgaWYocmV0KQogICAgICAgICAg
ICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9
CiAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgIC8vcHJpbnRm
KCJkYXRhOiAlZCAnJS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7CgogICAgICAg
ICAgICBpbnQgbGVuMjsKICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBk
YXRhLCBsZW4pID09IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkKICAgICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEyID0gZ2Ny
eV9zZXhwX250aF9kYXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7CiAgICAgICAg
ICAgICAgICBpZihkYXRhMikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAg
ICAgICAgICAgICAgLy9wcmludGYoIicvIik7CiAgICAgICAgICAgICAgICAgICAg
Zm9yKGludCBsb29wMyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspCiAgICAg
ICAgICAgICAgICAgICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsK
ICAgICAgICAgICAgICAgICAgICBwcmludGYoIiciKTsKICAgIAogICAgICAgICAg
ICAgICAgICAgIGlmKGlzX2JpbihkYXRhMiwgbGVuMikpCiAgICAgICAgICAgICAg
ICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47CiAg
ICAgICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18p
OwogICAgICAgICAgICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgoZGF0
YTIsIGxlbjIsICZvbGVuKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRm
KCIgIyVzI1xuIiwgbWVtMik7IAogICAgICAgICAgICAgICAgICAgICAgICB6ZnJl
ZShtZW0yKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgICAgICAgICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsK
ICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHps
aW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAgICAgICAgICAgICAgICAgIHJl
dCA9ICB6YWxsb2MobGVuMiArIDEpOwogICAgICAgICAgICAgICAgICAgIG1lbWNw
eShyZXQsIGRhdGEyLCBsZW4yKTsKICAgICAgICAgICAgICAgICAgICByZXRbbGVu
Ml0gPSAnXDAnOyAKICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7IAog
ICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gCiAgICBp
ZihkZXB0aCkKICAgICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IAogICAgZGVw
dGgtLTsKICAgIHJldHVybiByZXQ7Cn0KCgpjaGFyICAgICpzdGFja1sxMl07Cmlu
dCAgICAgZGVwdGggPSAwOwoKc3RhdGljIGNoYXIgKnNleHBfZGVjb2RlX29uZShn
Y3J5X3NleHBfdCBsaXN0LCBpbnQgKnBsZW4sIGNvbnN0IGNoYXIgKmZpbmRzdHIp
Cgp7CiAgICBjaGFyICpyZXQgPSBOVUxMOwogICAgaW50ICBvbmVsZW4gPSBnY3J5
X3NleHBfbGVuZ3RoKGxpc3QpOwoKICAgIC8vcHJpbnRmKCAib25lOiAlZFxuIiwg
b25lbGVuKTsKICAgIHNleHBfcHJpbnQobGlzdCk7CiAgICAKICAgIGZvcihpbnQg
bG9vcCA9IDA7IGxvb3AgPCBvbmVsZW47IGxvb3ArKykKICAgICAgICB7CiAgICAg
ICAgaW50IGxlbjsKICAgICAgICBjb25zdCBjaGFyICpkYXRhID0gZ2NyeV9zZXhw
X250aF9kYXRhKGxpc3QsIGxvb3AsICZsZW4pOwogICAgICAgIGlmKGRhdGEgPT0g
TlVMTCkKICAgICAgICAgICAgewogICAgICAgICAgICBnY3J5X3NleHBfdCBlbGVt
ZW50ID0gZ2NyeV9zZXhwX250aChsaXN0LCBsb29wKTsKICAgICAgICAgICAgaWYo
ZWxlbWVudCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGludCBs
ZW4zOwogICAgICAgICAgICAgICAgY29uc3QgY2hhciAqZGF0YTMgPSBnY3J5X3Nl
eHBfbnRoX2RhdGEoZWxlbWVudCwgMCwgJmxlbjMpOwogICAgICAgICAgICAgICAg
Ly9wcmludGYoImVsZW1lbnQ6ICclLipzJ1xuIiwgbGVuMywgZGF0YTMpOwogICAg
ICAgICAgICAgICAgY2hhciAqbWVteCA9IHphbGxvYyhsZW4zICsgMSk7CiAgICAg
ICAgICAgICAgICBtZW1jcHkobWVteCwgZGF0YTMsIGxlbjMpOwogICAgICAgICAg
ICAgICAgbWVteFtsZW4zXSA9ICdcMCc7IAogICAgICAgICAgICAgICAgc3RhY2tb
ZGVwdGhdID0gbWVteDsgIAogICAgICAgICAgICAgICAgLy8gV2Uga25vdyBpdCBp
cyBnb2luZyB0byBiZSAzIGF0IG1heAogICAgICAgICAgICAgICAgaWYoZGVwdGgg
PCAxMikKICAgICAgICAgICAgICAgICAgICBkZXB0aCsrOwogICAgICAgICAgICAg
ICAgcmV0ID0gc2V4cF9kZWNvZGVfb25lKGVsZW1lbnQsIHBsZW4sIGZpbmRzdHIp
OwogICAgICAgICAgICAgICAgaWYocmV0KQogICAgICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgZWxz
ZQogICAgICAgICAgICB7CiAgICAgICAgICAgIC8vcHJpbnRmKCJkYXRhOiAlZCAn
JS4qcydcbiIsIGxvb3AsIGxlbiwgZGF0YSk7CgogICAgICAgICAgICBpbnQgbGVu
MjsKICAgICAgICAgICAgaWYoc3RybmNtcChmaW5kc3RyLCBkYXRhLCBsZW4pID09
IDAgfHwgZmluZHN0clswXSA9PSAnXDAnICkKICAgICAgICAgICAgICAgIHsKICAg
ICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEyID0gZ2NyeV9zZXhwX250aF9k
YXRhKGxpc3QsIGxvb3AgKyAxLCAmbGVuMik7CiAgICAgICAgICAgICAgICBpZihk
YXRhMikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
Ly9wcmludGYoIicvIik7CiAgICAgICAgICAgICAgICAgICAgZm9yKGludCBsb29w
MyA9IDA7IGxvb3AzIDwgZGVwdGg7IGxvb3AzKyspCiAgICAgICAgICAgICAgICAg
ICAgICAgIHByaW50ZigiLyVzIiwgc3RhY2tbbG9vcDNdKTsKICAgICAgICAgICAg
ICAgICAgICBwcmludGYoIiciKTsKICAgIAogICAgICAgICAgICAgICAgICAgIGlm
KGlzX2JpbihkYXRhMiwgbGVuMikpCiAgICAgICAgICAgICAgICAgICAgICAgIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgaW50IG9sZW47CiAgICAgICAgICAgICAg
ICAgICAgICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAgICAgICAg
ICAgICAgICAgICAgICBjaGFyICptZW0yID0gZG9oZXgoZGF0YTIsIGxlbjIsICZv
bGVuKTsKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgIyVzI1xuIiwg
bWVtMik7IAogICAgICAgICAgICAgICAgICAgICAgICB6ZnJlZShtZW0yKTsKICAg
ICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UK
ICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAg
ICBwcmludGYoIiAnJS4qcydcbiIsIGxlbjIsIGRhdGEyKTsKICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHpsaW5lMihfX0xJTkVf
XywgX19GSUxFX18pOwogICAgICAgICAgICAgICAgICAgIHJldCA9ICB6YWxsb2Mo
bGVuMiArIDEpOwogICAgICAgICAgICAgICAgICAgIG1lbWNweShyZXQsIGRhdGEy
LCBsZW4yKTsKICAgICAgICAgICAgICAgICAgICByZXRbbGVuMl0gPSAnXDAnOyAK
ICAgICAgICAgICAgICAgICAgICAqcGxlbiA9IGxlbjI7IAogICAgICAgICAgICAg
ICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gCiAgICBpZihkZXB0aCkKICAg
ICAgICB6ZnJlZShzdGFja1tkZXB0aC0xXSk7IAogICAgZGVwdGgtLTsKICAgIHJl
dHVybiByZXQ7Cn0KCgoKCgovKiA9PT09PVsgZ3NleHAuYyBdPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Cgog
ICBEZXNjcmlwdGlvbjogICAgIFNleHAgcm91dGluZXMuCgogICBSZXZpc2lvbnM6
CgogICAgICBSRVYgICBEQVRFICAgICAgICAgICAgQlkgICAgICAgICAgICAgIERF
U0NSSVBUSU9OCiAgICAgIC0tLS0gIC0tLS0tLS0tLS0tICAgICAtLS0tLS0tLS0t
ICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgIDAuMDAg
IGF1Zy4wMy4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgSW5pdGlhbCB2ZXJzaW9u
LgogICAgICAwLjAwICBvY3QuMjAuMjAxNyAgICAgUGV0ZXIgR2xlbiAgICAgIFdv
cmsgCgogICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwoKI2luY2x1ZGUgPHN0
ZGlvLmg+CgojaW5jbHVkZSAiZ2NyeXB0LmgiCiNpbmNsdWRlICJnY3J5LmgiCiNp
bmNsdWRlICJnc2V4cC5oIgojaW5jbHVkZSAiem1hbGxvYy5oIgojaW5jbHVkZSAi
bWlzYy5oIgoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gUHJpbnQgc2V4
cCB0byBtZW1vcnkKLy8gRnJlZSB0aGUgcmVzdWx0aW5nIHBvaW50ZXIgd2l0aCB6
ZnJlZQoKY2hhciAqc2V4cF9zcHJpbnQoZ2NyeV9zZXhwX3Qgc2V4cCwgaW50ICps
ZW4sIGludCBmb3JtYXQpCgp7CiAgICBpbnQgc2xlbiA9IGdjcnlfc2V4cF9zcHJp
bnQoc2V4cCwgZm9ybWF0LCBOVUxMLCAwKTsKICAgICpsZW4gPSAwOwogICAgemxp
bmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICBjaGFyICpwcHAgPSAoY2hhciop
emFsbG9jKHNsZW4rMSk7CiAgICBpZihwcHAgPT0gTlVMTCkKICAgICAgICByZXR1
cm4gTlVMTDsKCiAgICBnY3J5X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgcHBw
LCBzbGVuKTsKICAgICpsZW4gPSBzbGVuOwogICAgLy8gWmVybyB0ZXJtaW5hdGUK
ICAgIHBwcFtzbGVuLTFdID0gJ1wwJzsKICAgIHJldHVybihwcHApOwp9CgovLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBQcmludCBzZXhwIHRvIHN0ZG91dAoK
dm9pZCAgICBzZXhwX3ByaW50KGdjcnlfc2V4cF90IHJzYV9rZXlwYWlyKQoKewog
ICAgaW50IGxlbjsKICAgIGNoYXIgKnBwcCA9IHNleHBfc3ByaW50KHJzYV9rZXlw
YWlyLCAmbGVuLCBHQ1JZU0VYUF9GTVRfQURWQU5DRUQpOwogICAgaWYocHBwID09
IE5VTEwpCiAgICAgICAgcmV0dXJuOwogICAgcHJpbnRmKCIlc1xuIiwgcHBwKTsK
ICAgIHpmcmVlKHBwcCk7Cn0KCmNoYXIgICAgKnN0YWNrWzEyXTsKaW50ICAgICBk
ZXB0aCA9IDA7CgpzdGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4
cF90IGxpc3QsIGludCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikKCnsKICAg
IGNoYXIgKnJldCA9IE5VTEw7CiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9s
ZW5ndGgobGlzdCk7CgogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVsZW4p
OwogICAgc2V4cF9wcmludChsaXN0KTsKICAgIAogICAgZm9yKGludCBsb29wID0g
MDsgbG9vcCA8IG9uZWxlbjsgbG9vcCsrKQogICAgICAgIHsKICAgICAgICBpbnQg
bGVuOwogICAgICAgIGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRoX2Rh
dGEobGlzdCwgbG9vcCwgJmxlbik7CiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQog
ICAgICAgICAgICB7CiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQgPSBn
Y3J5X3NleHBfbnRoKGxpc3QsIGxvb3ApOwogICAgICAgICAgICBpZihlbGVtZW50
KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaW50IGxlbjM7CiAg
ICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhf
ZGF0YShlbGVtZW50LCAwLCAmbGVuMyk7CiAgICAgICAgICAgICAgICAvL3ByaW50
ZigiZWxlbWVudDogJyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7CiAgICAgICAgICAg
ICAgICBjaGFyICptZW14ID0gemFsbG9jKGxlbjMgKyAxKTsKICAgICAgICAgICAg
ICAgIG1lbWNweShtZW14LCBkYXRhMywgbGVuMyk7CiAgICAgICAgICAgICAgICBt
ZW14W2xlbjNdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICBzdGFja1tkZXB0aF0g
PSBtZW14OyAgCiAgICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdvaW5n
IHRvIGJlIDMgYXQgbWF4CiAgICAgICAgICAgICAgICBpZihkZXB0aCA8IDEyKQog
ICAgICAgICAgICAgICAgICAgIGRlcHRoKys7CiAgICAgICAgICAgICAgICByZXQg
PSBzZXhwX2RlY29kZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7CiAgICAg
ICAgICAgICAgICBpZihyZXQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg
ICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBlbHNlCiAgICAg
ICAgICAgIHsKICAgICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipzJ1xu
IiwgbG9vcCwgbGVuLCBkYXRhKTsKCiAgICAgICAgICAgIGludCBsZW4yOwogICAg
ICAgICAgICBpZihzdHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0gMCB8fCBm
aW5kc3RyWzBdID09ICdcMCcgKQogICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgY29uc3QgY2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlz
dCwgbG9vcCArIDEsICZsZW4yKTsKICAgICAgICAgICAgICAgIGlmKGRhdGEyKQog
ICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL3ByaW50
ZigiJy8iKTsKICAgICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3AzID0gMDsg
bG9vcDMgPCBkZXB0aDsgbG9vcDMrKykKICAgICAgICAgICAgICAgICAgICAgICAg
cHJpbnRmKCIvJXMiLCBzdGFja1tsb29wM10pOwogICAgICAgICAgICAgICAgICAg
IHByaW50ZigiJyIpOwogICAgCiAgICAgICAgICAgICAgICAgICAgaWYoaXNfYmlu
KGRhdGEyLCBsZW4yKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAg
ICAgICAgICAgICAgICAgICBpbnQgb2xlbjsKICAgICAgICAgICAgICAgICAgICAg
ICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICAgICAgICAgICAgICAg
ICAgICAgIGNoYXIgKm1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4pOwog
ICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0yKTsg
CiAgICAgICAgICAgICAgICAgICAgICAgIHpmcmVlKG1lbTIpOwogICAgICAgICAg
ICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAg
ICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50
ZigiICclLipzJ1xuIiwgbGVuMiwgZGF0YTIpOwogICAgICAgICAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJ
TEVfXyk7CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsg
MSk7CiAgICAgICAgICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIp
OwogICAgICAgICAgICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IAogICAgICAg
ICAgICAgICAgICAgICpwbGVuID0gbGVuMjsgCiAgICAgICAgICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICB9CiAgICAgICAgfSAKICAgIGlmKGRlcHRoKQogICAgICAgIHpm
cmVlKHN0YWNrW2RlcHRoLTFdKTsgCiAgICBkZXB0aC0tOwogICAgcmV0dXJuIHJl
dDsKfQoKCmNoYXIgICAgKnN0YWNrWzEyXTsKaW50ICAgICBkZXB0aCA9IDA7Cgpz
dGF0aWMgY2hhciAqc2V4cF9kZWNvZGVfb25lKGdjcnlfc2V4cF90IGxpc3QsIGlu
dCAqcGxlbiwgY29uc3QgY2hhciAqZmluZHN0cikKCnsKICAgIGNoYXIgKnJldCA9
IE5VTEw7CiAgICBpbnQgIG9uZWxlbiA9IGdjcnlfc2V4cF9sZW5ndGgobGlzdCk7
CgogICAgLy9wcmludGYoICJvbmU6ICVkXG4iLCBvbmVsZW4pOwogICAgc2V4cF9w
cmludChsaXN0KTsKICAgIAogICAgZm9yKGludCBsb29wID0gMDsgbG9vcCA8IG9u
ZWxlbjsgbG9vcCsrKQogICAgICAgIHsKICAgICAgICBpbnQgbGVuOwogICAgICAg
IGNvbnN0IGNoYXIgKmRhdGEgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9v
cCwgJmxlbik7CiAgICAgICAgaWYoZGF0YSA9PSBOVUxMKQogICAgICAgICAgICB7
CiAgICAgICAgICAgIGdjcnlfc2V4cF90IGVsZW1lbnQgPSBnY3J5X3NleHBfbnRo
KGxpc3QsIGxvb3ApOwogICAgICAgICAgICBpZihlbGVtZW50KQogICAgICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgaW50IGxlbjM7CiAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpkYXRhMyA9IGdjcnlfc2V4cF9udGhfZGF0YShlbGVtZW50
LCAwLCAmbGVuMyk7CiAgICAgICAgICAgICAgICAvL3ByaW50ZigiZWxlbWVudDog
JyUuKnMnXG4iLCBsZW4zLCBkYXRhMyk7CiAgICAgICAgICAgICAgICBjaGFyICpt
ZW14ID0gemFsbG9jKGxlbjMgKyAxKTsKICAgICAgICAgICAgICAgIG1lbWNweSht
ZW14LCBkYXRhMywgbGVuMyk7CiAgICAgICAgICAgICAgICBtZW14W2xlbjNdID0g
J1wwJzsgCiAgICAgICAgICAgICAgICBzdGFja1tkZXB0aF0gPSBtZW14OyAgCiAg
ICAgICAgICAgICAgICAvLyBXZSBrbm93IGl0IGlzIGdvaW5nIHRvIGJlIDMgYXQg
bWF4CiAgICAgICAgICAgICAgICBpZihkZXB0aCA8IDEyKQogICAgICAgICAgICAg
ICAgICAgIGRlcHRoKys7CiAgICAgICAgICAgICAgICByZXQgPSBzZXhwX2RlY29k
ZV9vbmUoZWxlbWVudCwgcGxlbiwgZmluZHN0cik7CiAgICAgICAgICAgICAgICBp
ZihyZXQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAg
ICAgICAgICAgLy9wcmludGYoImRhdGE6ICVkICclLipzJ1xuIiwgbG9vcCwgbGVu
LCBkYXRhKTsKCiAgICAgICAgICAgIGludCBsZW4yOwogICAgICAgICAgICBpZihz
dHJuY21wKGZpbmRzdHIsIGRhdGEsIGxlbikgPT0gMCB8fCBmaW5kc3RyWzBdID09
ICdcMCcgKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqZGF0YTIgPSBnY3J5X3NleHBfbnRoX2RhdGEobGlzdCwgbG9vcCArIDEs
ICZsZW4yKTsKICAgICAgICAgICAgICAgIGlmKGRhdGEyKQogICAgICAgICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL3ByaW50ZigiJy8iKTsKICAg
ICAgICAgICAgICAgICAgICBmb3IoaW50IGxvb3AzID0gMDsgbG9vcDMgPCBkZXB0
aDsgbG9vcDMrKykKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIvJXMi
LCBzdGFja1tsb29wM10pOwogICAgICAgICAgICAgICAgICAgIHByaW50ZigiJyIp
OwogICAgCiAgICAgICAgICAgICAgICAgICAgaWYoaXNfYmluKGRhdGEyLCBsZW4y
KSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAg
ICAgICBpbnQgb2xlbjsKICAgICAgICAgICAgICAgICAgICAgICAgemxpbmUyKF9f
TElORV9fLCBfX0ZJTEVfXyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIg
Km1lbTIgPSBkb2hleChkYXRhMiwgbGVuMiwgJm9sZW4pOwogICAgICAgICAgICAg
ICAgICAgICAgICBwcmludGYoIiAjJXMjXG4iLCBtZW0yKTsgCiAgICAgICAgICAg
ICAgICAgICAgICAgIHpmcmVlKG1lbTIpOwogICAgICAgICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiICclLipzJ1xu
IiwgbGVuMiwgZGF0YTIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICAgICAgICAgemxpbmUyKF9fTElORV9fLCBfX0ZJTEVfXyk7CiAgICAg
ICAgICAgICAgICAgICAgcmV0ID0gIHphbGxvYyhsZW4yICsgMSk7CiAgICAgICAg
ICAgICAgICAgICAgbWVtY3B5KHJldCwgZGF0YTIsIGxlbjIpOwogICAgICAgICAg
ICAgICAgICAgIHJldFtsZW4yXSA9ICdcMCc7IAogICAgICAgICAgICAgICAgICAg
ICpwbGVuID0gbGVuMjsgCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9
CiAgICAgICAgfSAKICAgIGlmKGRlcHRoKQogICAgICAgIHpmcmVlKHN0YWNrW2Rl
cHRoLTFdKTsgCiAgICBkZXB0aC0tOwogICAgcmV0dXJuIHJldDsKfQoKCgoKCi8q
ID09PT09WyBnc2V4cC5jIF09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgIERlc2NyaXB0aW9uOiAgICAg
U2V4cCByb3V0aW5lcy4KCiAgIFJldmlzaW9uczoKCiAgICAgIFJFViAgIERBVEUg
ICAgICAgICAgICBCWSAgICAgICAgICAgICAgREVTQ1JJUFRJT04KICAgICAgLS0t
LSAgLS0tLS0tLS0tLS0gICAgIC0tLS0tLS0tLS0gICAgICAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KICAgICAgMC4wMCAgYXVnLjAzLjIwMTcgICAgIFBl
dGVyIEdsZW4gICAgICBJbml0aWFsIHZlcnNpb24uCiAgICAgIDAuMDAgIG9jdC4y
MC4yMDE3ICAgICBQZXRlciBHbGVuICAgICAgV29yayAKCiAgID09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09ICovCgojaW5jbHVkZSA8c3RkaW8uaD4KCiNpbmNsdWRlICJn
Y3J5cHQuaCIKI2luY2x1ZGUgImdjcnkuaCIKI2luY2x1ZGUgImdzZXhwLmgiCiNp
bmNsdWRlICJ6bWFsbG9jLmgiCiNpbmNsdWRlICJtaXNjLmgiCgovLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLwovLyBQcmludCBzZXhwIHRvIG1lbW9yeQovLyBGcmVl
IHRoZSByZXN1bHRpbmcgcG9pbnRlciB3aXRoIHpmcmVlCgpjaGFyICpzZXhwX3Nw
cmludChnY3J5X3NleHBfdCBzZXhwLCBpbnQgKmxlbiwgaW50IGZvcm1hdCkKCnsK
ICAgIGludCBzbGVuID0gZ2NyeV9zZXhwX3NwcmludChzZXhwLCBmb3JtYXQsIE5V
TEwsIDApOwogICAgKmxlbiA9IDA7CiAgICB6bGluZTIoX19MSU5FX18sIF9fRklM
RV9fKTsKICAgIGNoYXIgKnBwcCA9IChjaGFyKil6YWxsb2Moc2xlbisxKTsKICAg
IGlmKHBwcCA9PSBOVUxMKQogICAgICAgIHJldHVybiBOVUxMOwoKICAgIGdjcnlf
c2V4cF9zcHJpbnQoc2V4cCwgZm9ybWF0LCBwcHAsIHNsZW4pOwogICAgKmxlbiA9
IHNsZW47CiAgICAvLyBaZXJvIHRlcm1pbmF0ZQogICAgcHBwW3NsZW4tMV0gPSAn
XDAnOwogICAgcmV0dXJuKHBwcCk7Cn0KCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vCi8vIFByaW50IHNleHAgdG8gc3Rkb3V0Cgp2b2lkICAgIHNleHBfcHJpbnQo
Z2NyeV9zZXhwX3QgcnNhX2tleXBhaXIpCgp7CiAgICBpbnQgbGVuOwogICAgY2hh
ciAqcHBwID0gc2V4cF9zcHJpbnQocnNhX2tleXBhaXIsICZsZW4sIEdDUllTRVhQ
X0ZNVF9BRFZBTkNFRCk7CiAgICBpZihwcHAgPT0gTlVMTCkKICAgICAgICByZXR1
cm47CiAgICBwcmludGYoIiVzXG4iLCBwcHApOwogICAgemZyZWUocHBwKTsKfQoK
Y2hhciAgICAqc3RhY2tbMTJdOwppbnQgICAgIGRlcHRoID0gMDsKCnN0YXRpYyBj
aGFyICpzZXhwX2RlY29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVu
LCBjb25zdCBjaGFyICpmaW5kc3RyKQoKewogICAgY2hhciAqcmV0ID0gTlVMTDsK
ICAgIGludCAgb25lbGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsKCiAgICAv
L3ByaW50ZiggIm9uZTogJWRcbiIsIG9uZWxlbik7CiAgICBzZXhwX3ByaW50KGxp
c3QpOwogICAgCiAgICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVuOyBs
b29wKyspCiAgICAgICAgewogICAgICAgIGludCBsZW47CiAgICAgICAgY29uc3Qg
Y2hhciAqZGF0YSA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAmbGVu
KTsKICAgICAgICBpZihkYXRhID09IE5VTEwpCiAgICAgICAgICAgIHsKICAgICAg
ICAgICAgZ2NyeV9zZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlzdCwg
bG9vcCk7CiAgICAgICAgICAgIGlmKGVsZW1lbnQpCiAgICAgICAgICAgICAgICB7
CiAgICAgICAgICAgICAgICBpbnQgbGVuMzsKICAgICAgICAgICAgICAgIGNvbnN0
IGNoYXIgKmRhdGEzID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQsIDAsICZs
ZW4zKTsKICAgICAgICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydc
biIsIGxlbjMsIGRhdGEzKTsKICAgICAgICAgICAgICAgIGNoYXIgKm1lbXggPSB6
YWxsb2MobGVuMyArIDEpOwogICAgICAgICAgICAgICAgbWVtY3B5KG1lbXgsIGRh
dGEzLCBsZW4zKTsKICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyAK
ICAgICAgICAgICAgICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICAKICAgICAgICAg
ICAgICAgIC8vIFdlIGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgKICAg
ICAgICAgICAgICAgIGlmKGRlcHRoIDwgMTIpCiAgICAgICAgICAgICAgICAgICAg
ZGVwdGgrKzsKICAgICAgICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29uZShl
bGVtZW50LCBwbGVuLCBmaW5kc3RyKTsKICAgICAgICAgICAgICAgIGlmKHJldCkK
ICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAg
ICAvL3ByaW50ZigiZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRhdGEp
OwoKICAgICAgICAgICAgaW50IGxlbjI7CiAgICAgICAgICAgIGlmKHN0cm5jbXAo
ZmluZHN0ciwgZGF0YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1wwJyAp
CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpk
YXRhMiA9IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIp
OwogICAgICAgICAgICAgICAgaWYoZGF0YTIpCiAgICAgICAgICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCInLyIpOwogICAgICAgICAg
ICAgICAgICAgIGZvcihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBsb29w
MysrKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNr
W2xvb3AzXSk7CiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7CiAgICAK
ICAgICAgICAgICAgICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQogICAg
ICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlu
dCBvbGVuOwogICAgICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18s
IF9fRklMRV9fKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVtMiA9
IGRvaGV4KGRhdGEyLCBsZW4yLCAmb2xlbik7CiAgICAgICAgICAgICAgICAgICAg
ICAgIHByaW50ZigiICMlcyNcbiIsIG1lbTIpOyAKICAgICAgICAgICAgICAgICAg
ICAgICAgemZyZWUobWVtMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBsZW4y
LCBkYXRhMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsKICAgICAgICAgICAg
ICAgICAgICByZXQgPSAgemFsbG9jKGxlbjIgKyAxKTsKICAgICAgICAgICAgICAg
ICAgICBtZW1jcHkocmV0LCBkYXRhMiwgbGVuMik7CiAgICAgICAgICAgICAgICAg
ICAgcmV0W2xlbjJdID0gJ1wwJzsgCiAgICAgICAgICAgICAgICAgICAgKnBsZW4g
PSBsZW4yOyAKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg
ICB9IAogICAgaWYoZGVwdGgpCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0p
OyAKICAgIGRlcHRoLS07CiAgICByZXR1cm4gcmV0Owp9CgoKY2hhciAgICAqc3Rh
Y2tbMTJdOwppbnQgICAgIGRlcHRoID0gMDsKCnN0YXRpYyBjaGFyICpzZXhwX2Rl
Y29kZV9vbmUoZ2NyeV9zZXhwX3QgbGlzdCwgaW50ICpwbGVuLCBjb25zdCBjaGFy
ICpmaW5kc3RyKQoKewogICAgY2hhciAqcmV0ID0gTlVMTDsKICAgIGludCAgb25l
bGVuID0gZ2NyeV9zZXhwX2xlbmd0aChsaXN0KTsKCiAgICAvL3ByaW50ZiggIm9u
ZTogJWRcbiIsIG9uZWxlbik7CiAgICBzZXhwX3ByaW50KGxpc3QpOwogICAgCiAg
ICBmb3IoaW50IGxvb3AgPSAwOyBsb29wIDwgb25lbGVuOyBsb29wKyspCiAgICAg
ICAgewogICAgICAgIGludCBsZW47CiAgICAgICAgY29uc3QgY2hhciAqZGF0YSA9
IGdjcnlfc2V4cF9udGhfZGF0YShsaXN0LCBsb29wLCAmbGVuKTsKICAgICAgICBp
ZihkYXRhID09IE5VTEwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgZ2NyeV9z
ZXhwX3QgZWxlbWVudCA9IGdjcnlfc2V4cF9udGgobGlzdCwgbG9vcCk7CiAgICAg
ICAgICAgIGlmKGVsZW1lbnQpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAg
ICAgICBpbnQgbGVuMzsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmRhdGEz
ID0gZ2NyeV9zZXhwX250aF9kYXRhKGVsZW1lbnQsIDAsICZsZW4zKTsKICAgICAg
ICAgICAgICAgIC8vcHJpbnRmKCJlbGVtZW50OiAnJS4qcydcbiIsIGxlbjMsIGRh
dGEzKTsKICAgICAgICAgICAgICAgIGNoYXIgKm1lbXggPSB6YWxsb2MobGVuMyAr
IDEpOwogICAgICAgICAgICAgICAgbWVtY3B5KG1lbXgsIGRhdGEzLCBsZW4zKTsK
ICAgICAgICAgICAgICAgIG1lbXhbbGVuM10gPSAnXDAnOyAKICAgICAgICAgICAg
ICAgIHN0YWNrW2RlcHRoXSA9IG1lbXg7ICAKICAgICAgICAgICAgICAgIC8vIFdl
IGtub3cgaXQgaXMgZ29pbmcgdG8gYmUgMyBhdCBtYXgKICAgICAgICAgICAgICAg
IGlmKGRlcHRoIDwgMTIpCiAgICAgICAgICAgICAgICAgICAgZGVwdGgrKzsKICAg
ICAgICAgICAgICAgIHJldCA9IHNleHBfZGVjb2RlX29uZShlbGVtZW50LCBwbGVu
LCBmaW5kc3RyKTsKICAgICAgICAgICAgICAgIGlmKHJldCkKICAgICAgICAgICAg
ICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog
ICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAvL3ByaW50Zigi
ZGF0YTogJWQgJyUuKnMnXG4iLCBsb29wLCBsZW4sIGRhdGEpOwoKICAgICAgICAg
ICAgaW50IGxlbjI7CiAgICAgICAgICAgIGlmKHN0cm5jbXAoZmluZHN0ciwgZGF0
YSwgbGVuKSA9PSAwIHx8IGZpbmRzdHJbMF0gPT0gJ1wwJyApCiAgICAgICAgICAg
ICAgICB7CiAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpkYXRhMiA9IGdjcnlf
c2V4cF9udGhfZGF0YShsaXN0LCBsb29wICsgMSwgJmxlbjIpOwogICAgICAgICAg
ICAgICAgaWYoZGF0YTIpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgICAgIC8vcHJpbnRmKCInLyIpOwogICAgICAgICAgICAgICAgICAgIGZv
cihpbnQgbG9vcDMgPSAwOyBsb29wMyA8IGRlcHRoOyBsb29wMysrKQogICAgICAg
ICAgICAgICAgICAgICAgICBwcmludGYoIi8lcyIsIHN0YWNrW2xvb3AzXSk7CiAg
ICAgICAgICAgICAgICAgICAgcHJpbnRmKCInIik7CiAgICAKICAgICAgICAgICAg
ICAgICAgICBpZihpc19iaW4oZGF0YTIsIGxlbjIpKQogICAgICAgICAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBvbGVuOwogICAg
ICAgICAgICAgICAgICAgICAgICB6bGluZTIoX19MSU5FX18sIF9fRklMRV9fKTsK
ICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqbWVtMiA9IGRvaGV4KGRhdGEy
LCBsZW4yLCAmb2xlbik7CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50Zigi
ICMlcyNcbiIsIG1lbTIpOyAKICAgICAgICAgICAgICAgICAgICAgICAgemZyZWUo
bWVtMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
ICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICAgICAgICAgICAgcHJpbnRmKCIgJyUuKnMnXG4iLCBsZW4yLCBkYXRhMik7CiAg
ICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB6bGlu
ZTIoX19MSU5FX18sIF9fRklMRV9fKTsKICAgICAgICAgICAgICAgICAgICByZXQg
PSAgemFsbG9jKGxlbjIgKyAxKTsKICAgICAgICAgICAgICAgICAgICBtZW1jcHko
cmV0LCBkYXRhMiwgbGVuMik7CiAgICAgICAgICAgICAgICAgICAgcmV0W2xlbjJd
ID0gJ1wwJzsgCiAgICAgICAgICAgICAgICAgICAgKnBsZW4gPSBsZW4yOyAKICAg
ICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IAogICAgaWYo
ZGVwdGgpCiAgICAgICAgemZyZWUoc3RhY2tbZGVwdGgtMV0pOyAKICAgIGRlcHRo
LS07CiAgICByZXR1cm4gcmV0Owp9CgoKCgoKLyogPT09PT1bIGdzZXhwLmMgXT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQoKICAgRGVzY3JpcHRpb246ICAgICBTZXhwIHJvdXRpbmVzLgoKICAg
UmV2aXNpb25zOgoKICAgICAgUkVWICAgREFURSAgICAgICAgICAgIEJZICAgICAg
ICAgICAgICBERVNDUklQVElPTgogICAgICAtLS0tICAtLS0tLS0tLS0tLSAgICAg
LS0tLS0tLS0tLSAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQog
ICAgICAwLjAwICBhdWcuMDMuMjAxNyAgICAgUGV0ZXIgR2xlbiAgICAgIEluaXRp
YWwgdmVyc2lvbi4KICAgICAgMC4wMCAgb2N0LjIwLjIwMTcgICAgIFBldGVyIEds
ZW4gICAgICBXb3JrIAoKICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KCiNp
bmNsdWRlIDxzdGRpby5oPgoKI2luY2x1ZGUgImdjcnlwdC5oIgojaW5jbHVkZSAi
Z2NyeS5oIgojaW5jbHVkZSAiZ3NleHAuaCIKI2luY2x1ZGUgInptYWxsb2MuaCIK
I2luY2x1ZGUgIm1pc2MuaCIKCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8v
IFByaW50IHNleHAgdG8gbWVtb3J5Ci8vIEZyZWUgdGhlIHJlc3VsdGluZyBwb2lu
dGVyIHdpdGggemZyZWUKCmNoYXIgKnNleHBfc3ByaW50KGdjcnlfc2V4cF90IHNl
eHAsIGludCAqbGVuLCBpbnQgZm9ybWF0KQoKewogICAgaW50IHNsZW4gPSBnY3J5
X3NleHBfc3ByaW50KHNleHAsIGZvcm1hdCwgTlVMTCwgMCk7CiAgICAqbGVuID0g
MDsKICAgIHpsaW5lMihfX0xJTkVfXywgX19GSUxFX18pOwogICAgY2hhciAqcHBw
ID0gKGNoYXIqKXphbGxvYyhzbGVuKzEpOwogICAgaWYocHBwID09IE5VTEwpCiAg
ICAgICAgcmV0dXJuIE5VTEw7CgogICAgZ2NyeV9zZXhwX3NwcmludChzZXhwLCBm
b3JtYXQsIHBwcCwgc2xlbik7CiAgICAqbGVuID0gc2xlbjsKICAgIC8vIFplcm8g
dGVybWluYXRlCiAgICBwcHBbc2xlbi0xXSA9ICdcMCc7CiAgICByZXR1cm4ocHBw
KTsKfQoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gUHJpbnQgc2V4cCB0
byBzdGRvdXQKCnZvaWQgICAgc2V4cF9wcmludChnY3J5X3NleHBfdCByc2Ffa2V5
cGFpcikKCnsKICAgIGludCBsZW47CiAgICBjaGFyICpwcHAgPSBzZXhwX3Nwcmlu
dChyc2Ffa2V5cGFpciwgJmxlbiwgR0NSWVNFWFBfRk1UX0FEVkFOQ0VEKTsKICAg
IGlmKHBwcCA9PSBOVUxMKQogICAgICAgIHJldHVybjsKICAgIHByaW50ZigiJXNc
biIsIHBwcCk7CiAgICB6ZnJlZShwcHApOwp9CgpjaGFyICAgICpzdGFja1sxMl07
CmludCAgICAgZGVwdGggPSAwOwoKCg==